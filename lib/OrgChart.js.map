{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 21a13ca2bbfd5a7ecc43","webpack:///./src/index.js"],"names":["OrgChart","chartContainer","data","nodeTitle","nodeContent","nodeId","toggleSiblingsResp","depth","chartClass","exportButton","exportFilename","parentNodeSymbol","draggable","direction","pan","zoom","_name","options","_init","opts","chart","document","createElement","dataset","JSON","stringify","setAttribute","addEventListener","event","node","_closest","target","el","classList","contains","querySelector","removeClass","nodeName","buildHierarchy","_buildJsonDS","children","ajaxURL","_attachRel","spinner","_getJSON","then","resp","catch","err","console","error","finally","parentNode","removeChild","appendChild","fn","expr","Array","from","filter","child","matches","sibs","prevSib","previousElementSibling","push","nextSib","nextElementSibling","offsetParent","elements","classNames","forEach","indexOf","split","className","add","remove","prop","val","style","attr","removeAttr","type","listener","self","one","call","removeEventListener","url","Promise","resolve","reject","client","XMLHttpRequest","handler","readyState","status","response","Error","statusText","open","onreadystatechange","responseType","setRequestHeader","send","li","subObj","firstChild","textContent","trim","tagName","length","id","subLi","flags","relationship","item","offsetWidth","relation","criteria","state","exist","_isVisible","visible","_siblings","some","lastChild","map","leftEdge","rightEdge","temp","siblingsLoaded","sibsVisible","toggle","flag","topEdge","bottomEdge","_getNodeState","_switchHorizontalArrow","querySelectorAll","currentRoot","nodeData","callback","table","_createNode","nodeDiv","innerHTML","insertBefore","arrow","tr","_addClass","slice","parent","_repaint","_isInAction","_switchVerticalArrow","nodeContainer","siblings","sib","inAjax","preSibs","_prevAll","nextSibs","_nextAll","animatedNodes","concat","lines","line","visibility","removeAttribute","someLines","_removeClass","hideSiblings","_css","grandfatherVisible","_removeAttr","hideAncestorsSiblings","_buildParentNode","showParent","stopPropagation","parentState","_startLoading","source","Object","keys","addParent","_endLoading","that","descendants","isVerticalDesc","desc","prototype","apply","Set","_one","propertyName","count","_buildChildNode","symbol","showDescendants","childrenState","hideDescendants","addChildren","assign","hEdge","siblingsState","showSiblings","families","addSiblings","toggleBtn","descWrapper","ul","subToggleBtn","_clickNode","_clickHorizontalEdge","_clickBottomEdge","_clickToggleButton","isFirefox","test","window","navigator","userAgent","toLowerCase","dataTransfer","setData","transform","ghostNode","nodeCover","createElementNS","transValues","scale","Math","abs","parseFloat","offsetHeight","xOffset","offsetX","yOffset","offsetY","ghostNodeWrapper","src","XMLSerializer","serializeToString","setDragImage","dragged","dragZone","dragHier","index","dropCriteria","preventDefault","dropZone","includes","dropEffect","draggedTd","dropColspan","parseInt","colspan","find","dropSibs","dragColspan","dragSibs","td","customE","CustomEvent","dispatchEvent","level","parentId","verticalDepth","Number","substr","title","_hoverNode","bind","_dispatchClickEvent","_onDragStart","_onDragOver","_onDragEnd","_onDrop","createNode","appendTo","nodeWrapper","childNodes","isVerticalNode","isHidden","isVerticalLayer","lineLayer","join","nodeLayer","nodeCell"],"mappings":"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","file":"OrgChart.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"OrgChart\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"OrgChart\"] = factory();\n\telse\n\t\troot[\"OrgChart\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 21a13ca2bbfd5a7ecc43\n **/","export default class OrgChart {\r\n  constructor({\r\n    chartContainer,\r\n    data,\r\n    nodeTitle = 'name',\r\n    nodeContent,\r\n    nodeId = 'id',\r\n    toggleSiblingsResp = false,\r\n    depth = 999,\r\n    chartClass = '',\r\n    exportButton = false,\r\n    exportFilename = 'OrgChart',\r\n    parentNodeSymbol = 'fa-users',\r\n    draggable = false,\r\n    direction = 't2b',\r\n    pan = false,\r\n    zoom = false\r\n  } = {}) {\r\n    this._name = 'OrgChart';\r\n    this.data = data;\r\n    this.options = {\r\n      'chartContainer': chartContainer,\r\n      'nodeTitle': nodeTitle,\r\n      'nodeContent': nodeContent,\r\n      'nodeId': nodeId,\r\n      'toggleSiblingsResp': toggleSiblingsResp,\r\n      'depth': depth,\r\n      'chartClass': chartClass,\r\n      'exportButton': exportButton,\r\n      'exportFilename': exportFilename,\r\n      'parentNodeSymbol': parentNodeSymbol,\r\n      'draggable': draggable,\r\n      'direction': direction,\r\n      'pan': pan,\r\n      'zoom': zoom\r\n    };\r\n\r\n    this._init();\r\n  }\r\n  get name() {\r\n    return this._name;\r\n  }\r\n  _init() {\r\n    // build the org-chart\r\n    let opts = this.options,\r\n      data = this.data,\r\n      chart = document.createElement('div');\r\n\r\n    this.chart = chart;\r\n    chart.dataset.options = JSON.stringify(opts);\r\n    chart.setAttribute('class', 'orgchart' + (opts.chartClass !== '' ? ' ' + opts.chartClass : '') +\r\n      (opts.direction !== 't2b' ? ' ' + opts.direction : ''));\r\n    chart.addEventListener('click', function (event) {\r\n      let node = this._closest(event.target, function (el) {\r\n        return el.classList.contains('node');\r\n      });\r\n\r\n      if (!node) {\r\n        chart.querySelector('.node.focused').removeClass('focused');\r\n      }\r\n    }, false);\r\n    if (typeof data === 'object') {\r\n      if (data.nodeName) { // ul datasource\r\n        this.buildHierarchy(chart, this._buildJsonDS(data.children[0], 0, opts));\r\n      } else { // local json datasource\r\n        this.buildHierarchy(chart, opts.ajaxURL ? data : this._attachRel(data, '00'), 0, opts);\r\n      }\r\n    } else {\r\n      let spinner = document.createElement('i');\r\n\r\n      spinner.setAttribute('class', 'fa fa-circle-o-notch fa-spin spinner');\r\n      this._getJSON(data)\r\n      .then(function (resp) {\r\n        this.buildHierarchy(chart, opts.ajaxURL ? resp : this._attachRel(resp, '00'), 0, opts);\r\n      })\r\n      .catch(function (err) {\r\n        console.error('failed to fetch datasource for orgchart', err);\r\n      })\r\n      .finally(function () {\r\n        let spinner = chart.querySelector('.spinner');\r\n\r\n        spinner.parentNode.removeChild(spinner);\r\n      });\r\n    }\r\n    document.querySelector(opts.chartContainer).appendChild(chart);\r\n  }\r\n  _closest(el, fn) {\r\n    return el && (fn(el) ? el : this._closest(el.parentNode, fn));\r\n  }\r\n  _siblings(el, expr) {\r\n    return Array.from(el.parentNode.children).filter((child) => {\r\n      if (child !== el) {\r\n        if (expr) {\r\n          return el.matches(expr);\r\n        }\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n  }\r\n  _prevAll(el, expr) {\r\n    let sibs = [],\r\n      prevSib = el.previousElementSibling;\r\n\r\n    while (prevSib) {\r\n      if (!expr || prevSib.matches(expr)) {\r\n        sibs.push(prevSib);\r\n      }\r\n      prevSib = prevSib.previousElementSibling;\r\n    }\r\n    return sibs;\r\n  }\r\n  _nextAll(el, expr) {\r\n    let sibs = [];\r\n    let nextSib = el.nextElementSibling;\r\n\r\n    while (nextSib) {\r\n      if (!expr || nextSib.matches(expr)) {\r\n        sibs.push(nextSib);\r\n      }\r\n      nextSib = nextSib.nextElementSibling;\r\n    }\r\n    return sibs;\r\n  }\r\n  _isVisible(el) {\r\n    return el.offsetParent !== null;\r\n  }\r\n  _addClass(elements, classNames) {\r\n    elements.forEach((el) => {\r\n      if (classNames.indexOf(' ') > 0) {\r\n        classNames.split(' ').forEach((className) => el.classList.add(className));\r\n      } else {\r\n        el.classList.add(classNames);\r\n      }\r\n    });\r\n  }\r\n  _removeClass(elements, classNames) {\r\n    elements.forEach((el) => {\r\n      if (classNames.indexOf(' ') > 0) {\r\n        classNames.split(' ').forEach((className) => el.classList.remove(className));\r\n      } else {\r\n        el.classList.remove(classNames);\r\n      }\r\n    });\r\n  }\r\n  _css(elements, prop, val) {\r\n    elements.forEach((el) => {\r\n      el.style[prop] = val;\r\n    });\r\n  }\r\n  _removeAttr(elements, attr) {\r\n    elements.forEach((el) => {\r\n      el.removeAttr(attr);\r\n    });\r\n  }\r\n  _one(el, type, listener, self) {\r\n    let one = function (event) {\r\n      try {\r\n        listener.call(self, event);\r\n      } finally {\r\n        el.removeEventListener(type, one);\r\n      }\r\n    };\r\n\r\n    el.addEventListener(type, one);\r\n  }\r\n  _getJSON(url) {\r\n    return new Promise(function (resolve, reject) {\r\n      let client = new XMLHttpRequest();\r\n\r\n      function handler() {\r\n        if (this.readyState !== 4) {\r\n          return;\r\n        }\r\n        if (this.status === 200) {\r\n          resolve(this.response);\r\n        } else {\r\n          reject(new Error(this.statusText));\r\n        }\r\n      }\r\n      client.open('GET', url);\r\n      client.onreadystatechange = handler;\r\n      client.responseType = 'json';\r\n      client.setRequestHeader('Accept', 'application/json');\r\n      client.send();\r\n    });\r\n  }\r\n  _buildJsonDS(li) {\r\n    var subObj = {\r\n      'name': li.firstChild.textContent.trim(),\r\n      'relationship': (li.parentNode.parentNode.tagName === 'li' ? '1' : '0') +\r\n        (li.parentNode.children > 1 ? 1 : 0) + (li.children.length ? 1 : 0)\r\n    };\r\n\r\n    if (li.id) {\r\n      subObj.id = li.id;\r\n    }\r\n    for (let subLi of li.querySelector('ul').children) {\r\n      if (!subObj.children) { subObj.children = []; }\r\n      subObj.children.push(this._buildJsonDS(subLi));\r\n    }\r\n    return subObj;\r\n  }\r\n  _attachRel(data, flags) {\r\n    data.relationship = flags + (data.children && data.children.length > 0 ? 1 : 0);\r\n    if (data.children) {\r\n      for (let item of data.children) {\r\n        this._attachRel(item, '1' + (data.children.length > 1 ? 1 : 0));\r\n      }\r\n    }\r\n    return data;\r\n  }\r\n  _repaint(node) {\r\n    if (node) {\r\n      node.style.offsetWidth = node.offsetWidth;\r\n    }\r\n  }\r\n  // whether the cursor is hovering over the node\r\n  _isInAction(node) {\r\n    return node.querySelector(':scope > .edge').className.indexOf('fa-') > -1;\r\n  }\r\n  // detect the exist/display state of related node\r\n  _getNodeState(node, relation) {\r\n    let criteria,\r\n      state = { 'exist': false, 'visible': false };\r\n\r\n    if (relation === 'parent') {\r\n      criteria = this._closest(node, (el) => el.classList.contains('nodes'));\r\n      if (criteria) {\r\n        state.exist = true;\r\n      }\r\n      if (this._isVisible(criteria.previousElementSibling)) {\r\n        state.visible = true;\r\n      }\r\n    } else if (relation === 'children') {\r\n      criteria = this._closest(node, (el) => el.nodeName === 'TR').nextElementSibling;\r\n      if (criteria) {\r\n        state.exist = true;\r\n      }\r\n      if (this._isVisible(criteria)) {\r\n        state.visible = true;\r\n      }\r\n    } else if (relation === 'siblings') {\r\n      criteria = this._siblings(this._closest(node, (el) => el.nodeName === 'TABLE').parentNode);\r\n      if (criteria.length) {\r\n        state.exist = true;\r\n      }\r\n      if (criteria.some((el) => this._isVisible(el))) {\r\n        state.visible = true;\r\n      }\r\n    }\r\n\r\n    return state;\r\n  }\r\n  // find the related nodes\r\n  getRelatedNodes(node, relation) {\r\n    if (relation === 'parent') {\r\n      return this._closest(node, (el) => el.classList.contains('nodes'))\r\n        .parentNode.children[0].querySelector('.node');\r\n    } else if (relation === 'children') {\r\n      return Array.from(this._closest(node, (el) => el.nodeName === 'TABLE').lastChild.children)\r\n        .map((el) => el.querySelector('.node'));\r\n    } else if (relation === 'siblings') {\r\n      return this._siblings(this._closest(node, (el) => el.nodeName === 'TABLE').parentNode)\r\n        .map((el) => el.querySelector('.node'));\r\n    }\r\n  }\r\n  _switchHorizontalArrow(node) {\r\n    let opts = this.chart.dataset.options,\r\n      leftEdge = node.querySelector('.leftEdge'),\r\n      rightEdge = node.querySelector('.rightEdge'),\r\n      temp = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode;\r\n\r\n    if (opts.toggleSiblingsResp && (typeof opts.ajaxURL === 'undefined' ||\r\n      this._closest(node, (el) => el.classList.contains('.nodes')).dataset.siblingsLoaded)) {\r\n      let prevSib = temp.previousElementSibling,\r\n        nextSib = temp.nextElementSibling;\r\n\r\n      if (prevSib) {\r\n        if (prevSib.classList.contains('hidden')) {\r\n          leftEdge.classList.add('fa-chevron-left');\r\n          leftEdge.classList.remove('fa-chevron-right');\r\n        } else {\r\n          leftEdge.classList.add('fa-chevron-right');\r\n          leftEdge.classList.remove('fa-chevron-left');\r\n        }\r\n      }\r\n      if (nextSib) {\r\n        if (nextSib.classList.contains('hidden')) {\r\n          rightEdge.classList.add('fa-chevron-right');\r\n          rightEdge.classList.remove('fa-chevron-left');\r\n        } else {\r\n          rightEdge.classList.add('fa-chevron-left');\r\n          rightEdge.classList.remove('fa-chevron-right');\r\n        }\r\n      }\r\n    } else {\r\n      let sibs = this._siblings(temp),\r\n        sibsVisible = sibs.length ? !sibs.some((el) => el.classList.contains('hidden')) : false;\r\n\r\n      leftEdge.classList.toggle('fa-chevron-right', sibsVisible);\r\n      leftEdge.classList.toggle('fa-chevron-left', !sibsVisible);\r\n      rightEdge.classList.toggle('fa-chevron-left', sibsVisible);\r\n      rightEdge.classList.toggle('fa-chevron-right', !sibsVisible);\r\n    }\r\n  }\r\n  _hoverNode(event) {\r\n    let node = event.target,\r\n      flag = false,\r\n      topEdge = node.querySelector(':scope > .topEdge'),\r\n      bottomEdge = node.querySelector(':scope > .bottomEdge'),\r\n      leftEdge = node.querySelector(':scope > .leftEdge');\r\n\r\n    if (event.type === 'mouseenter') {\r\n      if (topEdge) {\r\n        flag = this._getNodeState(node, 'parent').visible;\r\n        topEdge.classList.toggle('fa-chevron-up', !flag);\r\n        topEdge.classList.toggle('fa-chevron-down', flag);\r\n      }\r\n      if (bottomEdge) {\r\n        flag = this._getNodeState(node, 'children').visible;\r\n        bottomEdge.classList.toggle('fa-chevron-down', !flag);\r\n        bottomEdge.classList.toggle('fa-chevron-up', flag);\r\n      }\r\n      if (leftEdge) {\r\n        this._switchHorizontalArrow(node);\r\n      }\r\n    } else {\r\n      Array.from(node.querySelectorAll(':scope > .edge')).forEach((el) => {\r\n        el.classList.remove('fa-chevron-up', 'fa-chevron-down', 'fa-chevron-right', 'fa-chevron-left');\r\n      });\r\n    }\r\n  }\r\n  // define node click event handler\r\n  _clickNode(event) {\r\n    let node = event.target;\r\n\r\n    this.chart.querySelector('.focused').classList.remove('focused');\r\n    node.classList.add('focused');\r\n  }\r\n  // build the parent node of specific node\r\n  _buildParentNode(currentRoot, nodeData, opts, callback) {\r\n    let table = document.createElement('table');\r\n\r\n    nodeData.relationship = '001';\r\n    this._createNode(nodeData, 0, opts || this.chart.dataset.options)\r\n      .then(function (nodeDiv) {\r\n        let chart = this.chart;\r\n\r\n        nodeDiv.classList.remove('slide-up');\r\n        nodeDiv.classList.add('slide-down');\r\n        table.innerHTML = `\r\n          <tr class=\"hidden\"><td colspan=\"2\"></td></tr>\r\n          <tr class=\"lines hidden\"><td colspan=\"2\"><div class=\"downLine\"></div></td></tr>\r\n          <tr class=\"lines hidden\"><td class=\"rightLine\">&nbsp;</td><td class=\"leftLine\">&nbsp;</td></tr>\r\n          <tr class=\"nodes\"><td colspan=\"2\"></td></tr>\r\n        `;\r\n        table.firstChild.firstChild.appendChild(nodeDiv);\r\n        chart.insertBefore(table, chart.firstChild);\r\n        table.lastChild.firstChild.appendChild(chart.lastChild);\r\n        callback();\r\n      })\r\n      .catch(function (err) {\r\n        console.error('Failed to create parent node', err);\r\n      });\r\n  }\r\n  _switchVerticalArrow(arrow) {\r\n    arrow.classList.toggle('fa-chevron-up');\r\n    arrow.classList.toggle('fa-chevron-down');\r\n  }\r\n  // show the parent node of the specified node\r\n  showParent(node) {\r\n    // just show only one superior level\r\n    let temp = this._closest(node, function (el) {\r\n      return el.nodeName === 'TABLE';\r\n    }).parentNode.children;\r\n\r\n    for (let tr of temp) {\r\n      tr.classList.remove('hidden');\r\n    }\r\n    // just show only one line\r\n    this._addClass(temp[2].children.slice(1, -1), 'hidden');\r\n    // show parent node with animation\r\n    let parent = temp[0].querySelector('.node');\r\n\r\n    this._repaint(parent);\r\n    parent.classList.add('slide');\r\n    parent.classList.remove('slide-down');\r\n    parent.addEventListener('transitionend', function () {\r\n      parent.classList.remove('slide');\r\n      if (this._isInAction(node)) {\r\n        this._switchVerticalArrow(node.querySelector(':scope > .topEdge'));\r\n      }\r\n    }, { 'once': true});\r\n  }\r\n  // hide the sibling nodes of the specified node\r\n  hideSiblings(node, direction) {\r\n    let nodeContainer = this._closest(node, function (el) {\r\n      return el.nodeName === 'TABLE';\r\n    }).parentNode;\r\n\r\n    let siblings = this._siblings(nodeContainer);\r\n\r\n    for (let sib of siblings) {\r\n      if (sib.querySelector('.spinner')) {\r\n        this.chart.dataset.inAjax = false;\r\n      }\r\n    }\r\n\r\n    if (!direction || (direction && direction === 'left')) {\r\n      let preSibs = this._prevAll(nodeContainer);\r\n\r\n      for (let sib of preSibs) {\r\n        for (let node of sib.querySelectorAll('.node')) {\r\n          if (!this._isVisible(node)) {\r\n            node.classList.add('slide', 'slide-right');\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (!direction || (direction && direction !== 'left')) {\r\n      let nextSibs = this._nextAll(nodeContainer);\r\n\r\n      for (let sib of nextSibs) {\r\n        for (let node of sib.querySelectorAll('.node')) {\r\n          if (!this._isVisible(node)) {\r\n            node.classList.add('slide', 'slide-left');\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    let animatedNodes = [];\r\n\r\n    for (let sib of this._siblings(nodeContainer)) {\r\n      animatedNodes.concat(sib.querySelectorAll('.slide'));\r\n    }\r\n    let lines = [];\r\n\r\n    for (let node of animatedNodes) {\r\n      let temp = this._closest(node, function (el) {\r\n        return el.classList.contains('nodes');\r\n      }).parentNode.firstChild;\r\n\r\n      lines.push(temp);\r\n      lines.push(temp.nextElementSibling);\r\n    }\r\n    lines.forEach(function (line) {\r\n      line.style.visibility = 'hidden';\r\n    });\r\n\r\n    animatedNodes[0].addEventListener('transitionend', function () {\r\n      lines.forEach(function (line) {\r\n        line.removeAttribute('style');\r\n      });\r\n      let sibs = [];\r\n\r\n      if (direction) {\r\n        if (direction === 'left') {\r\n          sibs = this._prevAll(nodeContainer, ':not(.hidden)');\r\n        } else {\r\n          sibs = this._nextAll(nodeContainer, ':not(.hidden)');\r\n        }\r\n      } else {\r\n        sibs = this._siblings(nodeContainer);\r\n      }\r\n      let temp = this._closest(nodeContainer, function (el) {\r\n        return el.classList.contains('nodes');\r\n      }).previousElementSibling.querySelectorAll(':scope > :not(.hidden)');\r\n\r\n      let someLines = temp.slice(1, direction ? sibs.length * 2 + 1 : -1);\r\n\r\n      this._addClass(someLines, 'hidden');\r\n      this._removeClass(animatedNodes, 'slide');\r\n      sibs.querySelectorAll('.node').slice(1).forEach(function (node) {\r\n        if (this._isVisible(node)) {\r\n          node.classList.remove('slide-left', 'slide-right');\r\n          node.classList.add('slide-up');\r\n        }\r\n      });\r\n      this._addClass(sibs.querySelectorAll('.lines'), 'hidden');\r\n      this._addClass(sibs.querySelectorAll('.nodes'), 'hidden');\r\n      this._addClass(sibs.querySelectorAll('.verticalNodes'), 'hidden');\r\n      this._addClass(sibs, 'hidden');\r\n\r\n      if (this._isInAction(node)) {\r\n        this._switchHorizontalArrow(node);\r\n      }\r\n    }, { 'once': true });\r\n  }\r\n  // recursively hide the ancestor node and sibling nodes of the specified node\r\n  hideAncestorsSiblings(node) {\r\n    let temp = this._closest(node, function (el) {\r\n      return el.classList.contains('nodes');\r\n    }).parentNode.children;\r\n\r\n    if (temp[0].querySelector('.spinner')) {\r\n      this.chart.dataset.inAjax = false;\r\n    }\r\n    // hide the sibling nodes\r\n    if (this._getNodeState(node, 'siblings').visible) {\r\n      this.hideSiblings(node);\r\n    }\r\n    // hide the lines\r\n    let lines = temp.slice(1);\r\n\r\n    this._css(lines, 'visibility', 'hidden');\r\n    // hide the superior nodes with transition\r\n    let parent = temp[0].querySelector('.node'),\r\n      grandfatherVisible = this._getNodeState(parent, 'parent').visible;\r\n\r\n    if (parent && this._isVisible(parent)) {\r\n      parent.classList.add('slide', 'slide-down');\r\n      parent.addEventListener('transitionend', function () {\r\n        parent.classList.remove('slide');\r\n        this._removeAttr(lines, 'style');\r\n        this._addClass(temp, 'hidden');\r\n      }, { 'once': true });\r\n    }\r\n    // if the current node has the parent node, hide it recursively\r\n    if (parent && grandfatherVisible) {\r\n      this.hideAncestorsSiblings(parent);\r\n    }\r\n  }\r\n  // exposed method\r\n  addParent(currentRoot, data, opts) {\r\n    this._buildParentNode(currentRoot, data, opts, function () {\r\n      if (!currentRoot.querySelector(':scope .topEdge').length) {\r\n        let topEdge = document.createElement('i');\r\n\r\n        topEdge.setAttribute('class', 'edge verticalEdge topEdge fa');\r\n        currentRoot.appendChild(topEdge);\r\n      }\r\n      this.showParent(currentRoot);\r\n    });\r\n  }\r\n  // define click event handler for the top edge\r\n  _clickTopEdge(event) {\r\n    event.stopPropagation();\r\n    let topEdge = event.target,\r\n      node = topEdge.parentNode,\r\n      parentState = this._getNodeState(node, 'parent'),\r\n      opts = this.chart.dataset.options;\r\n\r\n    if (parentState.exist) {\r\n      let temp = this._closest(node, function (el) {\r\n        return el.classList.contains('nodes');\r\n      });\r\n      let parent = temp.parentNode.firstChild.querySelector('.node');\r\n\r\n      if (parent.classList.contains('slide')) { return; }\r\n      // hide the ancestor nodes and sibling nodes of the specified node\r\n      if (parentState.visible) {\r\n        this.hideAncestorsSiblings(node);\r\n        parent.addEventListener('transitionend', function () {\r\n          if (this._isInAction(node)) {\r\n            this._switchVerticalArrow(topEdge);\r\n            this._switchHorizontalArrow(node);\r\n          }\r\n        }, { 'once': true });\r\n      } else { // show the ancestors and siblings\r\n        this.showParent(node);\r\n      }\r\n    } else {\r\n      // load the new parent node of the specified node by ajax request\r\n      let nodeId = topEdge.parentNode.id;\r\n\r\n      // start up loading status\r\n      if (this._startLoading(topEdge, node, opts)) {\r\n        // load new nodes\r\n        this._getJSON(typeof opts.ajaxURL.parent === 'function' ?\r\n          opts.ajaxURL.parent(node.dataset.source) : opts.ajaxURL.parent + nodeId)\r\n        .then(function (resp) {\r\n          if (this.chart.dataset.inAjax) {\r\n            if (!Object.keys(resp).length) {\r\n              this.addParent(node, resp, opts);\r\n            }\r\n          }\r\n        })\r\n        .catch(function (err) {\r\n          console.error('Failed to get parent node data.', err);\r\n        })\r\n        .finally(function () {\r\n          this._endLoading(topEdge, node, opts);\r\n        });\r\n      }\r\n    }\r\n  }\r\n  // recursively hide the descendant nodes of the specified node\r\n  hideDescendants(node) {\r\n    let that = this,\r\n      temp = this._nextAll(node.parentNode.parentNode),\r\n      lines = [];\r\n\r\n    if (temp[2].querySelector('.spinner')) {\r\n      this.chart.dataset.inAjax = false;\r\n    }\r\n    let descendants = Array.from(temp[2].querySelectorAll('.node')).filter((el) => that._isVisible(el)),\r\n      isVerticalDesc = temp[2].classList.contains('verticalNodes');\r\n\r\n    if (!isVerticalDesc) {\r\n      descendants.forEach((desc) => {\r\n        Array.prototype.push.apply(lines,\r\n          that._prevAll(that._closest(desc, (el) => el.classList.contains('nodes')), '.lines'));\r\n      });\r\n      lines = [...new Set(lines)];\r\n      this._css(lines, 'visibility', 'hidden');\r\n    }\r\n    this._one(descendants[0], 'transitionend', function (event) {\r\n      if (event.propertyName === 'top') {\r\n        this._removeClass(descendants, 'slide');\r\n        if (isVerticalDesc) {\r\n          that._addClass(temp, 'hidden');\r\n        } else {\r\n          lines.forEach((el) => {\r\n            el.removeAttribute('style');\r\n            el.classList.add('hidden');\r\n            el.parentNode.lastChild.classList.add('hidden');\r\n          });\r\n          this._addClass(Array.from(temp[2].querySelectorAll('.verticalNodes')), 'hidden');\r\n        }\r\n        if (this._isInAction(node)) {\r\n          this._switchVerticalArrow(node.querySelector('.bottomEdge'));\r\n        }\r\n      }\r\n    }, this);\r\n    this._addClass(descendants, 'slide slide-up');\r\n  }\r\n  // show the children nodes of the specified node\r\n  showDescendants(node) {\r\n    let that = this,\r\n      temp = this._nextAll(node.parentNode.parentNode),\r\n      descendants = [];\r\n\r\n    this._removeClass(temp, 'hidden');\r\n    if (temp.some((el) => el.classList.contains('verticalNodes'))) {\r\n      temp.forEach((el) => {\r\n        Array.prototype.push.apply(descendants, Array.from(el.querySelectorAll('.node')).filter((el) => {\r\n          return that._isVisible(el);\r\n        }));\r\n      });\r\n    } else {\r\n      Array.from(temp[2].children).forEach((el) => {\r\n        Array.prototype.push.apply(descendants,\r\n          Array.from(el.querySelector('tr').querySelectorAll('.node')).filter((el) => {\r\n            return that._isVisible(el);\r\n          }));\r\n      });\r\n    }\r\n    // the two following statements are used to enforce browser to repaint\r\n    this._repaint(descendants[0]);\r\n    // descendants.forEach((el) => {\r\n    //   el.classList.add('slide');\r\n    //   el.classList.remove('slide-up');\r\n    // });\r\n    this._one(descendants[0], 'transitionend', (event) => {\r\n      // hackiness that filters the transitionend callback handling for only one of the transitioned properties\r\n      if (event.propertyName === 'top') {\r\n        this._removeClass(descendants, 'slide');\r\n        if (this._isInAction(node)) {\r\n          that._switchVerticalArrow(node.querySelector('.bottomEdge'));\r\n        }\r\n      }\r\n    }, this);\r\n    this._addClass(descendants, 'slide');\r\n    this._removeClass(descendants, 'slide-up');\r\n  }\r\n  // exposed method\r\n  addChildren(node, data, opts) {\r\n    if (!opts) {\r\n      opts = this.chart.dataset.options;\r\n    }\r\n    let count = 0;\r\n\r\n    this._buildChildNode(this._closest(node, (el) => el.nodeName === 'TABLE'), data, opts, function () {\r\n      if (++count === data.children.length) {\r\n        if (!node.querySelector('.bottomEdge')) {\r\n          let bottomEdge = document.createElement('i');\r\n\r\n          bottomEdge.setAttribute('class', 'edge verticalEdge bottomEdge fa');\r\n          node.appendChild(bottomEdge);\r\n        }\r\n        if (!node.querySelector('.symbol')) {\r\n          let symbol = document.createElement('i');\r\n\r\n          symbol.setAttribute('class', 'fa ' + opts.parentNodeSymbol + ' symbol');\r\n          node.querySelector(':scope > .title').appendChild(symbol);\r\n        }\r\n        this.showDescendants(node);\r\n      }\r\n    });\r\n  }\r\n  // bind click event handler for the bottom edge\r\n  _clickBottomEdge(event) {\r\n    event.stopPropagation();\r\n    let opts = this.chart.dataset.options,\r\n      bottomEdge = event.target,\r\n      node = bottomEdge.parentNode,\r\n      childrenState = this._getNodeState(node, 'children');\r\n\r\n    if (childrenState.exist) {\r\n      let temp = this._closest(node, function (el) {\r\n        return el.nodeName === 'TR';\r\n      }).parentNode.children[3];\r\n\r\n      if (Array.from(temp.querySelectorAll('.node')).some((node) => {\r\n        return this._isVisible(node) && node.classList.contains('slide');\r\n      })) { return; }\r\n      // hide the descendant nodes of the specified node\r\n      if (childrenState.visible) {\r\n        this.hideDescendants(node);\r\n      } else { // show the descendants\r\n        this.showDescendants(node);\r\n      }\r\n    } else { // load the new children nodes of the specified node by ajax request\r\n      let nodeId = bottomEdge.parentNode.id;\r\n\r\n      if (this._startLoading(bottomEdge, node, opts)) {\r\n        this._getJSON(typeof opts.ajaxURL.children === 'function' ?\r\n          opts.ajaxURL.children(node.dataset.source) : opts.ajaxURL.children + nodeId)\r\n        .then(function (resp) {\r\n          if (this.chart.dataset.inAjax) {\r\n            if (resp.children.length) {\r\n              this.addChildren(node, resp, Object.assign({}, opts, { depth: 0 }));\r\n            }\r\n          }\r\n        })\r\n        .catch(function (err) {\r\n          console.error('Failed to get children nodes data', err);\r\n        })\r\n        .finally(function () {\r\n          this._endLoading(bottomEdge, node, opts);\r\n        });\r\n      }\r\n    }\r\n  }\r\n  // bind click event handler for the left and right edges\r\n  _clickHorizontalEdge(event) {\r\n    event.stopPropagation();\r\n    let opts = this.chart.dataset.options,\r\n      hEdge = event.target,\r\n      node = hEdge.parentNode,\r\n      siblingsState = this._getNodeState(node, 'siblings');\r\n\r\n    if (siblingsState.exist) {\r\n      let temp = this._closest(node, function (el) {\r\n          return el.nodeName === 'TABLE';\r\n        }).parentNode,\r\n        siblings = this._siblings(temp);\r\n\r\n      if (siblings.querySelectorAll('.node').some((node) => {\r\n        return this._isVisible(node) && node.classList.contains('slide');\r\n      })) { return; }\r\n      if (opts.toggleSiblingsResp) {\r\n        let prevSib = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode.previousElementSibling,\r\n          nextSib = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode.nextElementSibling;\r\n\r\n        if (hEdge.classList.contains('.leftEdge')) {\r\n          if (prevSib.classList.contains('.hidden')) {\r\n            this.showSiblings(node, 'left');\r\n          } else {\r\n            this.hideSiblings(node, 'left');\r\n          }\r\n        } else {\r\n          if (nextSib.classList.contains('.hidden')) {\r\n            this.showSiblings(node, 'right');\r\n          } else {\r\n            this.hideSiblings(node, 'right');\r\n          }\r\n        }\r\n      } else {\r\n        if (siblingsState.visible) {\r\n          this.hideSiblings(node);\r\n        } else {\r\n          this.showSiblings(node);\r\n        }\r\n      }\r\n    } else {\r\n      // load the new sibling nodes of the specified node by ajax request\r\n      let nodeId = hEdge.parentNode.id,\r\n        url = (this._getNodeState(node, 'parent').exist) ?\r\n          (typeof opts.ajaxURL.siblings === 'function' ?\r\n            opts.ajaxURL.siblings(node.dataset.source) : opts.ajaxURL.siblings + nodeId) :\r\n          (typeof opts.ajaxURL.families === 'function' ?\r\n            opts.ajaxURL.families(node.dataset.source) : opts.ajaxURL.families + nodeId);\r\n\r\n      if (this._startLoading(hEdge, node, opts)) {\r\n        this._getJSON(url)\r\n        .then(function (resp) {\r\n          if (this.chart.dataset.inAjax) {\r\n            if (resp.siblings || resp.children) {\r\n              this.addSiblings(node, resp, opts);\r\n            }\r\n          }\r\n        })\r\n        .catch(function (err) {\r\n          console.err('Failed to get sibling nodes data', err);\r\n        })\r\n        .finally(function () {\r\n          this._endLoading(hEdge, node, opts);\r\n        });\r\n      }\r\n    }\r\n  }\r\n  // event handler for toggle buttons in Hybrid(horizontal + vertical) OrgChart\r\n  _clickToggleButton(event) {\r\n    let that = this,\r\n      toggleBtn = event.target,\r\n      descWrapper = toggleBtn.parentNode.nextElementSibling,\r\n      descendants = descWrapper.querySelectorAll('.node'),\r\n      children = descWrapper.children.map(function (item) {\r\n        return item.querySelector('.node');\r\n      });\r\n\r\n    if (children.some((item) => item.classList.contains('.slide'))) { return; }\r\n    toggleBtn.classList.toggle('fa-plus-square');\r\n    toggleBtn.classList.toggle('fa-minus-square');\r\n    if (descendants[0].classList.contains('.slide-up')) {\r\n      descWrapper.classList.remove('hidden');\r\n      this._repaint(children[0]);\r\n      this._addClass(children, 'slide');\r\n      this._removeClass(children, 'slide-up');\r\n      children[0].addEventListener('transitionend', function () {\r\n        that._removeClass(children, 'slide');\r\n      }, { 'once': true });\r\n    } else {\r\n      this._addClass(descendants, 'slide slide-up');\r\n      descendants[0].addEventListener('transitionend', function () {\r\n        that._removeClass(descendants, 'slide');\r\n        let ul = this._closest(descendants[0], function (el) {\r\n          return el.nodeName === 'ul';\r\n        });\r\n\r\n        ul.classList.add('hidden');\r\n      }, { 'once': true });\r\n      let subToggleBtn = descendants[0].querySelector('.toggleBtn').classList.remove('fa-minus-square');\r\n\r\n      subToggleBtn.classList.add('fa-plus-square');\r\n    }\r\n  }\r\n  _dispatchClickEvent(event) {\r\n    let classList = event.target.classList;\r\n\r\n    if (classList.contains('topEdge')) {\r\n      this._clickNode(event);\r\n    } else if (classList.contains('rightEdge') || classList.contains('leftEdge')) {\r\n      this._clickHorizontalEdge(event);\r\n    } else if (classList.contains('bottomEdge')) {\r\n      this._clickBottomEdge(event);\r\n    } else if (classList.contains('toggleBtn')) {\r\n      this._clickToggleButton(event);\r\n    } else {\r\n      this._clickNode(event);\r\n    }\r\n  }\r\n  _onDragStart(event) {\r\n    let nodeDiv = event.target,\r\n      opts = this.chart.dataset.options,\r\n      isFirefox = /firefox/.test(window.navigator.userAgent.toLowerCase());\r\n\r\n    if (isFirefox) {\r\n      event.dataTransfer.setData('text/html', 'hack for firefox');\r\n    }\r\n    // if users enable zoom or direction options\r\n    if (this.chart.style.transform !== 'none') {\r\n      let ghostNode, nodeCover;\r\n\r\n      if (!document.querySelector('.ghost-node')) {\r\n        ghostNode = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n        ghostNode.classList.add('ghost-node');\r\n        nodeCover = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n        ghostNode.appendChild(nodeCover);\r\n        this.chart.appendChild(ghostNode);\r\n      } else {\r\n        ghostNode = this.chart.querySelector(':scope > .ghost-node');\r\n        nodeCover = ghostNode.children[0];\r\n      }\r\n      let transValues = this.chart.style.transform.split(','),\r\n        scale = Math.abs(window.parseFloat((opts.direction === 't2b' || opts.direction === 'b2t') ?\r\n          transValues[0].slice(transValues[0].indexOf('(') + 1) : transValues[1]));\r\n\r\n      ghostNode.setAttribute('width', nodeDiv.offsetWidth);\r\n      ghostNode.setAttribute('height', nodeDiv.offsetHeight);\r\n      nodeCover.setAttribute('x', 5 * scale);\r\n      nodeCover.setAttribute('y', 5 * scale);\r\n      nodeCover.setAttribute('width', 120 * scale);\r\n      nodeCover.setAttribute('height', 40 * scale);\r\n      nodeCover.setAttribute('rx', 4 * scale);\r\n      nodeCover.setAttribute('ry', 4 * scale);\r\n      nodeCover.setAttribute('stroke-width', 1 * scale);\r\n      let xOffset = event.offsetX * scale,\r\n        yOffset = event.offsetY * scale;\r\n\r\n      if (opts.direction === 'l2r') {\r\n        xOffset = event.offsetY * scale;\r\n        yOffset = event.offsetX * scale;\r\n      } else if (opts.direction === 'r2l') {\r\n        xOffset = nodeDiv.offsetWidth - event.offsetY * scale;\r\n        yOffset = event.offsetX * scale;\r\n      } else if (opts.direction === 'b2t') {\r\n        xOffset = nodeDiv.offsetWidth - event.offsetX * scale;\r\n        yOffset = nodeDiv.offsetHeight - event.offsetY * scale;\r\n      }\r\n      if (isFirefox) { // hack for old version of Firefox(< 48.0)\r\n        let ghostNodeWrapper = document.createElement('img');\r\n\r\n        ghostNodeWrapper.src = 'data:image/svg+xml;utf8,' + (new XMLSerializer()).serializeToString(ghostNode);\r\n        event.dataTransfer.setDragImage(ghostNodeWrapper, xOffset, yOffset);\r\n        nodeCover.setAttribute('fill', 'rgb(255, 255, 255)');\r\n        nodeCover.setAttribute('stroke', 'rgb(191, 0, 0)');\r\n      } else {\r\n        event.dataTransfer.setDragImage(ghostNode, xOffset, yOffset);\r\n      }\r\n    }\r\n    let dragged = event.target,\r\n      dragZone = this._closest(dragged, (el) => {\r\n        return el.classList.contains('.nodes');\r\n      }).parentNode.children[0].querySelector('.node'),\r\n      dragHier = this._closest(dragged, (el) => {\r\n        return el.nodeName === 'TABLE';\r\n      }).querySelectorAll('.node');\r\n\r\n    this.chart.dataset.dragged = dragged;\r\n    Array.from(this.chart.querySelectorAll('.node')).forEach(function (node) {\r\n      if (dragHier.index(node) === -1) {\r\n        if (opts.dropCriteria) {\r\n          if (opts.dropCriteria(dragged, dragZone, node)) {\r\n            node.classList.add('allowedDrop');\r\n          }\r\n        } else {\r\n          node.classList.add('allowedDrop');\r\n        }\r\n      }\r\n    });\r\n  }\r\n  _onDragOver(event) {\r\n    event.preventDefault();\r\n    let opts = this.chart.dataset.options,\r\n      dropZone = event.target,\r\n      dragged = this.chart.dataset.dragged,\r\n      dragZone = this._closest(dragged, function (el) {\r\n        return el.classList.contains('.nodes');\r\n      }).parentNode.children[0].querySelector('.node');\r\n\r\n    if (Array.from(this._closest(dragged, (el) => el.nodeName === 'TABLE').querySelectorAll('.node'))\r\n      .includes(dropZone) || (opts.dropCriteria && !opts.dropCriteria(dragged, dragZone, dropZone))) {\r\n      event.dataTransfer.dropEffect = 'none';\r\n    }\r\n  }\r\n  _onDragEnd(event) {\r\n    Array.from(this.chart.querySelectorAll('.allowedDrop')).forEach(function (el) {\r\n      el.classList.remove('allowedDrop');\r\n    });\r\n  }\r\n  _onDrop(event) {\r\n    let dropZone = event.target,\r\n      chart = this.chart,\r\n      dragged = chart.dataset.dragged,\r\n      dragZone = this._closest(dragged, function (el) {\r\n        return el.classList.contains('.nodes');\r\n      }).parentNode.children[0].firstChild;\r\n\r\n    this._removeClass(chart.querySelectorAll('.allowedDrop'), 'allowedDrop');\r\n    // firstly, deal with the hierarchy of drop zone\r\n    if (!dropZone.parentNode.parentNode.nextElementSibling) { // if the drop zone is a leaf node\r\n      let bottomEdge = document.createElement('i');\r\n\r\n      bottomEdge.setAttribute('class', 'edge verticalEdge bottomEdge fa');\r\n      dropZone.appendChild(bottomEdge);\r\n      dropZone.parentNode.setAttribute('colspan', 2);\r\n      let table = this._closest(dropZone, function (el) {\r\n          return el.nodeName === 'TABLE';\r\n        }),\r\n        tr = document.createElement(tr);\r\n\r\n      tr.setAttribute('class', 'lines');\r\n      tr.innerHTML = `<td colspan=\"2\"><div class=\"downLine\"></div></td>`;\r\n      table.appendChild(tr);\r\n      tr.innerHTML = `<td class=\"rightLine\">&nbsp;</td><td class=\"leftLine\">&nbsp;</td>`;\r\n      table.appendChild(tr);\r\n      tr.setAttribute('class', 'nodes');\r\n      tr.innerHTML = ``;\r\n      table.appendChild(tr);\r\n      for (let hEdge of dragged.querySelectorAll('.horizontalEdge')) {\r\n        dragged.removeChild(hEdge);\r\n      }\r\n      let draggedTd = this._closest(dragged, (el) => el.nodeName === 'TABLE').parentNode;\r\n\r\n      tr.appendChild(draggedTd);\r\n    } else {\r\n      let dropColspan = window.parseInt(dropZone.parentNode.colspan) + 2,\r\n        hEdge = document.createElement('i');\r\n\r\n      dropZone.parentNode.setAttribute('colspan', dropColspan);\r\n      dropZone.parentNode.parentNode.nextElementSibling.firstChild.setAttribute('colspan', dropColspan);\r\n      if (!dragged.find('.horizontalEdge').length) {\r\n        hEdge.setAttribute('class', 'edge horizontalEdge rightEdge fa');\r\n        dragged.appendChild(hEdge);\r\n        hEdge.classList.remove('rightEdge');\r\n        hEdge.classList.add('leftEdge');\r\n        dragged.appendChild(hEdge);\r\n      }\r\n      let temp = dropZone.parentNode.parentNode.nextElementSibling.nextElementSibling,\r\n        line = document.createElement('td');\r\n\r\n      line.setAttribute('class', 'leftLine topLine');\r\n      line.innerHTML = `&nbsp;`;\r\n      temp.insertBefore(line, temp.lastChild);\r\n      line.classList.remove('leftLine');\r\n      line.classList.add('rightLine');\r\n      temp.insertBefore(line, temp.lastChild);\r\n      temp.nextElementSibling.appendChild(this._closest(dragged, function (el) {\r\n        return el.nodeName === 'TABLE';\r\n      }).parentNode);\r\n\r\n      let dropSibs = this._closest(dragged, function (el) {\r\n        return el.classList.contains('nodes');\r\n      }).children;\r\n\r\n      if (dropSibs.length === 1) {\r\n        dropSibs[0].firstChild.appendChild(hEdge);\r\n        hEdge.classList.remove('leftEdge');\r\n        hEdge.classList.add('rightEdge');\r\n        dropSibs[0].firstChild.appendChild(hEdge);\r\n      }\r\n    }\r\n    // secondly, deal with the hierarchy of dragged node\r\n    let dragColspan = window.parseInt(dragZone.colspan);\r\n\r\n    if (dragColspan > 2) {\r\n      dragZone.setAttribute('colspan', dragColspan - 2);\r\n      dragZone.parentNode.nextElementSibling.firstChild.setAttribute('colspan', dragColspan - 2);\r\n      let temp = dragZone.parentNode.nextElementSibling.nextElementSibling;\r\n\r\n      temp.removeChild(temp.children[1]);\r\n      temp.removeChild(temp.children[2]);\r\n\r\n      let dragSibs = Array.from(dragZone.parentNode.parentNode.children[3].children).map(function (td) {\r\n        return td.querySelector('.node');\r\n      });\r\n\r\n      if (dragSibs.length === 1) {\r\n        dragSibs[0].removeChild(dragSibs[0].querySelector('.horizontalEdge'));\r\n      }\r\n    } else {\r\n      dragZone.removeAttribute('colspan');\r\n      dragZone.removeChild(dragZone.querySelector('.bottomEdge'));\r\n      Array.from(dragZone.parentNode.parentNode.children).slice(1)\r\n        .forEach((tr) => dragged.parentNode.parentNode.removeChild(tr));\r\n    }\r\n    let customE = new CustomEvent('nodedropped.orgchart', {\r\n      'draggedNode': dragged,\r\n      'dragZone': dragZone.children,\r\n      'dropZone': dropZone\r\n    });\r\n\r\n    chart.dispatchEvent(customE);\r\n  }\r\n  // create node\r\n  _createNode(nodeData, level, opts) {\r\n    let that = this;\r\n\r\n    return new Promise(function (resolve, reject) {\r\n      if (nodeData.children) {\r\n        for (let child of nodeData.children) {\r\n          child.parentId = nodeData.id;\r\n        }\r\n      }\r\n\r\n      // construct the content of node\r\n      let nodeDiv = document.createElement('div');\r\n\r\n      delete nodeData.children;\r\n      nodeDiv.dataset.source = JSON.stringify(nodeData);\r\n      if (nodeData[opts.nodeId]) {\r\n        nodeDiv.id = nodeData[opts.nodeId];\r\n      }\r\n      nodeDiv.setAttribute('class', 'node ' + (nodeData.className || '') + (level >= opts.depth ? ' slide-up' : ''));\r\n      if (opts.draggable) {\r\n        nodeDiv.setAttribute('draggable', true);\r\n      }\r\n      if (nodeData.parentId) {\r\n        nodeDiv.setAttribute('data-parent', nodeData.parentId);\r\n      }\r\n      nodeDiv.innerHTML = `\r\n        <div class=\"title\">${nodeData[opts.nodeTitle]}</div>\r\n        ${opts.nodeContent ? `<div class=\"content\">${nodeData[opts.nodeContent]}</div>` : ''}\r\n      `;\r\n      // append 4 direction arrows or expand/collapse buttons\r\n      let flags = nodeData.relationship || '';\r\n\r\n      if (opts.verticalDepth && (level + 2) > opts.verticalDepth) {\r\n        if ((level + 1) >= opts.verticalDepth && Number(flags.substr(2, 1))) {\r\n          let toggleBtn = document.createElement('i');\r\n\r\n          toggleBtn.setAttribute('class', 'toggleBtn fa fa-minus-square');\r\n          nodeDiv.appendChild(toggleBtn);\r\n        }\r\n      } else {\r\n        if (Number(flags.substr(0, 1))) {\r\n          let topEdge = document.createElement('i');\r\n\r\n          topEdge.setAttribute('class', 'edge verticalEdge topEdge fa');\r\n          nodeDiv.appendChild(topEdge);\r\n        }\r\n        if (Number(flags.substr(1, 1))) {\r\n          let rightEdge = document.createElement('i'),\r\n            leftEdge = document.createElement('i');\r\n\r\n          rightEdge.setAttribute('class', 'edge horizontalEdge rightEdge fa');\r\n          nodeDiv.appendChild(rightEdge);\r\n          leftEdge.setAttribute('class', 'edge horizontalEdge leftEdge fa');\r\n          nodeDiv.appendChild(leftEdge);\r\n        }\r\n        if (Number(flags.substr(2, 1))) {\r\n          let bottomEdge = document.createElement('i'),\r\n            symbol = document.createElement('i'),\r\n            title = nodeDiv.querySelector(':scope > .title');\r\n\r\n          bottomEdge.setAttribute('class', 'edge verticalEdge bottomEdge fa');\r\n          nodeDiv.appendChild(bottomEdge);\r\n          symbol.setAttribute('class', 'fa ' + opts.parentNodeSymbol + ' symbol');\r\n          title.insertBefore(symbol, title.children[0]);\r\n        }\r\n      }\r\n\r\n      nodeDiv.addEventListener('mouseenter', that._hoverNode.bind(that));\r\n      nodeDiv.addEventListener('mouseleave', that._hoverNode.bind(that));\r\n      nodeDiv.addEventListener('click', that._dispatchClickEvent.bind(that));\r\n      if (opts.draggable) {\r\n        nodeDiv.addEventListener('dragstart', that._onDragStart);\r\n        nodeDiv.addEventListener('dragover', that._onDragOver);\r\n        nodeDiv.addEventListener('dragend', that._onDragEnd);\r\n        nodeDiv.addEventListener('drop', that._onDrop);\r\n      }\r\n      // allow user to append dom modification after finishing node create of orgchart\r\n      if (opts.createNode) {\r\n        opts.createNode(nodeDiv, nodeData);\r\n      }\r\n\r\n      resolve(nodeDiv);\r\n    });\r\n  }\r\n  buildHierarchy(appendTo, nodeData, level, opts, callback) {\r\n    // Construct the node\r\n    let that = this,\r\n      nodeWrapper,\r\n      childNodes = nodeData.children,\r\n      isVerticalNode = opts.verticalDepth && (level + 1) >= opts.verticalDepth;\r\n\r\n    if (Object.keys(nodeData).length > 1) { // if nodeData has nested structure\r\n      nodeWrapper = isVerticalNode ? appendTo : document.createElement('table');\r\n      if (!isVerticalNode) {\r\n        appendTo.appendChild(nodeWrapper);\r\n      }\r\n      this._createNode(nodeData, level, opts)\r\n      .then(function (nodeDiv) {\r\n        if (isVerticalNode) {\r\n          nodeWrapper.appendChild(nodeDiv);\r\n        }else {\r\n          let tr = document.createElement('tr');\r\n\r\n          tr.innerHTML = `\r\n            <td ${childNodes ? `colspan=\"${childNodes.length * 2}\"` : ''}>\r\n            </td>\r\n          `;\r\n          tr.children[0].appendChild(nodeDiv);\r\n          nodeWrapper.appendChild(tr);\r\n        }\r\n        if (callback) {\r\n          callback();\r\n        }\r\n        // Construct the inferior nodes and connectiong lines\r\n        if (childNodes) {\r\n          if (Object.keys(nodeData).length === 1) { // if nodeData is just an array\r\n            nodeWrapper = appendTo;\r\n          }\r\n          let isHidden = level + 1 >= opts.depth ? ' hidden' : '',\r\n            isVerticalLayer = opts.verticalDepth && (level + 2) >= opts.verticalDepth;\r\n\r\n          // draw the line close to parent node\r\n          if (!isVerticalLayer) {\r\n            let tr = document.createElement('tr');\r\n\r\n            tr.setAttribute('class', 'lines' + isHidden);\r\n            tr.innerHTML = `\r\n              <td colspan=\"${ childNodes.length * 2 }\">\r\n                <div class=\"downLine\"></div>\r\n              </td>\r\n            `;\r\n            nodeWrapper.appendChild(tr);\r\n          }\r\n          // draw the lines close to children nodes\r\n          let lineLayer = document.createElement('tr');\r\n\r\n          lineLayer.setAttribute('class', 'lines' + isHidden);\r\n          lineLayer.innerHTML = `\r\n            <td class=\"rightLine\">&nbsp;</td>\r\n            ${childNodes.slice(1).map(() => `\r\n              <td class=\"leftLine topLine\">&nbsp;</td>\r\n              <td class=\"rightLine topLine\">&nbsp;</td>\r\n              `).join('')}\r\n            <td class=\"leftLine\">&nbsp;</td>\r\n          `;\r\n          let nodeLayer;\r\n\r\n          if (isVerticalLayer) {\r\n            nodeLayer = document.createElement('<ul>');\r\n            if (level + 2 === opts.verticalDepth) {\r\n              let tr = document.createElement('tr');\r\n\r\n              tr.setAttribute('class', 'verticalNodes');\r\n              tr.innerHTML = `<td></td>`;\r\n              tr.firstChild.appendChild(nodeLayer);\r\n            } else {\r\n              nodeWrapper.appendChild(nodeLayer);\r\n            }\r\n          } else {\r\n            nodeLayer = document.createElement('tr');\r\n            nodeLayer.setAttribute('class', 'nodes' + isHidden);\r\n            nodeWrapper.appendChild(lineLayer);\r\n            nodeWrapper.appendChild(nodeLayer);\r\n          }\r\n          // recurse through children nodes\r\n          childNodes.forEach((child) => {\r\n            let nodeCell;\r\n\r\n            if (isVerticalLayer) {\r\n              nodeCell = document.createElement('li');\r\n            } else {\r\n              nodeCell = document.createElement('td');\r\n              nodeCell.setAttribute('colspan', 2);\r\n            }\r\n            nodeLayer.appendChild(nodeCell);\r\n            that.buildHierarchy(nodeCell, child, level + 1, opts, callback);\r\n          });\r\n        }\r\n      })\r\n      .catch(function (err) {\r\n        console.error('Failed to creat node', err);\r\n      });\r\n    }\r\n  }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** D:/Git/OrgChart.js/~/eslint-loader!./src/index.js\n **/"],"sourceRoot":""}