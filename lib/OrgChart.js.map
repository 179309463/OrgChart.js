{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 857696bb31dd515e72fc","webpack:///./src/index.js"],"names":["OrgChart","options","_name","Promise","prototype","finally","callback","P","constructor","then","resolve","value","reason","defaultOptions","opts","Object","assign","data","chart","document","createElement","chartContainer","querySelector","dataset","JSON","stringify","setAttribute","chartClass","direction","addEventListener","event","node","_closest","target","el","classList","contains","removeClass","nodeName","buildHierarchy","_buildJsonDS","children","ajaxURL","_attachRel","spinner","_getJSON","resp","catch","err","console","error","parentNode","removeChild","exportButton","exportBtn","downloadBtn","innerHTML","_clickExportButton","bind","exportFilename","appendChild","fn","expr","Array","from","filter","child","matches","sibs","prevSib","previousElementSibling","push","nextSib","nextElementSibling","offsetParent","elements","classNames","forEach","indexOf","split","className","add","remove","prop","val","style","attr","removeAttribute","type","listener","self","one","call","removeEventListener","url","reject","client","XMLHttpRequest","handler","readyState","status","response","Error","statusText","open","onreadystatechange","responseType","setRequestHeader","send","li","subObj","firstChild","textContent","trim","tagName","length","id","subLi","flags","relationship","item","offsetWidth","relation","criteria","state","exist","_isVisible","visible","_siblings","some","lastChild","map","leftEdge","rightEdge","temp","toggleSiblingsResp","siblingsLoaded","sibsVisible","toggle","flag","topEdge","bottomEdge","_getNodeState","_switchHorizontalArrow","querySelectorAll","currentRoot","nodeData","table","_createNode","nodeDiv","insertBefore","arrow","_prevAll","_removeClass","_addClass","slice","parent","_one","_isInAction","_switchVerticalArrow","_repaint","siblings","_nextAll","upperLevel","sib","nodeContainer","inAjax","preSibs","nextSibs","animatedNodes","apply","lines","Set","line","visibility","someLines","hideSiblings","_css","grandfatherVisible","_removeAttr","hideAncestorsSiblings","_buildParentNode","showParent","stopPropagation","parentState","nodeId","_startLoading","source","keys","addParent","_endLoading","that","descendants","isVerticalDesc","desc","count","_buildChildNode","symbol","parentNodeSymbol","showDescendants","childrenState","hideDescendants","addChildren","depth","hEdge","siblingsState","showSiblings","families","addSiblings","toggleBtn","descWrapper","ul","subToggleBtn","_clickTopEdge","_clickHorizontalEdge","_clickBottomEdge","_clickToggleButton","_clickNode","isFirefox","test","window","navigator","userAgent","toLowerCase","dataTransfer","setData","transform","ghostNode","nodeCover","createElementNS","transValues","scale","Math","abs","parseFloat","offsetHeight","xOffset","offsetX","yOffset","offsetY","ghostNodeWrapper","src","XMLSerializer","serializeToString","setDragImage","dragged","dragZone","dragHier","includes","dropCriteria","preventDefault","dropZone","currentTarget","dropEffect","upperTr","lowerTr","nodeTr","draggedTd","dropColspan","parseInt","colSpan","leftline","rightline","dropSibs","dragColSpan","dragSibs","td","tr","customE","CustomEvent","dispatchEvent","level","parentId","draggable","nodeTitle","nodeContent","verticalDepth","Number","substr","title","_hoverNode","_dispatchClickEvent","_onDragStart","_onDragOver","_onDragEnd","_onDrop","createNode","appendTo","nodeWrapper","childNodes","isVerticalNode","isHidden","isVerticalLayer","lineLayer","join","nodeLayer","nodeCell","mask","sourceChart","html2canvas","clientHeight","clientWidth","cloneDoc","canvasContainer","overflow","canvas","toDataURL","click"],"mappings":"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","file":"OrgChart.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"OrgChart\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"OrgChart\"] = factory();\n\telse\n\t\troot[\"OrgChart\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 857696bb31dd515e72fc\n **/","export default class OrgChart {\n  constructor(options) {\n    this._name = 'OrgChart';\n    Promise.prototype.finally = function (callback) {\n      let P = this.constructor;\n\n      return this.then(\n        value => P.resolve(callback()).then(() => value),\n        reason => P.resolve(callback()).then(() => { throw reason; })\n      );\n    };\n\n    let defaultOptions = {\n        'nodeTitle': 'name',\n        'nodeId': 'id',\n        'toggleSiblingsResp': false,\n        'depth': 999,\n        'chartClass': '',\n        'exportButton': false,\n        'exportFilename': 'OrgChart',\n        'parentNodeSymbol': 'fa-users',\n        'draggable': false,\n        'direction': 't2b',\n        'pan': false,\n        'zoom': false\n      },\n      opts = Object.assign(defaultOptions, options),\n      data = opts.data,\n      chart = document.createElement('div'),\n      chartContainer = document.querySelector(opts.chartContainer);\n\n    this.options = opts;\n    this.chart = chart;\n    this.chartContainer = chartContainer;\n    chart.dataset.options = JSON.stringify(opts);\n    chart.setAttribute('class', 'orgchart' + (opts.chartClass !== '' ? ' ' + opts.chartClass : '') +\n      (opts.direction !== 't2b' ? ' ' + opts.direction : ''));\n    chart.addEventListener('click', function (event) {\n      let node = this._closest(event.target, function (el) {\n        return el.classList.contains('node');\n      });\n\n      if (!node) {\n        chart.querySelector('.node.focused').removeClass('focused');\n      }\n    }, false);\n    if (typeof data === 'object') {\n      if (data.nodeName) { // ul datasource\n        this.buildHierarchy(chart, this._buildJsonDS(data.children[0], 0, opts));\n      } else { // local json datasource\n        this.buildHierarchy(chart, opts.ajaxURL ? data : this._attachRel(data, '00'), 0, opts);\n      }\n    } else {\n      let spinner = document.createElement('i');\n\n      spinner.setAttribute('class', 'fa fa-circle-o-notch fa-spin spinner');\n      this._getJSON(data)\n      .then(function (resp) {\n        this.buildHierarchy(chart, opts.ajaxURL ? resp : this._attachRel(resp, '00'), 0, opts);\n      })\n      .catch(function (err) {\n        console.error('failed to fetch datasource for orgchart', err);\n      })\n      .finally(function () {\n        let spinner = chart.querySelector('.spinner');\n\n        spinner.parentNode.removeChild(spinner);\n      });\n    }\n\n    // append the export button to the chart-container\n    if (opts.exportButton && !chartContainer.querySelector('.oc-export-btn')) {\n      let exportBtn = document.createElement('button'),\n        downloadBtn = document.createElement('a');\n\n      exportBtn.setAttribute('class', 'oc-export-btn' + (opts.chartClass !== '' ? ' ' + opts.chartClass : ''));\n      exportBtn.innerHTML = 'Export';\n      exportBtn.addEventListener('click', this._clickExportButton.bind(this));\n      downloadBtn.setAttribute('class', 'oc-download-btn' + (opts.chartClass !== '' ? ' ' + opts.chartClass : ''));\n      downloadBtn.setAttribute('download', opts.exportFilename + '.png');\n      chartContainer.appendChild(exportBtn);\n      chartContainer.appendChild(downloadBtn);\n    }\n\n    chartContainer.appendChild(chart);\n  }\n  get name() {\n    return this._name;\n  }\n  _closest(el, fn) {\n    return el && ((fn(el) && el !== this.chart) ? el : this._closest(el.parentNode, fn));\n  }\n  _siblings(el, expr) {\n    return Array.from(el.parentNode.children).filter((child) => {\n      if (child !== el) {\n        if (expr) {\n          return el.matches(expr);\n        }\n        return true;\n      }\n      return false;\n    });\n  }\n  _prevAll(el, expr) {\n    let sibs = [],\n      prevSib = el.previousElementSibling;\n\n    while (prevSib) {\n      if (!expr || prevSib.matches(expr)) {\n        sibs.push(prevSib);\n      }\n      prevSib = prevSib.previousElementSibling;\n    }\n    return sibs;\n  }\n  _nextAll(el, expr) {\n    let sibs = [];\n    let nextSib = el.nextElementSibling;\n\n    while (nextSib) {\n      if (!expr || nextSib.matches(expr)) {\n        sibs.push(nextSib);\n      }\n      nextSib = nextSib.nextElementSibling;\n    }\n    return sibs;\n  }\n  _isVisible(el) {\n    return el.offsetParent !== null;\n  }\n  _addClass(elements, classNames) {\n    elements.forEach((el) => {\n      if (classNames.indexOf(' ') > 0) {\n        classNames.split(' ').forEach((className) => el.classList.add(className));\n      } else {\n        el.classList.add(classNames);\n      }\n    });\n  }\n  _removeClass(elements, classNames) {\n    elements.forEach((el) => {\n      if (classNames.indexOf(' ') > 0) {\n        classNames.split(' ').forEach((className) => el.classList.remove(className));\n      } else {\n        el.classList.remove(classNames);\n      }\n    });\n  }\n  _css(elements, prop, val) {\n    elements.forEach((el) => {\n      el.style[prop] = val;\n    });\n  }\n  _removeAttr(elements, attr) {\n    elements.forEach((el) => {\n      el.removeAttribute(attr);\n    });\n  }\n  _one(el, type, listener, self) {\n    let one = function (event) {\n      try {\n        listener.call(self, event);\n      } finally {\n        el.removeEventListener(type, one);\n      }\n    };\n\n    el.addEventListener(type, one);\n  }\n  _getJSON(url) {\n    return new Promise(function (resolve, reject) {\n      let client = new XMLHttpRequest();\n\n      function handler() {\n        if (this.readyState !== 4) {\n          return;\n        }\n        if (this.status === 200) {\n          resolve(this.response);\n        } else {\n          reject(new Error(this.statusText));\n        }\n      }\n      client.open('GET', url);\n      client.onreadystatechange = handler;\n      client.responseType = 'json';\n      client.setRequestHeader('Accept', 'application/json');\n      client.send();\n    });\n  }\n  _buildJsonDS(li) {\n    var subObj = {\n      'name': li.firstChild.textContent.trim(),\n      'relationship': (li.parentNode.parentNode.tagName === 'li' ? '1' : '0') +\n        (li.parentNode.children > 1 ? 1 : 0) + (li.children.length ? 1 : 0)\n    };\n\n    if (li.id) {\n      subObj.id = li.id;\n    }\n    for (let subLi of li.querySelector('ul').children) {\n      if (!subObj.children) { subObj.children = []; }\n      subObj.children.push(this._buildJsonDS(subLi));\n    }\n    return subObj;\n  }\n  _attachRel(data, flags) {\n    data.relationship = flags + (data.children && data.children.length > 0 ? 1 : 0);\n    if (data.children) {\n      for (let item of data.children) {\n        this._attachRel(item, '1' + (data.children.length > 1 ? 1 : 0));\n      }\n    }\n    return data;\n  }\n  _repaint(node) {\n    if (node) {\n      node.style.offsetWidth = node.offsetWidth;\n    }\n  }\n  // whether the cursor is hovering over the node\n  _isInAction(node) {\n    return node.querySelector(':scope > .edge').className.indexOf('fa-') > -1;\n  }\n  // detect the exist/display state of related node\n  _getNodeState(node, relation) {\n    let criteria,\n      state = { 'exist': false, 'visible': false };\n\n    if (relation === 'parent') {\n      criteria = this._closest(node, (el) => el.classList && el.classList.contains('nodes'));\n      if (criteria) {\n        state.exist = true;\n      }\n      if (state.exist && this._isVisible(criteria.previousElementSibling)) {\n        state.visible = true;\n      }\n    } else if (relation === 'children') {\n      criteria = this._closest(node, (el) => el.nodeName === 'TR').nextElementSibling;\n      if (criteria) {\n        state.exist = true;\n      }\n      if (state.exist && this._isVisible(criteria)) {\n        state.visible = true;\n      }\n    } else if (relation === 'siblings') {\n      criteria = this._siblings(this._closest(node, (el) => el.nodeName === 'TABLE').parentNode);\n      if (criteria.length) {\n        state.exist = true;\n      }\n      if (state.exist && criteria.some((el) => this._isVisible(el))) {\n        state.visible = true;\n      }\n    }\n\n    return state;\n  }\n  // find the related nodes\n  getRelatedNodes(node, relation) {\n    if (relation === 'parent') {\n      return this._closest(node, (el) => el.classList.contains('nodes'))\n        .parentNode.children[0].querySelector('.node');\n    } else if (relation === 'children') {\n      return Array.from(this._closest(node, (el) => el.nodeName === 'TABLE').lastChild.children)\n        .map((el) => el.querySelector('.node'));\n    } else if (relation === 'siblings') {\n      return this._siblings(this._closest(node, (el) => el.nodeName === 'TABLE').parentNode)\n        .map((el) => el.querySelector('.node'));\n    }\n  }\n  _switchHorizontalArrow(node) {\n    let opts = this.options,\n      leftEdge = node.querySelector('.leftEdge'),\n      rightEdge = node.querySelector('.rightEdge'),\n      temp = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode;\n\n    if (opts.toggleSiblingsResp && (typeof opts.ajaxURL === 'undefined' ||\n      this._closest(node, (el) => el.classList.contains('.nodes')).dataset.siblingsLoaded)) {\n      let prevSib = temp.previousElementSibling,\n        nextSib = temp.nextElementSibling;\n\n      if (prevSib) {\n        if (prevSib.classList.contains('hidden')) {\n          leftEdge.classList.add('fa-chevron-left');\n          leftEdge.classList.remove('fa-chevron-right');\n        } else {\n          leftEdge.classList.add('fa-chevron-right');\n          leftEdge.classList.remove('fa-chevron-left');\n        }\n      }\n      if (nextSib) {\n        if (nextSib.classList.contains('hidden')) {\n          rightEdge.classList.add('fa-chevron-right');\n          rightEdge.classList.remove('fa-chevron-left');\n        } else {\n          rightEdge.classList.add('fa-chevron-left');\n          rightEdge.classList.remove('fa-chevron-right');\n        }\n      }\n    } else {\n      let sibs = this._siblings(temp),\n        sibsVisible = sibs.length ? !sibs.some((el) => el.classList.contains('hidden')) : false;\n\n      leftEdge.classList.toggle('fa-chevron-right', sibsVisible);\n      leftEdge.classList.toggle('fa-chevron-left', !sibsVisible);\n      rightEdge.classList.toggle('fa-chevron-left', sibsVisible);\n      rightEdge.classList.toggle('fa-chevron-right', !sibsVisible);\n    }\n  }\n  _hoverNode(event) {\n    let node = event.target,\n      flag = false,\n      topEdge = node.querySelector(':scope > .topEdge'),\n      bottomEdge = node.querySelector(':scope > .bottomEdge'),\n      leftEdge = node.querySelector(':scope > .leftEdge');\n\n    if (event.type === 'mouseenter') {\n      if (topEdge) {\n        flag = this._getNodeState(node, 'parent').visible;\n        topEdge.classList.toggle('fa-chevron-up', !flag);\n        topEdge.classList.toggle('fa-chevron-down', flag);\n      }\n      if (bottomEdge) {\n        flag = this._getNodeState(node, 'children').visible;\n        bottomEdge.classList.toggle('fa-chevron-down', !flag);\n        bottomEdge.classList.toggle('fa-chevron-up', flag);\n      }\n      if (leftEdge) {\n        this._switchHorizontalArrow(node);\n      }\n    } else {\n      Array.from(node.querySelectorAll(':scope > .edge')).forEach((el) => {\n        el.classList.remove('fa-chevron-up', 'fa-chevron-down', 'fa-chevron-right', 'fa-chevron-left');\n      });\n    }\n  }\n  // define node click event handler\n  _clickNode(event) {\n    let node = event.target;\n\n    this.chart.querySelector('.focused').classList.remove('focused');\n    node.classList.add('focused');\n  }\n  // build the parent node of specific node\n  _buildParentNode(currentRoot, nodeData, opts, callback) {\n    let table = document.createElement('table');\n\n    nodeData.relationship = '001';\n    this._createNode(nodeData, 0, opts || this.options)\n      .then(function (nodeDiv) {\n        let chart = this.chart;\n\n        nodeDiv.classList.remove('slide-up');\n        nodeDiv.classList.add('slide-down');\n        table.innerHTML = `\n          <tr class=\"hidden\"><td colspan=\"2\"></td></tr>\n          <tr class=\"lines hidden\"><td colspan=\"2\"><div class=\"downLine\"></div></td></tr>\n          <tr class=\"lines hidden\"><td class=\"rightLine\">&nbsp;</td><td class=\"leftLine\">&nbsp;</td></tr>\n          <tr class=\"nodes\"><td colspan=\"2\"></td></tr>\n        `;\n        table.firstChild.firstChild.appendChild(nodeDiv);\n        chart.insertBefore(table, chart.firstChild);\n        table.lastChild.firstChild.appendChild(chart.lastChild);\n        callback();\n      })\n      .catch(function (err) {\n        console.error('Failed to create parent node', err);\n      });\n  }\n  _switchVerticalArrow(arrow) {\n    arrow.classList.toggle('fa-chevron-up');\n    arrow.classList.toggle('fa-chevron-down');\n  }\n  // show the parent node of the specified node\n  showParent(node) {\n    // just show only one superior level\n    let temp = this._prevAll(this._closest(node, (el) => el.classList.contains('nodes')));\n\n    this._removeClass(temp, 'hidden');\n    // just show only one line\n    this._addClass(Array(temp[0].children).slice(1, -1), 'hidden');\n    // show parent node with animation\n    let parent = temp[2].querySelector('.node');\n\n    this._one(parent, 'transitionend', function () {\n      parent.classList.remove('slide');\n      if (this._isInAction(node)) {\n        this._switchVerticalArrow(node.querySelector(':scope > .topEdge'));\n      }\n    }, this);\n    this._repaint(parent);\n    parent.classList.add('slide');\n    parent.classList.remove('slide-down');\n  }\n  // show the sibling nodes of the specified node\n  showSiblings(node, direction) {\n    // firstly, show the sibling td tags\n    let siblings = [],\n      temp = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode;\n\n    if (direction) {\n      siblings = direction === 'left' ? this._prevAll(temp) : this._nextAll(temp);\n    } else {\n      siblings = this._siblings(temp);\n    }\n    this._removeClass(siblings, 'hidden');\n    // secondly, show the lines\n    let upperLevel = this._prevAll(this._closest(node, (el) => el.classList.contains('nodes')));\n\n    temp = Array.from(upperLevel[0].querySelectorAll(':scope > .hidden'));\n    if (direction) {\n      this._removeClass(temp.slice(0, siblings.length * 2), 'hidden');\n    } else {\n      this._removeClass(temp, 'hidden');\n    }\n    // thirdly, do some cleaning stuff\n    if (!this._getNodeState(node, 'parent').visible) {\n      this._removeClass(upperLevel, 'hidden');\n      let parent = upperLevel[2].querySelector('.node');\n\n      this._one(parent, 'transitionend', function (event) {\n        event.target.classList.remove('slide');\n      }, this);\n      this._repaint(parent);\n      parent.classList.add('slide');\n      parent.classList.remove('slide-down');\n    }\n    // lastly, show the sibling nodes with animation\n    siblings.forEach((sib) => {\n      Array.from(sib.querySelectorAll('.node')).forEach((node) => {\n        if (this._isVisible(node)) {\n          node.classList.add('slide');\n          node.classList.remove('slide-left', 'slide-right');\n        }\n      });\n    });\n    this._one(siblings[0].querySelector('.slide'), 'transitionend', function () {\n      siblings.forEach((sib) => {\n        this._removeClass(Array.from(sib.querySelectorAll('.slide')), 'slide');\n      });\n      if (this._isInAction(node)) {\n        this._switchHorizontalArrow(node);\n        node.querySelector('.topEdge').classList.remove('fa-chevron-up');\n        node.querySelector('.topEdge').classList.add('fa-chevron-down');\n      }\n    }, this);\n  }\n  // hide the sibling nodes of the specified node\n  hideSiblings(node, direction) {\n    let nodeContainer = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode,\n      siblings = this._siblings(nodeContainer);\n\n    siblings.forEach((sib) => {\n      if (sib.querySelector('.spinner')) {\n        this.chart.dataset.inAjax = false;\n      }\n    });\n\n    if (!direction || (direction && direction === 'left')) {\n      let preSibs = this._prevAll(nodeContainer);\n\n      preSibs.forEach((sib) => {\n        Array.from(sib.querySelectorAll('.node')).forEach((node) => {\n          if (this._isVisible(node)) {\n            node.classList.add('slide', 'slide-right');\n          }\n        });\n      });\n    }\n    if (!direction || (direction && direction !== 'left')) {\n      let nextSibs = this._nextAll(nodeContainer);\n\n      nextSibs.forEach((sib) => {\n        Array.from(sib.querySelectorAll('.node')).forEach((node) => {\n          if (this._isVisible(node)) {\n            node.classList.add('slide', 'slide-left');\n          }\n        });\n      });\n    }\n\n    let animatedNodes = [];\n\n    this._siblings(nodeContainer).forEach((sib) => {\n      Array.prototype.push.apply(animatedNodes, Array.from(sib.querySelectorAll('.slide')));\n    });\n    let lines = [];\n\n    for (let node of animatedNodes) {\n      let temp = this._closest(node, function (el) {\n        return el.classList.contains('nodes');\n      }).previousElementSibling;\n\n      lines.push(temp);\n      lines.push(temp.previousElementSibling);\n    }\n    lines = [...new Set(lines)];\n    lines.forEach(function (line) {\n      line.style.visibility = 'hidden';\n    });\n\n    this._one(animatedNodes[0], 'transitionend', function (event) {\n      lines.forEach(function (line) {\n        line.removeAttribute('style');\n      });\n      let sibs = [];\n\n      if (direction) {\n        if (direction === 'left') {\n          sibs = this._prevAll(nodeContainer, ':not(.hidden)');\n        } else {\n          sibs = this._nextAll(nodeContainer, ':not(.hidden)');\n        }\n      } else {\n        sibs = this._siblings(nodeContainer);\n      }\n      let temp = Array.from(this._closest(nodeContainer, function (el) {\n        return el.classList.contains('nodes');\n      }).previousElementSibling.querySelectorAll(':scope > :not(.hidden)'));\n\n      let someLines = temp.slice(1, direction ? sibs.length * 2 + 1 : -1);\n\n      this._addClass(someLines, 'hidden');\n      this._removeClass(animatedNodes, 'slide');\n      sibs.forEach((sib) => {\n        Array.from(sib.querySelectorAll('.node')).slice(1).forEach((node) => {\n          if (this._isVisible(node)) {\n            node.classList.remove('slide-left', 'slide-right');\n            node.classList.add('slide-up');\n          }\n        });\n      });\n      sibs.forEach((sib) => {\n        this._addClass(Array.from(sib.querySelectorAll('.lines')), 'hidden');\n        this._addClass(Array.from(sib.querySelectorAll('.nodes')), 'hidden');\n        this._addClass(Array.from(sib.querySelectorAll('.verticalNodes')), 'hidden');\n      });\n      this._addClass(sibs, 'hidden');\n\n      if (this._isInAction(node)) {\n        this._switchHorizontalArrow(node);\n      }\n    }, this);\n  }\n  // recursively hide the ancestor node and sibling nodes of the specified node\n  hideAncestorsSiblings(node) {\n    let temp = Array.from(this._closest(node, function (el) {\n      return el.classList.contains('nodes');\n    }).parentNode.children).slice(0, 3);\n\n    if (temp[0].querySelector('.spinner')) {\n      this.chart.dataset.inAjax = false;\n    }\n    // hide the sibling nodes\n    if (this._getNodeState(node, 'siblings').visible) {\n      this.hideSiblings(node);\n    }\n    // hide the lines\n    let lines = temp.slice(1);\n\n    this._css(lines, 'visibility', 'hidden');\n    // hide the superior nodes with transition\n    let parent = temp[0].querySelector('.node'),\n      grandfatherVisible = this._getNodeState(parent, 'parent').visible;\n\n    if (parent && this._isVisible(parent)) {\n      parent.classList.add('slide', 'slide-down');\n      this._one(parent, 'transitionend', function () {\n        parent.classList.remove('slide');\n        this._removeAttr(lines, 'style');\n        this._addClass(temp, 'hidden');\n      }, this);\n    }\n    // if the current node has the parent node, hide it recursively\n    if (parent && grandfatherVisible) {\n      this.hideAncestorsSiblings(parent);\n    }\n  }\n  // exposed method\n  addParent(currentRoot, data, opts) {\n    this._buildParentNode(currentRoot, data, opts, function () {\n      if (!currentRoot.querySelector(':scope .topEdge').length) {\n        let topEdge = document.createElement('i');\n\n        topEdge.setAttribute('class', 'edge verticalEdge topEdge fa');\n        currentRoot.appendChild(topEdge);\n      }\n      this.showParent(currentRoot);\n    });\n  }\n  // define click event handler for the top edge\n  _clickTopEdge(event) {\n    event.stopPropagation();\n    let topEdge = event.target,\n      node = topEdge.parentNode,\n      parentState = this._getNodeState(node, 'parent'),\n      opts = this.options;\n\n    if (parentState.exist) {\n      let temp = this._closest(node, function (el) {\n        return el.classList.contains('nodes');\n      });\n      let parent = temp.parentNode.firstChild.querySelector('.node');\n\n      if (parent.classList.contains('slide')) { return; }\n      // hide the ancestor nodes and sibling nodes of the specified node\n      if (parentState.visible) {\n        this.hideAncestorsSiblings(node);\n        this._one(parent, 'transitionend', function () {\n          if (this._isInAction(node)) {\n            this._switchVerticalArrow(topEdge);\n            this._switchHorizontalArrow(node);\n          }\n        }, this);\n      } else { // show the ancestors and siblings\n        this.showParent(node);\n      }\n    } else {\n      // load the new parent node of the specified node by ajax request\n      let nodeId = topEdge.parentNode.id;\n\n      // start up loading status\n      if (this._startLoading(topEdge, node, opts)) {\n        // load new nodes\n        this._getJSON(typeof opts.ajaxURL.parent === 'function' ?\n          opts.ajaxURL.parent(node.dataset.source) : opts.ajaxURL.parent + nodeId)\n        .then(function (resp) {\n          if (this.chart.dataset.inAjax) {\n            if (!Object.keys(resp).length) {\n              this.addParent(node, resp, opts);\n            }\n          }\n        })\n        .catch(function (err) {\n          console.error('Failed to get parent node data.', err);\n        })\n        .finally(function () {\n          this._endLoading(topEdge, node, opts);\n        });\n      }\n    }\n  }\n  // recursively hide the descendant nodes of the specified node\n  hideDescendants(node) {\n    let that = this,\n      temp = this._nextAll(node.parentNode.parentNode),\n      lines = [];\n\n    if (temp[2].querySelector('.spinner')) {\n      this.chart.dataset.inAjax = false;\n    }\n    let descendants = Array.from(temp[2].querySelectorAll('.node')).filter((el) => that._isVisible(el)),\n      isVerticalDesc = temp[2].classList.contains('verticalNodes');\n\n    if (!isVerticalDesc) {\n      descendants.forEach((desc) => {\n        Array.prototype.push.apply(lines,\n          that._prevAll(that._closest(desc, (el) => el.classList.contains('nodes')), '.lines'));\n      });\n      lines = [...new Set(lines)];\n      this._css(lines, 'visibility', 'hidden');\n    }\n    this._one(descendants[0], 'transitionend', function (event) {\n      this._removeClass(descendants, 'slide');\n      if (isVerticalDesc) {\n        that._addClass(temp, 'hidden');\n      } else {\n        lines.forEach((el) => {\n          el.removeAttribute('style');\n          el.classList.add('hidden');\n          el.parentNode.lastChild.classList.add('hidden');\n        });\n        this._addClass(Array.from(temp[2].querySelectorAll('.verticalNodes')), 'hidden');\n      }\n      if (this._isInAction(node)) {\n        this._switchVerticalArrow(node.querySelector('.bottomEdge'));\n      }\n    }, this);\n    this._addClass(descendants, 'slide slide-up');\n  }\n  // show the children nodes of the specified node\n  showDescendants(node) {\n    let that = this,\n      temp = this._nextAll(node.parentNode.parentNode),\n      descendants = [];\n\n    this._removeClass(temp, 'hidden');\n    if (temp.some((el) => el.classList.contains('verticalNodes'))) {\n      temp.forEach((el) => {\n        Array.prototype.push.apply(descendants, Array.from(el.querySelectorAll('.node')).filter((el) => {\n          return that._isVisible(el);\n        }));\n      });\n    } else {\n      Array.from(temp[2].children).forEach((el) => {\n        Array.prototype.push.apply(descendants,\n          Array.from(el.querySelector('tr').querySelectorAll('.node')).filter((el) => {\n            return that._isVisible(el);\n          }));\n      });\n    }\n    // the two following statements are used to enforce browser to repaint\n    this._repaint(descendants[0]);\n    this._one(descendants[0], 'transitionend', (event) => {\n      this._removeClass(descendants, 'slide');\n      if (this._isInAction(node)) {\n        this._switchVerticalArrow(node.querySelector('.bottomEdge'));\n      }\n    }, this);\n    this._addClass(descendants, 'slide');\n    this._removeClass(descendants, 'slide-up');\n  }\n  // exposed method\n  addChildren(node, data, opts) {\n    if (!opts) {\n      opts = this.options;\n    }\n    let count = 0;\n\n    this._buildChildNode(this._closest(node, (el) => el.nodeName === 'TABLE'), data, opts, function () {\n      if (++count === data.children.length) {\n        if (!node.querySelector('.bottomEdge')) {\n          let bottomEdge = document.createElement('i');\n\n          bottomEdge.setAttribute('class', 'edge verticalEdge bottomEdge fa');\n          node.appendChild(bottomEdge);\n        }\n        if (!node.querySelector('.symbol')) {\n          let symbol = document.createElement('i');\n\n          symbol.setAttribute('class', 'fa ' + opts.parentNodeSymbol + ' symbol');\n          node.querySelector(':scope > .title').appendChild(symbol);\n        }\n        this.showDescendants(node);\n      }\n    });\n  }\n  // bind click event handler for the bottom edge\n  _clickBottomEdge(event) {\n    event.stopPropagation();\n    let opts = this.options,\n      bottomEdge = event.target,\n      node = bottomEdge.parentNode,\n      childrenState = this._getNodeState(node, 'children');\n\n    if (childrenState.exist) {\n      let temp = this._closest(node, function (el) {\n        return el.nodeName === 'TR';\n      }).parentNode.children[3];\n\n      if (Array.from(temp.querySelectorAll('.node')).some((node) => {\n        return this._isVisible(node) && node.classList.contains('slide');\n      })) { return; }\n      // hide the descendant nodes of the specified node\n      if (childrenState.visible) {\n        this.hideDescendants(node);\n      } else { // show the descendants\n        this.showDescendants(node);\n      }\n    } else { // load the new children nodes of the specified node by ajax request\n      let nodeId = bottomEdge.parentNode.id;\n\n      if (this._startLoading(bottomEdge, node, opts)) {\n        this._getJSON(typeof opts.ajaxURL.children === 'function' ?\n          opts.ajaxURL.children(node.dataset.source) : opts.ajaxURL.children + nodeId)\n        .then(function (resp) {\n          if (this.chart.dataset.inAjax) {\n            if (resp.children.length) {\n              this.addChildren(node, resp, Object.assign({}, opts, { depth: 0 }));\n            }\n          }\n        })\n        .catch(function (err) {\n          console.error('Failed to get children nodes data', err);\n        })\n        .finally(function () {\n          this._endLoading(bottomEdge, node, opts);\n        });\n      }\n    }\n  }\n  // bind click event handler for the left and right edges\n  _clickHorizontalEdge(event) {\n    event.stopPropagation();\n    let opts = this.options,\n      hEdge = event.target,\n      node = hEdge.parentNode,\n      siblingsState = this._getNodeState(node, 'siblings');\n\n    if (siblingsState.exist) {\n      let temp = this._closest(node, function (el) {\n          return el.nodeName === 'TABLE';\n        }).parentNode,\n        siblings = this._siblings(temp);\n\n      if (siblings.some((el) => {\n        let node = el.querySelector('.node');\n\n        return this._isVisible(node) && node.classList.contains('slide');\n      })) { return; }\n      if (opts.toggleSiblingsResp) {\n        let prevSib = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode.previousElementSibling,\n          nextSib = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode.nextElementSibling;\n\n        if (hEdge.classList.contains('.leftEdge')) {\n          if (prevSib.classList.contains('.hidden')) {\n            this.showSiblings(node, 'left');\n          } else {\n            this.hideSiblings(node, 'left');\n          }\n        } else {\n          if (nextSib.classList.contains('.hidden')) {\n            this.showSiblings(node, 'right');\n          } else {\n            this.hideSiblings(node, 'right');\n          }\n        }\n      } else {\n        if (siblingsState.visible) {\n          this.hideSiblings(node);\n        } else {\n          this.showSiblings(node);\n        }\n      }\n    } else {\n      // load the new sibling nodes of the specified node by ajax request\n      let nodeId = hEdge.parentNode.id,\n        url = (this._getNodeState(node, 'parent').exist) ?\n          (typeof opts.ajaxURL.siblings === 'function' ?\n            opts.ajaxURL.siblings(node.dataset.source) : opts.ajaxURL.siblings + nodeId) :\n          (typeof opts.ajaxURL.families === 'function' ?\n            opts.ajaxURL.families(node.dataset.source) : opts.ajaxURL.families + nodeId);\n\n      if (this._startLoading(hEdge, node, opts)) {\n        this._getJSON(url)\n        .then(function (resp) {\n          if (this.chart.dataset.inAjax) {\n            if (resp.siblings || resp.children) {\n              this.addSiblings(node, resp, opts);\n            }\n          }\n        })\n        .catch(function (err) {\n          console.err('Failed to get sibling nodes data', err);\n        })\n        .finally(function () {\n          this._endLoading(hEdge, node, opts);\n        });\n      }\n    }\n  }\n  // event handler for toggle buttons in Hybrid(horizontal + vertical) OrgChart\n  _clickToggleButton(event) {\n    let that = this,\n      toggleBtn = event.target,\n      descWrapper = toggleBtn.parentNode.nextElementSibling,\n      descendants = descWrapper.querySelectorAll('.node'),\n      children = descWrapper.children.map(function (item) {\n        return item.querySelector('.node');\n      });\n\n    if (children.some((item) => item.classList.contains('.slide'))) { return; }\n    toggleBtn.classList.toggle('fa-plus-square');\n    toggleBtn.classList.toggle('fa-minus-square');\n    if (descendants[0].classList.contains('.slide-up')) {\n      descWrapper.classList.remove('hidden');\n      this._repaint(children[0]);\n      this._addClass(children, 'slide');\n      this._removeClass(children, 'slide-up');\n      children[0].addEventListener('transitionend', function () {\n        that._removeClass(children, 'slide');\n      }, { 'once': true });\n    } else {\n      this._addClass(descendants, 'slide slide-up');\n      descendants[0].addEventListener('transitionend', function () {\n        that._removeClass(descendants, 'slide');\n        let ul = this._closest(descendants[0], function (el) {\n          return el.nodeName === 'ul';\n        });\n\n        ul.classList.add('hidden');\n      }, { 'once': true });\n      let subToggleBtn = descendants[0].querySelector('.toggleBtn').classList.remove('fa-minus-square');\n\n      subToggleBtn.classList.add('fa-plus-square');\n    }\n  }\n  _dispatchClickEvent(event) {\n    let classList = event.target.classList;\n\n    if (classList.contains('topEdge')) {\n      this._clickTopEdge(event);\n    } else if (classList.contains('rightEdge') || classList.contains('leftEdge')) {\n      this._clickHorizontalEdge(event);\n    } else if (classList.contains('bottomEdge')) {\n      this._clickBottomEdge(event);\n    } else if (classList.contains('toggleBtn')) {\n      this._clickToggleButton(event);\n    } else {\n      this._clickNode(event);\n    }\n  }\n  _onDragStart(event) {\n    let nodeDiv = event.target,\n      opts = this.options,\n      isFirefox = /firefox/.test(window.navigator.userAgent.toLowerCase());\n\n    if (isFirefox) {\n      event.dataTransfer.setData('text/html', 'hack for firefox');\n    }\n    // if users enable zoom or direction options\n    if (this.chart.style.transform) {\n      let ghostNode, nodeCover;\n\n      if (!document.querySelector('.ghost-node')) {\n        ghostNode = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        ghostNode.classList.add('ghost-node');\n        nodeCover = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n        ghostNode.appendChild(nodeCover);\n        this.chart.appendChild(ghostNode);\n      } else {\n        ghostNode = this.chart.querySelector(':scope > .ghost-node');\n        nodeCover = ghostNode.children[0];\n      }\n      let transValues = this.chart.style.transform.split(','),\n        scale = Math.abs(window.parseFloat((opts.direction === 't2b' || opts.direction === 'b2t') ?\n          transValues[0].slice(transValues[0].indexOf('(') + 1) : transValues[1]));\n\n      ghostNode.setAttribute('width', nodeDiv.offsetWidth);\n      ghostNode.setAttribute('height', nodeDiv.offsetHeight);\n      nodeCover.setAttribute('x', 5 * scale);\n      nodeCover.setAttribute('y', 5 * scale);\n      nodeCover.setAttribute('width', 120 * scale);\n      nodeCover.setAttribute('height', 40 * scale);\n      nodeCover.setAttribute('rx', 4 * scale);\n      nodeCover.setAttribute('ry', 4 * scale);\n      nodeCover.setAttribute('stroke-width', 1 * scale);\n      let xOffset = event.offsetX * scale,\n        yOffset = event.offsetY * scale;\n\n      if (opts.direction === 'l2r') {\n        xOffset = event.offsetY * scale;\n        yOffset = event.offsetX * scale;\n      } else if (opts.direction === 'r2l') {\n        xOffset = nodeDiv.offsetWidth - event.offsetY * scale;\n        yOffset = event.offsetX * scale;\n      } else if (opts.direction === 'b2t') {\n        xOffset = nodeDiv.offsetWidth - event.offsetX * scale;\n        yOffset = nodeDiv.offsetHeight - event.offsetY * scale;\n      }\n      if (isFirefox) { // hack for old version of Firefox(< 48.0)\n        let ghostNodeWrapper = document.createElement('img');\n\n        ghostNodeWrapper.src = 'data:image/svg+xml;utf8,' + (new XMLSerializer()).serializeToString(ghostNode);\n        event.dataTransfer.setDragImage(ghostNodeWrapper, xOffset, yOffset);\n        nodeCover.setAttribute('fill', 'rgb(255, 255, 255)');\n        nodeCover.setAttribute('stroke', 'rgb(191, 0, 0)');\n      } else {\n        event.dataTransfer.setDragImage(ghostNode, xOffset, yOffset);\n      }\n    }\n    let dragged = event.target,\n      dragZone = this._closest(dragged, (el) => {\n        return el.classList && el.classList.contains('nodes');\n      }).parentNode.children[0].querySelector('.node'),\n      dragHier = Array.from(this._closest(dragged, (el) => {\n        return el.nodeName === 'TABLE';\n      }).querySelectorAll('.node'));\n\n    this.dragged = dragged;\n    Array.from(this.chart.querySelectorAll('.node')).forEach(function (node) {\n      if (!dragHier.includes(node)) {\n        if (opts.dropCriteria) {\n          if (opts.dropCriteria(dragged, dragZone, node)) {\n            node.classList.add('allowedDrop');\n          }\n        } else {\n          node.classList.add('allowedDrop');\n        }\n      }\n    });\n  }\n  _onDragOver(event) {\n    event.preventDefault();\n    let dropZone = event.currentTarget;\n\n    if (!dropZone.classList.contains('allowedDrop')) {\n      event.dataTransfer.dropEffect = 'none';\n    }\n  }\n  _onDragEnd(event) {\n    Array.from(this.chart.querySelectorAll('.allowedDrop')).forEach(function (el) {\n      el.classList.remove('allowedDrop');\n    });\n  }\n  _onDrop(event) {\n    let dropZone = event.currentTarget,\n      chart = this.chart,\n      dragged = this.dragged,\n      dragZone = this._closest(dragged, function (el) {\n        return el.classList && el.classList.contains('nodes');\n      }).parentNode.children[0].children[0];\n\n    this._removeClass(Array.from(chart.querySelectorAll('.allowedDrop')), 'allowedDrop');\n    // firstly, deal with the hierarchy of drop zone\n    if (!dropZone.parentNode.parentNode.nextElementSibling) { // if the drop zone is a leaf node\n      let bottomEdge = document.createElement('i');\n\n      bottomEdge.setAttribute('class', 'edge verticalEdge bottomEdge fa');\n      dropZone.appendChild(bottomEdge);\n      dropZone.parentNode.setAttribute('colspan', 2);\n      let table = this._closest(dropZone, function (el) {\n          return el.nodeName === 'TABLE';\n        }),\n        upperTr = document.createElement('tr'),\n        lowerTr = document.createElement('tr'),\n        nodeTr = document.createElement('tr');\n\n      upperTr.setAttribute('class', 'lines');\n      upperTr.innerHTML = `<td colspan=\"2\"><div class=\"downLine\"></div></td>`;\n      table.appendChild(upperTr);\n      lowerTr.setAttribute('class', 'lines');\n      lowerTr.innerHTML = `<td class=\"rightLine\">&nbsp;</td><td class=\"leftLine\">&nbsp;</td>`;\n      table.appendChild(lowerTr);\n      nodeTr.setAttribute('class', 'nodes');\n      table.appendChild(nodeTr);\n      Array.from(dragged.querySelectorAll('.horizontalEdge')).forEach((hEdge) => {\n        dragged.removeChild(hEdge);\n      });\n      let draggedTd = this._closest(dragged, (el) => el.nodeName === 'TABLE').parentNode;\n\n      nodeTr.appendChild(draggedTd);\n    } else {\n      let dropColspan = window.parseInt(dropZone.parentNode.colSpan) + 2;\n\n      dropZone.parentNode.setAttribute('colspan', dropColspan);\n      dropZone.parentNode.parentNode.nextElementSibling.children[0].setAttribute('colspan', dropColspan);\n      if (!dragged.querySelector('.horizontalEdge')) {\n        let rightEdge = document.createElement('i'),\n          leftEdge = document.createElement('i');\n\n        rightEdge.setAttribute('class', 'edge horizontalEdge rightEdge fa');\n        dragged.appendChild(rightEdge);\n        leftEdge.setAttribute('class', 'edge horizontalEdge leftEdge fa');\n        dragged.appendChild(leftEdge);\n      }\n      let temp = dropZone.parentNode.parentNode.nextElementSibling.nextElementSibling,\n        leftline = document.createElement('td'),\n        rightline = document.createElement('td');\n\n      leftline.setAttribute('class', 'leftLine topLine');\n      leftline.innerHTML = `&nbsp;`;\n      temp.insertBefore(leftline, temp.children[1]);\n      rightline.setAttribute('class', 'rightLine topLine');\n      rightline.innerHTML = `&nbsp;`;\n      temp.insertBefore(rightline, temp.children[2]);\n      temp.nextElementSibling.appendChild(this._closest(dragged, function (el) {\n        return el.nodeName === 'TABLE';\n      }).parentNode);\n\n      let dropSibs = this._siblings(this._closest(dragged, function (el) {\n        return el.nodeName === 'TABLE';\n      }).parentNode).map((el) => el.querySelector('.node'));\n\n      if (dropSibs.length === 1) {\n        let rightEdge = document.createElement('i'),\n          leftEdge = document.createElement('i');\n\n        rightEdge.setAttribute('class', 'edge horizontalEdge rightEdge fa');\n        dropSibs[0].appendChild(rightEdge);\n        leftEdge.setAttribute('class', 'edge horizontalEdge leftEdge fa');\n        dropSibs[0].appendChild(leftEdge);\n      }\n    }\n    // secondly, deal with the hierarchy of dragged node\n    let dragColSpan = window.parseInt(dragZone.colSpan);\n\n    if (dragColSpan > 2) {\n      dragZone.setAttribute('colspan', dragColSpan - 2);\n      dragZone.parentNode.nextElementSibling.children[0].setAttribute('colspan', dragColSpan - 2);\n      let temp = dragZone.parentNode.nextElementSibling.nextElementSibling;\n\n      temp.children[1].remove();\n      temp.children[1].remove();\n\n      let dragSibs = Array.from(dragZone.parentNode.parentNode.children[3].children).map(function (td) {\n        return td.querySelector('.node');\n      });\n\n      if (dragSibs.length === 1) {\n        dragSibs[0].querySelector('.leftEdge').remove();\n        dragSibs[0].querySelector('.rightEdge').remove();\n      }\n    } else {\n      dragZone.removeAttribute('colspan');\n      dragZone.querySelector('.node').removeChild(dragZone.querySelector('.bottomEdge'));\n      Array.from(dragZone.parentNode.parentNode.children).slice(1).forEach((tr) => tr.remove());\n    }\n    let customE = new CustomEvent('nodedropped.orgchart', { 'detail': {\n      'draggedNode': dragged,\n      'dragZone': dragZone.children[0],\n      'dropZone': dropZone\n    }});\n\n    chart.dispatchEvent(customE);\n  }\n  // create node\n  _createNode(nodeData, level, opts) {\n    let that = this;\n\n    return new Promise(function (resolve, reject) {\n      if (nodeData.children) {\n        for (let child of nodeData.children) {\n          child.parentId = nodeData.id;\n        }\n      }\n\n      // construct the content of node\n      let nodeDiv = document.createElement('div');\n\n      delete nodeData.children;\n      nodeDiv.dataset.source = JSON.stringify(nodeData);\n      if (nodeData[opts.nodeId]) {\n        nodeDiv.id = nodeData[opts.nodeId];\n      }\n      nodeDiv.setAttribute('class', 'node ' + (nodeData.className || '') + (level >= opts.depth ? ' slide-up' : ''));\n      if (opts.draggable) {\n        nodeDiv.setAttribute('draggable', true);\n      }\n      if (nodeData.parentId) {\n        nodeDiv.setAttribute('data-parent', nodeData.parentId);\n      }\n      nodeDiv.innerHTML = `\n        <div class=\"title\">${nodeData[opts.nodeTitle]}</div>\n        ${opts.nodeContent ? `<div class=\"content\">${nodeData[opts.nodeContent]}</div>` : ''}\n      `;\n      // append 4 direction arrows or expand/collapse buttons\n      let flags = nodeData.relationship || '';\n\n      if (opts.verticalDepth && (level + 2) > opts.verticalDepth) {\n        if ((level + 1) >= opts.verticalDepth && Number(flags.substr(2, 1))) {\n          let toggleBtn = document.createElement('i');\n\n          toggleBtn.setAttribute('class', 'toggleBtn fa fa-minus-square');\n          nodeDiv.appendChild(toggleBtn);\n        }\n      } else {\n        if (Number(flags.substr(0, 1))) {\n          let topEdge = document.createElement('i');\n\n          topEdge.setAttribute('class', 'edge verticalEdge topEdge fa');\n          nodeDiv.appendChild(topEdge);\n        }\n        if (Number(flags.substr(1, 1))) {\n          let rightEdge = document.createElement('i'),\n            leftEdge = document.createElement('i');\n\n          rightEdge.setAttribute('class', 'edge horizontalEdge rightEdge fa');\n          nodeDiv.appendChild(rightEdge);\n          leftEdge.setAttribute('class', 'edge horizontalEdge leftEdge fa');\n          nodeDiv.appendChild(leftEdge);\n        }\n        if (Number(flags.substr(2, 1))) {\n          let bottomEdge = document.createElement('i'),\n            symbol = document.createElement('i'),\n            title = nodeDiv.querySelector(':scope > .title');\n\n          bottomEdge.setAttribute('class', 'edge verticalEdge bottomEdge fa');\n          nodeDiv.appendChild(bottomEdge);\n          symbol.setAttribute('class', 'fa ' + opts.parentNodeSymbol + ' symbol');\n          title.insertBefore(symbol, title.children[0]);\n        }\n      }\n\n      nodeDiv.addEventListener('mouseenter', that._hoverNode.bind(that));\n      nodeDiv.addEventListener('mouseleave', that._hoverNode.bind(that));\n      nodeDiv.addEventListener('click', that._dispatchClickEvent.bind(that));\n      if (opts.draggable) {\n        nodeDiv.addEventListener('dragstart', that._onDragStart.bind(that));\n        nodeDiv.addEventListener('dragover', that._onDragOver.bind(that));\n        nodeDiv.addEventListener('dragend', that._onDragEnd.bind(that));\n        nodeDiv.addEventListener('drop', that._onDrop.bind(that));\n      }\n      // allow user to append dom modification after finishing node create of orgchart\n      if (opts.createNode) {\n        opts.createNode(nodeDiv, nodeData);\n      }\n\n      resolve(nodeDiv);\n    });\n  }\n  buildHierarchy(appendTo, nodeData, level, opts, callback) {\n    // Construct the node\n    let that = this,\n      nodeWrapper,\n      childNodes = nodeData.children,\n      isVerticalNode = opts.verticalDepth && (level + 1) >= opts.verticalDepth;\n\n    if (Object.keys(nodeData).length > 1) { // if nodeData has nested structure\n      nodeWrapper = isVerticalNode ? appendTo : document.createElement('table');\n      if (!isVerticalNode) {\n        appendTo.appendChild(nodeWrapper);\n      }\n      this._createNode(nodeData, level, opts)\n      .then(function (nodeDiv) {\n        if (isVerticalNode) {\n          nodeWrapper.appendChild(nodeDiv);\n        }else {\n          let tr = document.createElement('tr');\n\n          tr.innerHTML = `\n            <td ${childNodes ? `colspan=\"${childNodes.length * 2}\"` : ''}>\n            </td>\n          `;\n          tr.children[0].appendChild(nodeDiv);\n          nodeWrapper.appendChild(tr);\n        }\n        if (callback) {\n          callback();\n        }\n        // Construct the inferior nodes and connectiong lines\n        if (childNodes) {\n          if (Object.keys(nodeData).length === 1) { // if nodeData is just an array\n            nodeWrapper = appendTo;\n          }\n          let isHidden = level + 1 >= opts.depth ? ' hidden' : '',\n            isVerticalLayer = opts.verticalDepth && (level + 2) >= opts.verticalDepth;\n\n          // draw the line close to parent node\n          if (!isVerticalLayer) {\n            let tr = document.createElement('tr');\n\n            tr.setAttribute('class', 'lines' + isHidden);\n            tr.innerHTML = `\n              <td colspan=\"${ childNodes.length * 2 }\">\n                <div class=\"downLine\"></div>\n              </td>\n            `;\n            nodeWrapper.appendChild(tr);\n          }\n          // draw the lines close to children nodes\n          let lineLayer = document.createElement('tr');\n\n          lineLayer.setAttribute('class', 'lines' + isHidden);\n          lineLayer.innerHTML = `\n            <td class=\"rightLine\">&nbsp;</td>\n            ${childNodes.slice(1).map(() => `\n              <td class=\"leftLine topLine\">&nbsp;</td>\n              <td class=\"rightLine topLine\">&nbsp;</td>\n              `).join('')}\n            <td class=\"leftLine\">&nbsp;</td>\n          `;\n          let nodeLayer;\n\n          if (isVerticalLayer) {\n            nodeLayer = document.createElement('<ul>');\n            if (level + 2 === opts.verticalDepth) {\n              let tr = document.createElement('tr');\n\n              tr.setAttribute('class', 'verticalNodes');\n              tr.innerHTML = `<td></td>`;\n              tr.firstChild.appendChild(nodeLayer);\n            } else {\n              nodeWrapper.appendChild(nodeLayer);\n            }\n          } else {\n            nodeLayer = document.createElement('tr');\n            nodeLayer.setAttribute('class', 'nodes' + isHidden);\n            nodeWrapper.appendChild(lineLayer);\n            nodeWrapper.appendChild(nodeLayer);\n          }\n          // recurse through children nodes\n          childNodes.forEach((child) => {\n            let nodeCell;\n\n            if (isVerticalLayer) {\n              nodeCell = document.createElement('li');\n            } else {\n              nodeCell = document.createElement('td');\n              nodeCell.setAttribute('colspan', 2);\n            }\n            nodeLayer.appendChild(nodeCell);\n            that.buildHierarchy(nodeCell, child, level + 1, opts, callback);\n          });\n        }\n      })\n      .catch(function (err) {\n        console.error('Failed to creat node', err);\n      });\n    }\n  }\n  _clickExportButton() {\n    let opts = this.options,\n      chartContainer = this.chartContainer,\n      mask = chartContainer.querySelector(':scope > .mask'),\n      sourceChart = chartContainer.querySelector('.orgchart:not(.hidden)'),\n      flag = opts.direction === 'l2r' || opts.direction === 'r2l';\n\n    if (!mask) {\n      mask = document.createElement('div');\n      mask.setAttribute('class', 'mask');\n      mask.innerHTML = `<i class=\"fa fa-circle-o-notch fa-spin spinner\"></i>`;\n      chartContainer.appendChild(mask);\n    } else {\n      mask.classList.remove('hidden');\n    }\n    chartContainer.classList.add('canvasContainer');\n    window.html2canvas(sourceChart, {\n      'width': flag ? sourceChart.clientHeight : sourceChart.clientWidth,\n      'height': flag ? sourceChart.clientWidth : sourceChart.clientHeight,\n      'onclone': function (cloneDoc) {\n        let canvasContainer = cloneDoc.querySelector('.canvasContainer');\n\n        canvasContainer.style.overflow = 'visible';\n        canvasContainer.querySelector('.orgchart:not(.hidden)').transform = '';\n      }\n    })\n    .then((canvas) => {\n      let downloadBtn = chartContainer.querySelector('.oc-download-btn');\n\n      chartContainer.querySelector('.mask').classList.add('hidden');\n      downloadBtn.setAttribute('href', canvas.toDataURL());\n      downloadBtn.click();\n    })\n    .catch((err) => {\n      console.error('Failed to export the curent orgchart!', err);\n    })\n    .finally(() => {\n      chartContainer.classList.remove('canvasContainer');\n    });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/index.js\n **/"],"sourceRoot":""}