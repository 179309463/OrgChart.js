{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 262b7985fef38eb63bd2","webpack:///./src/index.js"],"names":["OrgChart","options","_name","Promise","prototype","finally","callback","P","constructor","then","resolve","value","reason","that","defaultOptions","opts","Object","assign","data","chart","document","createElement","chartContainer","querySelector","dataset","JSON","stringify","setAttribute","chartClass","direction","buildHierarchy","ajaxURL","_attachRel","startsWith","_buildJsonDS","children","spinner","appendChild","_getJSON","resp","catch","err","console","error","parentNode","removeChild","addEventListener","_clickChart","bind","exportButton","exportBtn","downloadBtn","innerHTML","_clickExportButton","exportFilename","pan","style","overflow","_onPanStart","body","_onPanEnd","zoom","_onWheeling","_onTouchStart","_onTouchMove","_onTouchEnd","el","fn","_closest","expr","Array","from","filter","child","matches","sibs","prevSib","previousElementSibling","push","nextSib","nextElementSibling","offsetParent","elements","classNames","forEach","indexOf","split","className","classList","add","remove","prop","val","attr","removeAttribute","type","listener","self","one","event","call","removeEventListener","ancestors","selector","results","querySelectorAll","url","reject","xhr","XMLHttpRequest","handler","readyState","status","parse","response","Error","statusText","open","onreadystatechange","responseType","setRequestHeader","send","li","subObj","firstChild","textContent","trim","nodeName","length","id","flags","relationship","item","node","offsetWidth","relation","criteria","state","contains","exist","_isVisible","visible","_siblings","some","lastChild","map","leftEdge","rightEdge","temp","toggleSiblingsResp","siblingsLoaded","sibsVisible","toggle","target","flag","topEdge","bottomEdge","_getNodeState","_switchHorizontalArrow","clickedNode","currentTarget","focusedNode","currentRoot","nodeData","table","_createNode","nodeDiv","parentTr","superiorLine","inferiorLine","childrenTr","insertBefore","arrow","_prevAll","_removeClass","_addClass","slice","parent","_one","_isInAction","_switchVerticalArrow","_repaint","siblings","_nextAll","upperLevel","sib","nodeContainer","inAjax","preSibs","nextSibs","animatedNodes","apply","lines","Set","line","visibility","someLines","hideSiblings","_css","grandfatherVisible","_removeAttr","hideAncestorsSiblings","_buildParentNode","showParent","disabled","stopPropagation","parentState","nodeId","_startLoading","source","keys","addParent","_endLoading","descendants","isVerticalDesc","desc","appendTo","count","inEdit","_buildChildNode","symbol","parentNodeSymbol","showDescendants","childrenState","hideDescendants","addChildren","oneSibling","siblingCount","existingSibligCount","i","rightLine","leftLine","nodeChart","newSiblingCount","insertPostion","Math","floor","childCount","siblingTds","_complementLine","_getDescElements","nodeCount","td","temp2","temp3","_buildSiblingNode","showSiblings","hEdge","siblingsState","families","addSiblings","toggleBtn","descWrapper","ul","subToggleBtn","_clickTopEdge","_clickHorizontalEdge","_clickBottomEdge","_clickToggleButton","_clickNode","isFirefox","test","window","navigator","userAgent","toLowerCase","dataTransfer","setData","transform","ghostNode","nodeCover","createElementNS","transValues","scale","abs","parseFloat","offsetHeight","xOffset","offsetX","yOffset","offsetY","ghostNodeWrapper","src","XMLSerializer","serializeToString","setDragImage","dragged","dragZone","dragHier","includes","dropCriteria","preventDefault","dropZone","dropEffect","upperTr","lowerTr","nodeTr","draggedTd","dropColspan","parseInt","colSpan","leftline","rightline","dropSibs","dragColSpan","dragSibs","tr","customE","CustomEvent","dispatchEvent","level","parentId","isHidden","depth","draggable","nodeTitle","nodeContent","verticalDepth","Number","substr","title","_hoverNode","_dispatchClickEvent","_onDragStart","_onDragOver","_onDragEnd","_onDrop","createNode","nodeWrapper","childNodes","isVerticalNode","isVerticalLayer","lineLayer","join","nodeLayer","nodeCell","closestNode","mask","sourceChart","html2canvas","clientHeight","clientWidth","cloneDoc","canvasContainer","canvas","toDataURL","click","_loopChart","touches","panning","cursor","lastX","lastY","lastTf","getComputedStyle","startX","startY","targetTouches","pageX","pageY","panStart","_onPanning","newX","newY","matrix","newScale","deltaY","_setChartScale","sqrt","clientX","clientY","dist","_getPinchDist","pinching","pinchDistStart","pinchDistEnd","diff"],"mappings":"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","file":"OrgChart.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"OrgChart\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"OrgChart\"] = factory();\n\telse\n\t\troot[\"OrgChart\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 262b7985fef38eb63bd2\n **/","export default class OrgChart {\r\n  constructor(options) {\r\n    this._name = 'OrgChart';\r\n    Promise.prototype.finally = function (callback) {\r\n      let P = this.constructor;\r\n\r\n      return this.then(\r\n        value => P.resolve(callback()).then(() => value),\r\n        reason => P.resolve(callback()).then(() => { throw reason; })\r\n      );\r\n    };\r\n\r\n    let that = this,\r\n      defaultOptions = {\r\n        'nodeTitle': 'name',\r\n        'nodeId': 'id',\r\n        'toggleSiblingsResp': false,\r\n        'depth': 999,\r\n        'chartClass': '',\r\n        'exportButton': false,\r\n        'exportFilename': 'OrgChart',\r\n        'parentNodeSymbol': 'fa-users',\r\n        'draggable': false,\r\n        'direction': 't2b',\r\n        'pan': false,\r\n        'zoom': false\r\n      },\r\n      opts = Object.assign(defaultOptions, options),\r\n      data = opts.data,\r\n      chart = document.createElement('div'),\r\n      chartContainer = document.querySelector(opts.chartContainer);\r\n\r\n    this.options = opts;\r\n    delete this.options.data;\r\n    this.chart = chart;\r\n    this.chartContainer = chartContainer;\r\n    chart.dataset.options = JSON.stringify(opts);\r\n    chart.setAttribute('class', 'orgchart' + (opts.chartClass !== '' ? ' ' + opts.chartClass : '') +\r\n      (opts.direction !== 't2b' ? ' ' + opts.direction : ''));\r\n    if (typeof data === 'object') { // local json datasource\r\n      this.buildHierarchy(chart, opts.ajaxURL ? data : this._attachRel(data, '00'), 0);\r\n    } else if (typeof data === 'string' && data.startsWith('#')) { // ul datasource\r\n      this.buildHierarchy(chart, this._buildJsonDS(document.querySelector(data).children[0]), 0);\r\n    } else { // ajax datasource\r\n      let spinner = document.createElement('i');\r\n\r\n      spinner.setAttribute('class', 'fa fa-circle-o-notch fa-spin spinner');\r\n      chart.appendChild(spinner);\r\n      this._getJSON(data)\r\n      .then(function (resp) {\r\n        that.buildHierarchy(chart, opts.ajaxURL ? resp : that._attachRel(resp, '00'), 0);\r\n      })\r\n      .catch(function (err) {\r\n        console.error('failed to fetch datasource for orgchart', err);\r\n      })\r\n      .finally(function () {\r\n        let spinner = chart.querySelector('.spinner');\r\n\r\n        spinner.parentNode.removeChild(spinner);\r\n      });\r\n    }\r\n    chart.addEventListener('click', this._clickChart.bind(this));\r\n    // append the export button to the chart-container\r\n    if (opts.exportButton && !chartContainer.querySelector('.oc-export-btn')) {\r\n      let exportBtn = document.createElement('button'),\r\n        downloadBtn = document.createElement('a');\r\n\r\n      exportBtn.setAttribute('class', 'oc-export-btn' + (opts.chartClass !== '' ? ' ' + opts.chartClass : ''));\r\n      exportBtn.innerHTML = 'Export';\r\n      exportBtn.addEventListener('click', this._clickExportButton.bind(this));\r\n      downloadBtn.setAttribute('class', 'oc-download-btn' + (opts.chartClass !== '' ? ' ' + opts.chartClass : ''));\r\n      downloadBtn.setAttribute('download', opts.exportFilename + '.png');\r\n      chartContainer.appendChild(exportBtn);\r\n      chartContainer.appendChild(downloadBtn);\r\n    }\r\n\r\n    if (opts.pan) {\r\n      chartContainer.style.overflow = 'hidden';\r\n      chart.addEventListener('mousedown', this._onPanStart.bind(this));\r\n      chart.addEventListener('touchstart', this._onPanStart.bind(this));\r\n      document.body.addEventListener('mouseup', this._onPanEnd.bind(this));\r\n      document.body.addEventListener('touchend', this._onPanEnd.bind(this));\r\n    }\r\n\r\n    if (opts.zoom) {\r\n      chartContainer.addEventListener('wheel', this._onWheeling.bind(this));\r\n      chartContainer.addEventListener('touchstart', this._onTouchStart.bind(this));\r\n      document.body.addEventListener('touchmove', this._onTouchMove.bind(this));\r\n      document.body.addEventListener('touchend', this._onTouchEnd.bind(this));\r\n    }\r\n\r\n    chartContainer.appendChild(chart);\r\n  }\r\n  get name() {\r\n    return this._name;\r\n  }\r\n  _closest(el, fn) {\r\n    return el && ((fn(el) && el !== this.chart) ? el : this._closest(el.parentNode, fn));\r\n  }\r\n  _siblings(el, expr) {\r\n    return Array.from(el.parentNode.children).filter((child) => {\r\n      if (child !== el) {\r\n        if (expr) {\r\n          return el.matches(expr);\r\n        }\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n  }\r\n  _prevAll(el, expr) {\r\n    let sibs = [],\r\n      prevSib = el.previousElementSibling;\r\n\r\n    while (prevSib) {\r\n      if (!expr || prevSib.matches(expr)) {\r\n        sibs.push(prevSib);\r\n      }\r\n      prevSib = prevSib.previousElementSibling;\r\n    }\r\n    return sibs;\r\n  }\r\n  _nextAll(el, expr) {\r\n    let sibs = [];\r\n    let nextSib = el.nextElementSibling;\r\n\r\n    while (nextSib) {\r\n      if (!expr || nextSib.matches(expr)) {\r\n        sibs.push(nextSib);\r\n      }\r\n      nextSib = nextSib.nextElementSibling;\r\n    }\r\n    return sibs;\r\n  }\r\n  _isVisible(el) {\r\n    return el.offsetParent !== null;\r\n  }\r\n  _addClass(elements, classNames) {\r\n    elements.forEach((el) => {\r\n      if (classNames.indexOf(' ') > 0) {\r\n        classNames.split(' ').forEach((className) => el.classList.add(className));\r\n      } else {\r\n        el.classList.add(classNames);\r\n      }\r\n    });\r\n  }\r\n  _removeClass(elements, classNames) {\r\n    elements.forEach((el) => {\r\n      if (classNames.indexOf(' ') > 0) {\r\n        classNames.split(' ').forEach((className) => el.classList.remove(className));\r\n      } else {\r\n        el.classList.remove(classNames);\r\n      }\r\n    });\r\n  }\r\n  _css(elements, prop, val) {\r\n    elements.forEach((el) => {\r\n      el.style[prop] = val;\r\n    });\r\n  }\r\n  _removeAttr(elements, attr) {\r\n    elements.forEach((el) => {\r\n      el.removeAttribute(attr);\r\n    });\r\n  }\r\n  _one(el, type, listener, self) {\r\n    let one = function (event) {\r\n      try {\r\n        listener.call(self, event);\r\n      } finally {\r\n        el.removeEventListener(type, one);\r\n      }\r\n    };\r\n\r\n    el.addEventListener(type, one);\r\n  }\r\n  _getDescElements(ancestors, selector) {\r\n    let results = [];\r\n\r\n    ancestors.forEach((el) => results.push(...el.querySelectorAll(selector)));\r\n    return results;\r\n  }\r\n  _getJSON(url) {\r\n    return new Promise(function (resolve, reject) {\r\n      let xhr = new XMLHttpRequest();\r\n\r\n      function handler() {\r\n        if (this.readyState !== 4) {\r\n          return;\r\n        }\r\n        if (this.status === 200) {\r\n          resolve(JSON.parse(this.response));\r\n        } else {\r\n          reject(new Error(this.statusText));\r\n        }\r\n      }\r\n      xhr.open('GET', url);\r\n      xhr.onreadystatechange = handler;\r\n      xhr.responseType = 'json';\r\n      // xhr.setRequestHeader('Accept', 'application/json');\r\n      xhr.setRequestHeader('Content-Type', 'application/json');\r\n      xhr.send();\r\n    });\r\n  }\r\n  _buildJsonDS(li) {\r\n    let subObj = {\r\n      'name': li.firstChild.textContent.trim(),\r\n      'relationship': (li.parentNode.parentNode.nodeName === 'LI' ? '1' : '0') +\r\n        (li.parentNode.children.length > 1 ? 1 : 0) + (li.children.length ? 1 : 0)\r\n    };\r\n\r\n    if (li.id) {\r\n      subObj.id = li.id;\r\n    }\r\n    if (li.querySelector('ul')) {\r\n      Array.from(li.querySelector('ul').children).forEach((el) => {\r\n        if (!subObj.children) { subObj.children = []; }\r\n        subObj.children.push(this._buildJsonDS(el));\r\n      });\r\n    }\r\n    return subObj;\r\n  }\r\n  _attachRel(data, flags) {\r\n    data.relationship = flags + (data.children && data.children.length > 0 ? 1 : 0);\r\n    if (data.children) {\r\n      for (let item of data.children) {\r\n        this._attachRel(item, '1' + (data.children.length > 1 ? 1 : 0));\r\n      }\r\n    }\r\n    return data;\r\n  }\r\n  _repaint(node) {\r\n    if (node) {\r\n      node.style.offsetWidth = node.offsetWidth;\r\n    }\r\n  }\r\n  // whether the cursor is hovering over the node\r\n  _isInAction(node) {\r\n    return node.querySelector(':scope > .edge').className.indexOf('fa-') > -1;\r\n  }\r\n  // detect the exist/display state of related node\r\n  _getNodeState(node, relation) {\r\n    let criteria,\r\n      state = { 'exist': false, 'visible': false };\r\n\r\n    if (relation === 'parent') {\r\n      criteria = this._closest(node, (el) => el.classList && el.classList.contains('nodes'));\r\n      if (criteria) {\r\n        state.exist = true;\r\n      }\r\n      if (state.exist && this._isVisible(criteria.parentNode.children[0])) {\r\n        state.visible = true;\r\n      }\r\n    } else if (relation === 'children') {\r\n      criteria = this._closest(node, (el) => el.nodeName === 'TR').nextElementSibling;\r\n      if (criteria) {\r\n        state.exist = true;\r\n      }\r\n      if (state.exist && this._isVisible(criteria)) {\r\n        state.visible = true;\r\n      }\r\n    } else if (relation === 'siblings') {\r\n      criteria = this._siblings(this._closest(node, (el) => el.nodeName === 'TABLE').parentNode);\r\n      if (criteria.length) {\r\n        state.exist = true;\r\n      }\r\n      if (state.exist && criteria.some((el) => this._isVisible(el))) {\r\n        state.visible = true;\r\n      }\r\n    }\r\n\r\n    return state;\r\n  }\r\n  // find the related nodes\r\n  getRelatedNodes(node, relation) {\r\n    if (relation === 'parent') {\r\n      return this._closest(node, (el) => el.classList.contains('nodes'))\r\n        .parentNode.children[0].querySelector('.node');\r\n    } else if (relation === 'children') {\r\n      return Array.from(this._closest(node, (el) => el.nodeName === 'TABLE').lastChild.children)\r\n        .map((el) => el.querySelector('.node'));\r\n    } else if (relation === 'siblings') {\r\n      return this._siblings(this._closest(node, (el) => el.nodeName === 'TABLE').parentNode)\r\n        .map((el) => el.querySelector('.node'));\r\n    }\r\n  }\r\n  _switchHorizontalArrow(node) {\r\n    let opts = this.options,\r\n      leftEdge = node.querySelector('.leftEdge'),\r\n      rightEdge = node.querySelector('.rightEdge'),\r\n      temp = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode;\r\n\r\n    if (opts.toggleSiblingsResp && (typeof opts.ajaxURL === 'undefined' ||\r\n      this._closest(node, (el) => el.classList.contains('.nodes')).dataset.siblingsLoaded)) {\r\n      let prevSib = temp.previousElementSibling,\r\n        nextSib = temp.nextElementSibling;\r\n\r\n      if (prevSib) {\r\n        if (prevSib.classList.contains('hidden')) {\r\n          leftEdge.classList.add('fa-chevron-left');\r\n          leftEdge.classList.remove('fa-chevron-right');\r\n        } else {\r\n          leftEdge.classList.add('fa-chevron-right');\r\n          leftEdge.classList.remove('fa-chevron-left');\r\n        }\r\n      }\r\n      if (nextSib) {\r\n        if (nextSib.classList.contains('hidden')) {\r\n          rightEdge.classList.add('fa-chevron-right');\r\n          rightEdge.classList.remove('fa-chevron-left');\r\n        } else {\r\n          rightEdge.classList.add('fa-chevron-left');\r\n          rightEdge.classList.remove('fa-chevron-right');\r\n        }\r\n      }\r\n    } else {\r\n      let sibs = this._siblings(temp),\r\n        sibsVisible = sibs.length ? !sibs.some((el) => el.classList.contains('hidden')) : false;\r\n\r\n      leftEdge.classList.toggle('fa-chevron-right', sibsVisible);\r\n      leftEdge.classList.toggle('fa-chevron-left', !sibsVisible);\r\n      rightEdge.classList.toggle('fa-chevron-left', sibsVisible);\r\n      rightEdge.classList.toggle('fa-chevron-right', !sibsVisible);\r\n    }\r\n  }\r\n  _hoverNode(event) {\r\n    let node = event.target,\r\n      flag = false,\r\n      topEdge = node.querySelector(':scope > .topEdge'),\r\n      bottomEdge = node.querySelector(':scope > .bottomEdge'),\r\n      leftEdge = node.querySelector(':scope > .leftEdge');\r\n\r\n    if (event.type === 'mouseenter') {\r\n      if (topEdge) {\r\n        flag = this._getNodeState(node, 'parent').visible;\r\n        topEdge.classList.toggle('fa-chevron-up', !flag);\r\n        topEdge.classList.toggle('fa-chevron-down', flag);\r\n      }\r\n      if (bottomEdge) {\r\n        flag = this._getNodeState(node, 'children').visible;\r\n        bottomEdge.classList.toggle('fa-chevron-down', !flag);\r\n        bottomEdge.classList.toggle('fa-chevron-up', flag);\r\n      }\r\n      if (leftEdge) {\r\n        this._switchHorizontalArrow(node);\r\n      }\r\n    } else {\r\n      Array.from(node.querySelectorAll(':scope > .edge')).forEach((el) => {\r\n        el.classList.remove('fa-chevron-up', 'fa-chevron-down', 'fa-chevron-right', 'fa-chevron-left');\r\n      });\r\n    }\r\n  }\r\n  // define node click event handler\r\n  _clickNode(event) {\r\n    let clickedNode = event.currentTarget,\r\n      focusedNode = this.chart.querySelector('.focused');\r\n\r\n    if (focusedNode) {\r\n      focusedNode.classList.remove('focused');\r\n    }\r\n    clickedNode.classList.add('focused');\r\n  }\r\n  // build the parent node of specific node\r\n  _buildParentNode(currentRoot, nodeData, callback) {\r\n    let that = this,\r\n      table = document.createElement('table');\r\n\r\n    nodeData.relationship = '001';\r\n    this._createNode(nodeData, 0)\r\n      .then(function (nodeDiv) {\r\n        let chart = that.chart;\r\n\r\n        nodeDiv.classList.remove('slide-up');\r\n        nodeDiv.classList.add('slide-down');\r\n        let parentTr = document.createElement('tr'),\r\n          superiorLine = document.createElement('tr'),\r\n          inferiorLine = document.createElement('tr'),\r\n          childrenTr = document.createElement('tr');\r\n\r\n        parentTr.setAttribute('class', 'hidden');\r\n        parentTr.innerHTML = `<td colspan=\"2\"></td>`;\r\n        table.appendChild(parentTr);\r\n        superiorLine.setAttribute('class', 'lines hidden');\r\n        superiorLine.innerHTML = `<td colspan=\"2\"><div class=\"downLine\"></div></td>`;\r\n        table.appendChild(superiorLine);\r\n        inferiorLine.setAttribute('class', 'lines hidden');\r\n        inferiorLine.innerHTML = `<td class=\"rightLine\">&nbsp;</td><td class=\"leftLine\">&nbsp;</td>`;\r\n        table.appendChild(inferiorLine);\r\n        childrenTr.setAttribute('class', 'nodes');\r\n        childrenTr.innerHTML = `<td colspan=\"2\"></td>`;\r\n        table.appendChild(childrenTr);\r\n        table.querySelector('td').appendChild(nodeDiv);\r\n        chart.insertBefore(table, chart.children[0]);\r\n        table.children[3].children[0].appendChild(chart.lastChild);\r\n        callback();\r\n      })\r\n      .catch(function (err) {\r\n        console.error('Failed to create parent node', err);\r\n      });\r\n  }\r\n  _switchVerticalArrow(arrow) {\r\n    arrow.classList.toggle('fa-chevron-up');\r\n    arrow.classList.toggle('fa-chevron-down');\r\n  }\r\n  // show the parent node of the specified node\r\n  showParent(node) {\r\n    // just show only one superior level\r\n    let temp = this._prevAll(this._closest(node, (el) => el.classList.contains('nodes')));\r\n\r\n    this._removeClass(temp, 'hidden');\r\n    // just show only one line\r\n    this._addClass(Array(temp[0].children).slice(1, -1), 'hidden');\r\n    // show parent node with animation\r\n    let parent = temp[2].querySelector('.node');\r\n\r\n    this._one(parent, 'transitionend', function () {\r\n      parent.classList.remove('slide');\r\n      if (this._isInAction(node)) {\r\n        this._switchVerticalArrow(node.querySelector(':scope > .topEdge'));\r\n      }\r\n    }, this);\r\n    this._repaint(parent);\r\n    parent.classList.add('slide');\r\n    parent.classList.remove('slide-down');\r\n  }\r\n  // show the sibling nodes of the specified node\r\n  showSiblings(node, direction) {\r\n    // firstly, show the sibling td tags\r\n    let siblings = [],\r\n      temp = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode;\r\n\r\n    if (direction) {\r\n      siblings = direction === 'left' ? this._prevAll(temp) : this._nextAll(temp);\r\n    } else {\r\n      siblings = this._siblings(temp);\r\n    }\r\n    this._removeClass(siblings, 'hidden');\r\n    // secondly, show the lines\r\n    let upperLevel = this._prevAll(this._closest(node, (el) => el.classList.contains('nodes')));\r\n\r\n    temp = Array.from(upperLevel[0].querySelectorAll(':scope > .hidden'));\r\n    if (direction) {\r\n      this._removeClass(temp.slice(0, siblings.length * 2), 'hidden');\r\n    } else {\r\n      this._removeClass(temp, 'hidden');\r\n    }\r\n    // thirdly, do some cleaning stuff\r\n    if (!this._getNodeState(node, 'parent').visible) {\r\n      this._removeClass(upperLevel, 'hidden');\r\n      let parent = upperLevel[2].querySelector('.node');\r\n\r\n      this._one(parent, 'transitionend', function (event) {\r\n        event.target.classList.remove('slide');\r\n      }, this);\r\n      this._repaint(parent);\r\n      parent.classList.add('slide');\r\n      parent.classList.remove('slide-down');\r\n    }\r\n    // lastly, show the sibling nodes with animation\r\n    siblings.forEach((sib) => {\r\n      Array.from(sib.querySelectorAll('.node')).forEach((node) => {\r\n        if (this._isVisible(node)) {\r\n          node.classList.add('slide');\r\n          node.classList.remove('slide-left', 'slide-right');\r\n        }\r\n      });\r\n    });\r\n    this._one(siblings[0].querySelector('.slide'), 'transitionend', function () {\r\n      siblings.forEach((sib) => {\r\n        this._removeClass(Array.from(sib.querySelectorAll('.slide')), 'slide');\r\n      });\r\n      if (this._isInAction(node)) {\r\n        this._switchHorizontalArrow(node);\r\n        node.querySelector('.topEdge').classList.remove('fa-chevron-up');\r\n        node.querySelector('.topEdge').classList.add('fa-chevron-down');\r\n      }\r\n    }, this);\r\n  }\r\n  // hide the sibling nodes of the specified node\r\n  hideSiblings(node, direction) {\r\n    let nodeContainer = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode,\r\n      siblings = this._siblings(nodeContainer);\r\n\r\n    siblings.forEach((sib) => {\r\n      if (sib.querySelector('.spinner')) {\r\n        this.chart.dataset.inAjax = false;\r\n      }\r\n    });\r\n\r\n    if (!direction || (direction && direction === 'left')) {\r\n      let preSibs = this._prevAll(nodeContainer);\r\n\r\n      preSibs.forEach((sib) => {\r\n        Array.from(sib.querySelectorAll('.node')).forEach((node) => {\r\n          if (this._isVisible(node)) {\r\n            node.classList.add('slide', 'slide-right');\r\n          }\r\n        });\r\n      });\r\n    }\r\n    if (!direction || (direction && direction !== 'left')) {\r\n      let nextSibs = this._nextAll(nodeContainer);\r\n\r\n      nextSibs.forEach((sib) => {\r\n        Array.from(sib.querySelectorAll('.node')).forEach((node) => {\r\n          if (this._isVisible(node)) {\r\n            node.classList.add('slide', 'slide-left');\r\n          }\r\n        });\r\n      });\r\n    }\r\n\r\n    let animatedNodes = [];\r\n\r\n    this._siblings(nodeContainer).forEach((sib) => {\r\n      Array.prototype.push.apply(animatedNodes, Array.from(sib.querySelectorAll('.slide')));\r\n    });\r\n    let lines = [];\r\n\r\n    for (let node of animatedNodes) {\r\n      let temp = this._closest(node, function (el) {\r\n        return el.classList.contains('nodes');\r\n      }).previousElementSibling;\r\n\r\n      lines.push(temp);\r\n      lines.push(temp.previousElementSibling);\r\n    }\r\n    lines = [...new Set(lines)];\r\n    lines.forEach(function (line) {\r\n      line.style.visibility = 'hidden';\r\n    });\r\n\r\n    this._one(animatedNodes[0], 'transitionend', function (event) {\r\n      lines.forEach(function (line) {\r\n        line.removeAttribute('style');\r\n      });\r\n      let sibs = [];\r\n\r\n      if (direction) {\r\n        if (direction === 'left') {\r\n          sibs = this._prevAll(nodeContainer, ':not(.hidden)');\r\n        } else {\r\n          sibs = this._nextAll(nodeContainer, ':not(.hidden)');\r\n        }\r\n      } else {\r\n        sibs = this._siblings(nodeContainer);\r\n      }\r\n      let temp = Array.from(this._closest(nodeContainer, function (el) {\r\n        return el.classList.contains('nodes');\r\n      }).previousElementSibling.querySelectorAll(':scope > :not(.hidden)'));\r\n\r\n      let someLines = temp.slice(1, direction ? sibs.length * 2 + 1 : -1);\r\n\r\n      this._addClass(someLines, 'hidden');\r\n      this._removeClass(animatedNodes, 'slide');\r\n      sibs.forEach((sib) => {\r\n        Array.from(sib.querySelectorAll('.node')).slice(1).forEach((node) => {\r\n          if (this._isVisible(node)) {\r\n            node.classList.remove('slide-left', 'slide-right');\r\n            node.classList.add('slide-up');\r\n          }\r\n        });\r\n      });\r\n      sibs.forEach((sib) => {\r\n        this._addClass(Array.from(sib.querySelectorAll('.lines')), 'hidden');\r\n        this._addClass(Array.from(sib.querySelectorAll('.nodes')), 'hidden');\r\n        this._addClass(Array.from(sib.querySelectorAll('.verticalNodes')), 'hidden');\r\n      });\r\n      this._addClass(sibs, 'hidden');\r\n\r\n      if (this._isInAction(node)) {\r\n        this._switchHorizontalArrow(node);\r\n      }\r\n    }, this);\r\n  }\r\n  // recursively hide the ancestor node and sibling nodes of the specified node\r\n  hideAncestorsSiblings(node) {\r\n    let temp = Array.from(this._closest(node, function (el) {\r\n      return el.classList.contains('nodes');\r\n    }).parentNode.children).slice(0, 3);\r\n\r\n    if (temp[0].querySelector('.spinner')) {\r\n      this.chart.dataset.inAjax = false;\r\n    }\r\n    // hide the sibling nodes\r\n    if (this._getNodeState(node, 'siblings').visible) {\r\n      this.hideSiblings(node);\r\n    }\r\n    // hide the lines\r\n    let lines = temp.slice(1);\r\n\r\n    this._css(lines, 'visibility', 'hidden');\r\n    // hide the superior nodes with transition\r\n    let parent = temp[0].querySelector('.node'),\r\n      grandfatherVisible = this._getNodeState(parent, 'parent').visible;\r\n\r\n    if (parent && this._isVisible(parent)) {\r\n      parent.classList.add('slide', 'slide-down');\r\n      this._one(parent, 'transitionend', function () {\r\n        parent.classList.remove('slide');\r\n        this._removeAttr(lines, 'style');\r\n        this._addClass(temp, 'hidden');\r\n      }, this);\r\n    }\r\n    // if the current node has the parent node, hide it recursively\r\n    if (parent && grandfatherVisible) {\r\n      this.hideAncestorsSiblings(parent);\r\n    }\r\n  }\r\n  // exposed method\r\n  addParent(currentRoot, data) {\r\n    let that = this;\r\n\r\n    this._buildParentNode(currentRoot, data, function () {\r\n      if (!currentRoot.querySelector(':scope > .topEdge')) {\r\n        let topEdge = document.createElement('i');\r\n\r\n        topEdge.setAttribute('class', 'edge verticalEdge topEdge fa');\r\n        currentRoot.appendChild(topEdge);\r\n      }\r\n      that.showParent(currentRoot);\r\n    });\r\n  }\r\n  // start up loading status for requesting new nodes\r\n  _startLoading(arrow, node) {\r\n    let opts = this.options,\r\n      chart = this.chart;\r\n\r\n    if (typeof chart.dataset.inAjax !== 'undefined' && chart.dataset.inAjax === 'true') {\r\n      return false;\r\n    }\r\n\r\n    arrow.classList.add('hidden');\r\n    let spinner = document.createElement('i');\r\n\r\n    spinner.setAttribute('class', 'fa fa-circle-o-notch fa-spin spinner');\r\n    node.appendChild(spinner);\r\n    this._addClass(Array.from(node.querySelectorAll(':scope > *:not(.spinner)')), 'hazy');\r\n    chart.dataset.inAjax = true;\r\n\r\n    let exportBtn = this.chartContainer.querySelector('.oc-export-btn' +\r\n      (opts.chartClass !== '' ? '.' + opts.chartClass : ''));\r\n\r\n    if (exportBtn) {\r\n      exportBtn.disabled = true;\r\n    }\r\n    return true;\r\n  }\r\n  // terminate loading status for requesting new nodes\r\n  _endLoading(arrow, node) {\r\n    let opts = this.options;\r\n\r\n    arrow.classList.remove('hidden');\r\n    node.querySelector(':scope > .spinner').remove();\r\n    this._removeClass(Array.from(node.querySelectorAll(':scope > .hazy')), 'hazy');\r\n    this.chart.dataset.inAjax = false;\r\n    let exportBtn = this.chartContainer.querySelector('.oc-export-btn' +\r\n      (opts.chartClass !== '' ? '.' + opts.chartClass : ''));\r\n\r\n    if (exportBtn) {\r\n      exportBtn.disabled = false;\r\n    }\r\n  }\r\n  // define click event handler for the top edge\r\n  _clickTopEdge(event) {\r\n    event.stopPropagation();\r\n    let that = this,\r\n      topEdge = event.target,\r\n      node = topEdge.parentNode,\r\n      parentState = this._getNodeState(node, 'parent'),\r\n      opts = this.options;\r\n\r\n    if (parentState.exist) {\r\n      let temp = this._closest(node, function (el) {\r\n        return el.classList.contains('nodes');\r\n      });\r\n      let parent = temp.parentNode.firstChild.querySelector('.node');\r\n\r\n      if (parent.classList.contains('slide')) { return; }\r\n      // hide the ancestor nodes and sibling nodes of the specified node\r\n      if (parentState.visible) {\r\n        this.hideAncestorsSiblings(node);\r\n        this._one(parent, 'transitionend', function () {\r\n          if (this._isInAction(node)) {\r\n            this._switchVerticalArrow(topEdge);\r\n            this._switchHorizontalArrow(node);\r\n          }\r\n        }, this);\r\n      } else { // show the ancestors and siblings\r\n        this.showParent(node);\r\n      }\r\n    } else {\r\n      // load the new parent node of the specified node by ajax request\r\n      let nodeId = topEdge.parentNode.id;\r\n\r\n      // start up loading status\r\n      if (this._startLoading(topEdge, node)) {\r\n        // load new nodes\r\n        this._getJSON(typeof opts.ajaxURL.parent === 'function' ?\r\n          opts.ajaxURL.parent(node.dataset.source) : opts.ajaxURL.parent + nodeId)\r\n        .then(function (resp) {\r\n          if (that.chart.dataset.inAjax === 'true') {\r\n            if (Object.keys(resp).length) {\r\n              that.addParent(node, resp);\r\n            }\r\n          }\r\n        })\r\n        .catch(function (err) {\r\n          console.error('Failed to get parent node data.', err);\r\n        })\r\n        .finally(function () {\r\n          that._endLoading(topEdge, node);\r\n        });\r\n      }\r\n    }\r\n  }\r\n  // recursively hide the descendant nodes of the specified node\r\n  hideDescendants(node) {\r\n    let that = this,\r\n      temp = this._nextAll(node.parentNode.parentNode),\r\n      lines = [];\r\n\r\n    if (temp[2].querySelector('.spinner')) {\r\n      this.chart.dataset.inAjax = false;\r\n    }\r\n    let descendants = Array.from(temp[2].querySelectorAll('.node')).filter((el) => that._isVisible(el)),\r\n      isVerticalDesc = temp[2].classList.contains('verticalNodes');\r\n\r\n    if (!isVerticalDesc) {\r\n      descendants.forEach((desc) => {\r\n        Array.prototype.push.apply(lines,\r\n          that._prevAll(that._closest(desc, (el) => el.classList.contains('nodes')), '.lines'));\r\n      });\r\n      lines = [...new Set(lines)];\r\n      this._css(lines, 'visibility', 'hidden');\r\n    }\r\n    this._one(descendants[0], 'transitionend', function (event) {\r\n      this._removeClass(descendants, 'slide');\r\n      if (isVerticalDesc) {\r\n        that._addClass(temp, 'hidden');\r\n      } else {\r\n        lines.forEach((el) => {\r\n          el.removeAttribute('style');\r\n          el.classList.add('hidden');\r\n          el.parentNode.lastChild.classList.add('hidden');\r\n        });\r\n        this._addClass(Array.from(temp[2].querySelectorAll('.verticalNodes')), 'hidden');\r\n      }\r\n      if (this._isInAction(node)) {\r\n        this._switchVerticalArrow(node.querySelector('.bottomEdge'));\r\n      }\r\n    }, this);\r\n    this._addClass(descendants, 'slide slide-up');\r\n  }\r\n  // show the children nodes of the specified node\r\n  showDescendants(node) {\r\n    let that = this,\r\n      temp = this._nextAll(node.parentNode.parentNode),\r\n      descendants = [];\r\n\r\n    this._removeClass(temp, 'hidden');\r\n    if (temp.some((el) => el.classList.contains('verticalNodes'))) {\r\n      temp.forEach((el) => {\r\n        Array.prototype.push.apply(descendants, Array.from(el.querySelectorAll('.node')).filter((el) => {\r\n          return that._isVisible(el);\r\n        }));\r\n      });\r\n    } else {\r\n      Array.from(temp[2].children).forEach((el) => {\r\n        Array.prototype.push.apply(descendants,\r\n          Array.from(el.querySelector('tr').querySelectorAll('.node')).filter((el) => {\r\n            return that._isVisible(el);\r\n          }));\r\n      });\r\n    }\r\n    // the two following statements are used to enforce browser to repaint\r\n    this._repaint(descendants[0]);\r\n    this._one(descendants[0], 'transitionend', (event) => {\r\n      this._removeClass(descendants, 'slide');\r\n      if (this._isInAction(node)) {\r\n        this._switchVerticalArrow(node.querySelector('.bottomEdge'));\r\n      }\r\n    }, this);\r\n    this._addClass(descendants, 'slide');\r\n    this._removeClass(descendants, 'slide-up');\r\n  }\r\n  // build the child nodes of specific node\r\n  _buildChildNode(appendTo, nodeData, callback) {\r\n    let data = nodeData.children || nodeData.siblings;\r\n\r\n    appendTo.querySelector('td').setAttribute('colSpan', data.length * 2);\r\n    this.buildHierarchy(appendTo, { 'children': data }, 0, callback);\r\n  }\r\n  // exposed method\r\n  addChildren(node, data) {\r\n    let that = this,\r\n      opts = this.options,\r\n      count = 0;\r\n\r\n    this.chart.dataset.inEdit = 'addChildren';\r\n    this._buildChildNode.call(this, this._closest(node, (el) => el.nodeName === 'TABLE'), data, function () {\r\n      if (++count === data.children.length) {\r\n        if (!node.querySelector('.bottomEdge')) {\r\n          let bottomEdge = document.createElement('i');\r\n\r\n          bottomEdge.setAttribute('class', 'edge verticalEdge bottomEdge fa');\r\n          node.appendChild(bottomEdge);\r\n        }\r\n        if (!node.querySelector('.symbol')) {\r\n          let symbol = document.createElement('i');\r\n\r\n          symbol.setAttribute('class', 'fa ' + opts.parentNodeSymbol + ' symbol');\r\n          node.querySelector(':scope > .title').appendChild(symbol);\r\n        }\r\n        that.showDescendants(node);\r\n        that.chart.dataset.inEdit = '';\r\n      }\r\n    });\r\n  }\r\n  // bind click event handler for the bottom edge\r\n  _clickBottomEdge(event) {\r\n    event.stopPropagation();\r\n    let that = this,\r\n      opts = this.options,\r\n      bottomEdge = event.target,\r\n      node = bottomEdge.parentNode,\r\n      childrenState = this._getNodeState(node, 'children');\r\n\r\n    if (childrenState.exist) {\r\n      let temp = this._closest(node, function (el) {\r\n        return el.nodeName === 'TR';\r\n      }).parentNode.children[3];\r\n\r\n      if (Array.from(temp.querySelectorAll('.node')).some((node) => {\r\n        return this._isVisible(node) && node.classList.contains('slide');\r\n      })) { return; }\r\n      // hide the descendant nodes of the specified node\r\n      if (childrenState.visible) {\r\n        this.hideDescendants(node);\r\n      } else { // show the descendants\r\n        this.showDescendants(node);\r\n      }\r\n    } else { // load the new children nodes of the specified node by ajax request\r\n      let nodeId = bottomEdge.parentNode.id;\r\n\r\n      if (this._startLoading(bottomEdge, node)) {\r\n        this._getJSON(typeof opts.ajaxURL.children === 'function' ?\r\n          opts.ajaxURL.children(node.dataset.source) : opts.ajaxURL.children + nodeId)\r\n        .then(function (resp) {\r\n          if (that.chart.dataset.inAjax === 'true') {\r\n            if (resp.children.length) {\r\n              that.addChildren(node, resp);\r\n            }\r\n          }\r\n        })\r\n        .catch(function (err) {\r\n          console.error('Failed to get children nodes data', err);\r\n        })\r\n        .finally(function () {\r\n          that._endLoading(bottomEdge, node);\r\n        });\r\n      }\r\n    }\r\n  }\r\n  // subsequent processing of build sibling nodes\r\n  _complementLine(oneSibling, siblingCount, existingSibligCount) {\r\n    let temp = oneSibling.parentNode.parentNode.children;\r\n\r\n    temp[0].children[0].setAttribute('colspan', siblingCount * 2);\r\n    temp[1].children[0].setAttribute('colspan', siblingCount * 2);\r\n    for (let i = 0; i < existingSibligCount; i++) {\r\n      let rightLine = document.createElement('td'),\r\n        leftLine = document.createElement('td');\r\n\r\n      rightLine.setAttribute('class', 'rightLine topLine');\r\n      rightLine.innerHTML = '&nbsp;';\r\n      temp[2].insertBefore(rightLine, temp[2].children[1]);\r\n      leftLine.setAttribute('class', 'leftLine topLine');\r\n      leftLine.innerHTML = '&nbsp;';\r\n      temp[2].insertBefore(leftLine, temp[2].children[1]);\r\n    }\r\n  }\r\n  // build the sibling nodes of specific node\r\n  _buildSiblingNode(nodeChart, nodeData, callback) {\r\n    let that = this,\r\n      newSiblingCount = nodeData.siblings ? nodeData.siblings.length : nodeData.children.length,\r\n      existingSibligCount = nodeChart.parentNode.nodeName === 'TD' ? this._closest(nodeChart, (el) => {\r\n        return el.nodeName === 'TR';\r\n      }).children.length : 1,\r\n      siblingCount = existingSibligCount + newSiblingCount,\r\n      insertPostion = (siblingCount > 1) ? Math.floor(siblingCount / 2 - 1) : 0;\r\n\r\n    // just build the sibling nodes for the specific node\r\n    if (nodeChart.parentNode.nodeName === 'TD') {\r\n      let temp = this._prevAll(nodeChart.parentNode.parentNode);\r\n\r\n      temp[0].remove();\r\n      temp[1].remove();\r\n      let childCount = 0;\r\n\r\n      that._buildChildNode.call(that, that._closest(nodeChart.parentNode, (el) => el.nodeName === 'TABLE'),\r\n        nodeData, () => {\r\n        if (++childCount === newSiblingCount) {\r\n          let siblingTds = Array.from(that._closest(nodeChart.parentNode, (el) => el.nodeName === 'TABLE')\r\n            .lastChild.children);\r\n\r\n          if (existingSibligCount > 1) {\r\n            Array.from(nodeChart.parentNode.children).forEach((el) => {\r\n              siblingTds[0].parentNode.insertBefore(el, siblingTds[0]);\r\n            });\r\n            nodeChart.parentNode.parentNode.remove();\r\n            that._complementLine(siblingTds[0], siblingCount, existingSibligCount);\r\n            that._addClass(siblingTds, 'hidden');\r\n            siblingTds.forEach((el) => {\r\n              that._addClass(el.querySelectorAll('.node'), 'slide-left');\r\n            });\r\n          } else {\r\n            let temp = nodeChart.parentNode.parentNode;\r\n\r\n            siblingTds[insertPostion].parentNode.insertBefore(nodeChart.parentNode, siblingTds[insertPostion + 1]);\r\n            temp.remove();\r\n            that._complementLine(siblingTds[insertPostion], siblingCount, 1);\r\n            that._addClass(siblingTds, 'hidden');\r\n            that._addClass(that._getDescElements(siblingTds.slice(0, insertPostion + 1), '.node'), 'slide-right');\r\n            that._addClass(that._getDescElements(siblingTds.slice(insertPostion + 1), '.node'), 'slide-left');\r\n          }\r\n          callback();\r\n        }\r\n      });\r\n    } else { // build the sibling nodes and parent node for the specific ndoe\r\n      let nodeCount = 0;\r\n\r\n      that.buildHierarchy.call(that, that.chart, nodeData, 0, () => {\r\n        if (++nodeCount === siblingCount) {\r\n          let temp = nodeChart.nextElementSibling.children[3]\r\n            .children[insertPostion],\r\n            td = document.createElement('td');\r\n\r\n          td.setAttribute('colspan', 2);\r\n          td.appendChild(nodeChart);\r\n          temp.parentNode.insertBefore(td, temp.nextElementSibling);\r\n          that._complementLine(temp, siblingCount, 1);\r\n\r\n          let temp2 = that._closest(nodeChart, (el) => el.classList && el.classList.contains('nodes'))\r\n            .parentNode.children[0];\r\n\r\n          temp2.classList.add('hidden');\r\n          that._addClass(Array.from(temp2.querySelectorAll('.node')), 'slide-down');\r\n\r\n          let temp3 = this._siblings(nodeChart.parentNode);\r\n\r\n          that._addClass(temp3, 'hidden');\r\n          temp3.slice(0, insertPostion).forEach((el) => {\r\n            that._addClass(Array.from(el.querySelectorAll('.node')), 'slide-right');\r\n          });\r\n          temp3.slice(insertPostion).forEach((el) => {\r\n            that._addClass(Array.from(el.querySelectorAll('.node')), 'slide-left');\r\n          });\r\n          callback();\r\n        }\r\n      });\r\n    }\r\n  }\r\n  addSiblings(node, data) {\r\n    let that = this;\r\n\r\n    this.chart.dataset.inEdit = 'addSiblings';\r\n    this._buildSiblingNode.call(this, this._closest(node, (el) => el.nodeName === 'TABLE'), data, () => {\r\n      that._closest(node, (el) => el.classList && el.classList.contains('nodes'))\r\n        .dataset.siblingsLoaded = true;\r\n      if (!node.querySelector('.leftEdge')) {\r\n        let rightEdge = document.createElement('i'),\r\n          leftEdge = document.createElement('i');\r\n\r\n        rightEdge.setAttribute('class', 'edge horizontalEdge rightEdge fa');\r\n        node.appendChild(rightEdge);\r\n        leftEdge.setAttribute('class', 'edge horizontalEdge leftEdge fa');\r\n        node.appendChild(leftEdge);\r\n      }\r\n      that.showSiblings(node);\r\n      that.chart.dataset.inEdit = '';\r\n    });\r\n  }\r\n  // bind click event handler for the left and right edges\r\n  _clickHorizontalEdge(event) {\r\n    event.stopPropagation();\r\n    let that = this,\r\n      opts = this.options,\r\n      hEdge = event.target,\r\n      node = hEdge.parentNode,\r\n      siblingsState = this._getNodeState(node, 'siblings');\r\n\r\n    if (siblingsState.exist) {\r\n      let temp = this._closest(node, function (el) {\r\n          return el.nodeName === 'TABLE';\r\n        }).parentNode,\r\n        siblings = this._siblings(temp);\r\n\r\n      if (siblings.some((el) => {\r\n        let node = el.querySelector('.node');\r\n\r\n        return this._isVisible(node) && node.classList.contains('slide');\r\n      })) { return; }\r\n      if (opts.toggleSiblingsResp) {\r\n        let prevSib = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode.previousElementSibling,\r\n          nextSib = this._closest(node, (el) => el.nodeName === 'TABLE').parentNode.nextElementSibling;\r\n\r\n        if (hEdge.classList.contains('leftEdge')) {\r\n          if (prevSib.classList.contains('hidden')) {\r\n            this.showSiblings(node, 'left');\r\n          } else {\r\n            this.hideSiblings(node, 'left');\r\n          }\r\n        } else {\r\n          if (nextSib.classList.contains('hidden')) {\r\n            this.showSiblings(node, 'right');\r\n          } else {\r\n            this.hideSiblings(node, 'right');\r\n          }\r\n        }\r\n      } else {\r\n        if (siblingsState.visible) {\r\n          this.hideSiblings(node);\r\n        } else {\r\n          this.showSiblings(node);\r\n        }\r\n      }\r\n    } else {\r\n      // load the new sibling nodes of the specified node by ajax request\r\n      let nodeId = hEdge.parentNode.id,\r\n        url = (this._getNodeState(node, 'parent').exist) ?\r\n          (typeof opts.ajaxURL.siblings === 'function' ?\r\n            opts.ajaxURL.siblings(JSON.parse(node.dataset.source)) : opts.ajaxURL.siblings + nodeId) :\r\n          (typeof opts.ajaxURL.families === 'function' ?\r\n            opts.ajaxURL.families(JSON.parse(node.dataset.source)) : opts.ajaxURL.families + nodeId);\r\n\r\n      if (this._startLoading(hEdge, node)) {\r\n        this._getJSON(url)\r\n        .then(function (resp) {\r\n          if (that.chart.dataset.inAjax === 'true') {\r\n            if (resp.siblings || resp.children) {\r\n              that.addSiblings(node, resp);\r\n            }\r\n          }\r\n        })\r\n        .catch(function (err) {\r\n          console.error('Failed to get sibling nodes data', err);\r\n        })\r\n        .finally(function () {\r\n          that._endLoading(hEdge, node);\r\n        });\r\n      }\r\n    }\r\n  }\r\n  // event handler for toggle buttons in Hybrid(horizontal + vertical) OrgChart\r\n  _clickToggleButton(event) {\r\n    let that = this,\r\n      toggleBtn = event.target,\r\n      descWrapper = toggleBtn.parentNode.nextElementSibling,\r\n      descendants = descWrapper.querySelectorAll('.node'),\r\n      children = descWrapper.children.map(function (item) {\r\n        return item.querySelector('.node');\r\n      });\r\n\r\n    if (children.some((item) => item.classList.contains('.slide'))) { return; }\r\n    toggleBtn.classList.toggle('fa-plus-square');\r\n    toggleBtn.classList.toggle('fa-minus-square');\r\n    if (descendants[0].classList.contains('.slide-up')) {\r\n      descWrapper.classList.remove('hidden');\r\n      this._repaint(children[0]);\r\n      this._addClass(children, 'slide');\r\n      this._removeClass(children, 'slide-up');\r\n      children[0].addEventListener('transitionend', function () {\r\n        that._removeClass(children, 'slide');\r\n      }, { 'once': true });\r\n    } else {\r\n      this._addClass(descendants, 'slide slide-up');\r\n      descendants[0].addEventListener('transitionend', function () {\r\n        that._removeClass(descendants, 'slide');\r\n        let ul = this._closest(descendants[0], function (el) {\r\n          return el.nodeName === 'ul';\r\n        });\r\n\r\n        ul.classList.add('hidden');\r\n      }, { 'once': true });\r\n      let subToggleBtn = descendants[0].querySelector('.toggleBtn').classList.remove('fa-minus-square');\r\n\r\n      subToggleBtn.classList.add('fa-plus-square');\r\n    }\r\n  }\r\n  _dispatchClickEvent(event) {\r\n    let classList = event.target.classList;\r\n\r\n    if (classList.contains('topEdge')) {\r\n      this._clickTopEdge(event);\r\n    } else if (classList.contains('rightEdge') || classList.contains('leftEdge')) {\r\n      this._clickHorizontalEdge(event);\r\n    } else if (classList.contains('bottomEdge')) {\r\n      this._clickBottomEdge(event);\r\n    } else if (classList.contains('toggleBtn')) {\r\n      this._clickToggleButton(event);\r\n    } else {\r\n      this._clickNode(event);\r\n    }\r\n  }\r\n  _onDragStart(event) {\r\n    let nodeDiv = event.target,\r\n      opts = this.options,\r\n      isFirefox = /firefox/.test(window.navigator.userAgent.toLowerCase());\r\n\r\n    if (isFirefox) {\r\n      event.dataTransfer.setData('text/html', 'hack for firefox');\r\n    }\r\n    // if users enable zoom or direction options\r\n    if (this.chart.style.transform) {\r\n      let ghostNode, nodeCover;\r\n\r\n      if (!document.querySelector('.ghost-node')) {\r\n        ghostNode = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n        ghostNode.classList.add('ghost-node');\r\n        nodeCover = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\r\n        ghostNode.appendChild(nodeCover);\r\n        this.chart.appendChild(ghostNode);\r\n      } else {\r\n        ghostNode = this.chart.querySelector(':scope > .ghost-node');\r\n        nodeCover = ghostNode.children[0];\r\n      }\r\n      let transValues = this.chart.style.transform.split(','),\r\n        scale = Math.abs(window.parseFloat((opts.direction === 't2b' || opts.direction === 'b2t') ?\r\n          transValues[0].slice(transValues[0].indexOf('(') + 1) : transValues[1]));\r\n\r\n      ghostNode.setAttribute('width', nodeDiv.offsetWidth);\r\n      ghostNode.setAttribute('height', nodeDiv.offsetHeight);\r\n      nodeCover.setAttribute('x', 5 * scale);\r\n      nodeCover.setAttribute('y', 5 * scale);\r\n      nodeCover.setAttribute('width', 120 * scale);\r\n      nodeCover.setAttribute('height', 40 * scale);\r\n      nodeCover.setAttribute('rx', 4 * scale);\r\n      nodeCover.setAttribute('ry', 4 * scale);\r\n      nodeCover.setAttribute('stroke-width', 1 * scale);\r\n      let xOffset = event.offsetX * scale,\r\n        yOffset = event.offsetY * scale;\r\n\r\n      if (opts.direction === 'l2r') {\r\n        xOffset = event.offsetY * scale;\r\n        yOffset = event.offsetX * scale;\r\n      } else if (opts.direction === 'r2l') {\r\n        xOffset = nodeDiv.offsetWidth - event.offsetY * scale;\r\n        yOffset = event.offsetX * scale;\r\n      } else if (opts.direction === 'b2t') {\r\n        xOffset = nodeDiv.offsetWidth - event.offsetX * scale;\r\n        yOffset = nodeDiv.offsetHeight - event.offsetY * scale;\r\n      }\r\n      if (isFirefox) { // hack for old version of Firefox(< 48.0)\r\n        let ghostNodeWrapper = document.createElement('img');\r\n\r\n        ghostNodeWrapper.src = 'data:image/svg+xml;utf8,' + (new XMLSerializer()).serializeToString(ghostNode);\r\n        event.dataTransfer.setDragImage(ghostNodeWrapper, xOffset, yOffset);\r\n        nodeCover.setAttribute('fill', 'rgb(255, 255, 255)');\r\n        nodeCover.setAttribute('stroke', 'rgb(191, 0, 0)');\r\n      } else {\r\n        event.dataTransfer.setDragImage(ghostNode, xOffset, yOffset);\r\n      }\r\n    }\r\n    let dragged = event.target,\r\n      dragZone = this._closest(dragged, (el) => {\r\n        return el.classList && el.classList.contains('nodes');\r\n      }).parentNode.children[0].querySelector('.node'),\r\n      dragHier = Array.from(this._closest(dragged, (el) => {\r\n        return el.nodeName === 'TABLE';\r\n      }).querySelectorAll('.node'));\r\n\r\n    this.dragged = dragged;\r\n    Array.from(this.chart.querySelectorAll('.node')).forEach(function (node) {\r\n      if (!dragHier.includes(node)) {\r\n        if (opts.dropCriteria) {\r\n          if (opts.dropCriteria(dragged, dragZone, node)) {\r\n            node.classList.add('allowedDrop');\r\n          }\r\n        } else {\r\n          node.classList.add('allowedDrop');\r\n        }\r\n      }\r\n    });\r\n  }\r\n  _onDragOver(event) {\r\n    event.preventDefault();\r\n    let dropZone = event.currentTarget;\r\n\r\n    if (!dropZone.classList.contains('allowedDrop')) {\r\n      event.dataTransfer.dropEffect = 'none';\r\n    }\r\n  }\r\n  _onDragEnd(event) {\r\n    Array.from(this.chart.querySelectorAll('.allowedDrop')).forEach(function (el) {\r\n      el.classList.remove('allowedDrop');\r\n    });\r\n  }\r\n  _onDrop(event) {\r\n    let dropZone = event.currentTarget,\r\n      chart = this.chart,\r\n      dragged = this.dragged,\r\n      dragZone = this._closest(dragged, function (el) {\r\n        return el.classList && el.classList.contains('nodes');\r\n      }).parentNode.children[0].children[0];\r\n\r\n    this._removeClass(Array.from(chart.querySelectorAll('.allowedDrop')), 'allowedDrop');\r\n    // firstly, deal with the hierarchy of drop zone\r\n    if (!dropZone.parentNode.parentNode.nextElementSibling) { // if the drop zone is a leaf node\r\n      let bottomEdge = document.createElement('i');\r\n\r\n      bottomEdge.setAttribute('class', 'edge verticalEdge bottomEdge fa');\r\n      dropZone.appendChild(bottomEdge);\r\n      dropZone.parentNode.setAttribute('colspan', 2);\r\n      let table = this._closest(dropZone, function (el) {\r\n          return el.nodeName === 'TABLE';\r\n        }),\r\n        upperTr = document.createElement('tr'),\r\n        lowerTr = document.createElement('tr'),\r\n        nodeTr = document.createElement('tr');\r\n\r\n      upperTr.setAttribute('class', 'lines');\r\n      upperTr.innerHTML = `<td colspan=\"2\"><div class=\"downLine\"></div></td>`;\r\n      table.appendChild(upperTr);\r\n      lowerTr.setAttribute('class', 'lines');\r\n      lowerTr.innerHTML = `<td class=\"rightLine\">&nbsp;</td><td class=\"leftLine\">&nbsp;</td>`;\r\n      table.appendChild(lowerTr);\r\n      nodeTr.setAttribute('class', 'nodes');\r\n      table.appendChild(nodeTr);\r\n      Array.from(dragged.querySelectorAll('.horizontalEdge')).forEach((hEdge) => {\r\n        dragged.removeChild(hEdge);\r\n      });\r\n      let draggedTd = this._closest(dragged, (el) => el.nodeName === 'TABLE').parentNode;\r\n\r\n      nodeTr.appendChild(draggedTd);\r\n    } else {\r\n      let dropColspan = window.parseInt(dropZone.parentNode.colSpan) + 2;\r\n\r\n      dropZone.parentNode.setAttribute('colspan', dropColspan);\r\n      dropZone.parentNode.parentNode.nextElementSibling.children[0].setAttribute('colspan', dropColspan);\r\n      if (!dragged.querySelector('.horizontalEdge')) {\r\n        let rightEdge = document.createElement('i'),\r\n          leftEdge = document.createElement('i');\r\n\r\n        rightEdge.setAttribute('class', 'edge horizontalEdge rightEdge fa');\r\n        dragged.appendChild(rightEdge);\r\n        leftEdge.setAttribute('class', 'edge horizontalEdge leftEdge fa');\r\n        dragged.appendChild(leftEdge);\r\n      }\r\n      let temp = dropZone.parentNode.parentNode.nextElementSibling.nextElementSibling,\r\n        leftline = document.createElement('td'),\r\n        rightline = document.createElement('td');\r\n\r\n      leftline.setAttribute('class', 'leftLine topLine');\r\n      leftline.innerHTML = `&nbsp;`;\r\n      temp.insertBefore(leftline, temp.children[1]);\r\n      rightline.setAttribute('class', 'rightLine topLine');\r\n      rightline.innerHTML = `&nbsp;`;\r\n      temp.insertBefore(rightline, temp.children[2]);\r\n      temp.nextElementSibling.appendChild(this._closest(dragged, function (el) {\r\n        return el.nodeName === 'TABLE';\r\n      }).parentNode);\r\n\r\n      let dropSibs = this._siblings(this._closest(dragged, function (el) {\r\n        return el.nodeName === 'TABLE';\r\n      }).parentNode).map((el) => el.querySelector('.node'));\r\n\r\n      if (dropSibs.length === 1) {\r\n        let rightEdge = document.createElement('i'),\r\n          leftEdge = document.createElement('i');\r\n\r\n        rightEdge.setAttribute('class', 'edge horizontalEdge rightEdge fa');\r\n        dropSibs[0].appendChild(rightEdge);\r\n        leftEdge.setAttribute('class', 'edge horizontalEdge leftEdge fa');\r\n        dropSibs[0].appendChild(leftEdge);\r\n      }\r\n    }\r\n    // secondly, deal with the hierarchy of dragged node\r\n    let dragColSpan = window.parseInt(dragZone.colSpan);\r\n\r\n    if (dragColSpan > 2) {\r\n      dragZone.setAttribute('colspan', dragColSpan - 2);\r\n      dragZone.parentNode.nextElementSibling.children[0].setAttribute('colspan', dragColSpan - 2);\r\n      let temp = dragZone.parentNode.nextElementSibling.nextElementSibling;\r\n\r\n      temp.children[1].remove();\r\n      temp.children[1].remove();\r\n\r\n      let dragSibs = Array.from(dragZone.parentNode.parentNode.children[3].children).map(function (td) {\r\n        return td.querySelector('.node');\r\n      });\r\n\r\n      if (dragSibs.length === 1) {\r\n        dragSibs[0].querySelector('.leftEdge').remove();\r\n        dragSibs[0].querySelector('.rightEdge').remove();\r\n      }\r\n    } else {\r\n      dragZone.removeAttribute('colspan');\r\n      dragZone.querySelector('.node').removeChild(dragZone.querySelector('.bottomEdge'));\r\n      Array.from(dragZone.parentNode.parentNode.children).slice(1).forEach((tr) => tr.remove());\r\n    }\r\n    let customE = new CustomEvent('nodedropped.orgchart', { 'detail': {\r\n      'draggedNode': dragged,\r\n      'dragZone': dragZone.children[0],\r\n      'dropZone': dropZone\r\n    }});\r\n\r\n    chart.dispatchEvent(customE);\r\n  }\r\n  // create node\r\n  _createNode(nodeData, level) {\r\n    let that = this,\r\n      opts = this.options;\r\n\r\n    return new Promise(function (resolve, reject) {\r\n      if (nodeData.children) {\r\n        for (let child of nodeData.children) {\r\n          child.parentId = nodeData.id;\r\n        }\r\n      }\r\n\r\n      // construct the content of node\r\n      let nodeDiv = document.createElement('div');\r\n\r\n      delete nodeData.children;\r\n      nodeDiv.dataset.source = JSON.stringify(nodeData);\r\n      if (nodeData[opts.nodeId]) {\r\n        nodeDiv.id = nodeData[opts.nodeId];\r\n      }\r\n      let inEdit = that.chart.dataset.inEdit,\r\n        isHidden;\r\n\r\n      if (inEdit) {\r\n        isHidden = inEdit === 'addChildren' ? ' slide-up' : '';\r\n      } else {\r\n        isHidden = level >= opts.depth ? ' slide-up' : '';\r\n      }\r\n      nodeDiv.setAttribute('class', 'node ' + (nodeData.className || '') + isHidden);\r\n      if (opts.draggable) {\r\n        nodeDiv.setAttribute('draggable', true);\r\n      }\r\n      if (nodeData.parentId) {\r\n        nodeDiv.setAttribute('data-parent', nodeData.parentId);\r\n      }\r\n      nodeDiv.innerHTML = `\r\n        <div class=\"title\">${nodeData[opts.nodeTitle]}</div>\r\n        ${opts.nodeContent ? `<div class=\"content\">${nodeData[opts.nodeContent]}</div>` : ''}\r\n      `;\r\n      // append 4 direction arrows or expand/collapse buttons\r\n      let flags = nodeData.relationship || '';\r\n\r\n      if (opts.verticalDepth && (level + 2) > opts.verticalDepth) {\r\n        if ((level + 1) >= opts.verticalDepth && Number(flags.substr(2, 1))) {\r\n          let toggleBtn = document.createElement('i');\r\n\r\n          toggleBtn.setAttribute('class', 'toggleBtn fa fa-minus-square');\r\n          nodeDiv.appendChild(toggleBtn);\r\n        }\r\n      } else {\r\n        if (Number(flags.substr(0, 1))) {\r\n          let topEdge = document.createElement('i');\r\n\r\n          topEdge.setAttribute('class', 'edge verticalEdge topEdge fa');\r\n          nodeDiv.appendChild(topEdge);\r\n        }\r\n        if (Number(flags.substr(1, 1))) {\r\n          let rightEdge = document.createElement('i'),\r\n            leftEdge = document.createElement('i');\r\n\r\n          rightEdge.setAttribute('class', 'edge horizontalEdge rightEdge fa');\r\n          nodeDiv.appendChild(rightEdge);\r\n          leftEdge.setAttribute('class', 'edge horizontalEdge leftEdge fa');\r\n          nodeDiv.appendChild(leftEdge);\r\n        }\r\n        if (Number(flags.substr(2, 1))) {\r\n          let bottomEdge = document.createElement('i'),\r\n            symbol = document.createElement('i'),\r\n            title = nodeDiv.querySelector(':scope > .title');\r\n\r\n          bottomEdge.setAttribute('class', 'edge verticalEdge bottomEdge fa');\r\n          nodeDiv.appendChild(bottomEdge);\r\n          symbol.setAttribute('class', 'fa ' + opts.parentNodeSymbol + ' symbol');\r\n          title.insertBefore(symbol, title.children[0]);\r\n        }\r\n      }\r\n\r\n      nodeDiv.addEventListener('mouseenter', that._hoverNode.bind(that));\r\n      nodeDiv.addEventListener('mouseleave', that._hoverNode.bind(that));\r\n      nodeDiv.addEventListener('click', that._dispatchClickEvent.bind(that));\r\n      if (opts.draggable) {\r\n        nodeDiv.addEventListener('dragstart', that._onDragStart.bind(that));\r\n        nodeDiv.addEventListener('dragover', that._onDragOver.bind(that));\r\n        nodeDiv.addEventListener('dragend', that._onDragEnd.bind(that));\r\n        nodeDiv.addEventListener('drop', that._onDrop.bind(that));\r\n      }\r\n      // allow user to append dom modification after finishing node create of orgchart\r\n      if (opts.createNode) {\r\n        opts.createNode(nodeDiv, nodeData);\r\n      }\r\n\r\n      resolve(nodeDiv);\r\n    });\r\n  }\r\n  buildHierarchy(appendTo, nodeData, level, callback) {\r\n    // Construct the node\r\n    let that = this,\r\n      opts = this.options,\r\n      nodeWrapper,\r\n      childNodes = nodeData.children,\r\n      isVerticalNode = opts.verticalDepth && (level + 1) >= opts.verticalDepth;\r\n\r\n    if (Object.keys(nodeData).length > 1) { // if nodeData has nested structure\r\n      nodeWrapper = isVerticalNode ? appendTo : document.createElement('table');\r\n      if (!isVerticalNode) {\r\n        appendTo.appendChild(nodeWrapper);\r\n      }\r\n      this._createNode(nodeData, level)\r\n      .then(function (nodeDiv) {\r\n        if (isVerticalNode) {\r\n          nodeWrapper.appendChild(nodeDiv);\r\n        }else {\r\n          let tr = document.createElement('tr');\r\n\r\n          tr.innerHTML = `\r\n            <td ${childNodes ? `colspan=\"${childNodes.length * 2}\"` : ''}>\r\n            </td>\r\n          `;\r\n          tr.children[0].appendChild(nodeDiv);\r\n          nodeWrapper.insertBefore(tr, nodeWrapper.children[0] ? nodeWrapper.children[0] : null);\r\n        }\r\n        if (callback) {\r\n          callback();\r\n        }\r\n      })\r\n      .catch(function (err) {\r\n        console.error('Failed to creat node', err);\r\n      });\r\n    }\r\n    // Construct the inferior nodes and connectiong lines\r\n    if (childNodes) {\r\n      if (Object.keys(nodeData).length === 1) { // if nodeData is just an array\r\n        nodeWrapper = appendTo;\r\n      }\r\n      let isHidden,\r\n        isVerticalLayer = opts.verticalDepth && (level + 2) >= opts.verticalDepth,\r\n        inEdit = that.chart.dataset.inEdit;\r\n\r\n      if (inEdit) {\r\n        isHidden = inEdit === 'addSiblings' ? '' : ' hidden';\r\n      } else {\r\n        isHidden = level + 1 >= opts.depth ? ' hidden' : '';\r\n      }\r\n\r\n      // draw the line close to parent node\r\n      if (!isVerticalLayer) {\r\n        let tr = document.createElement('tr');\r\n\r\n        tr.setAttribute('class', 'lines' + isHidden);\r\n        tr.innerHTML = `\r\n          <td colspan=\"${ childNodes.length * 2 }\">\r\n            <div class=\"downLine\"></div>\r\n          </td>\r\n        `;\r\n        nodeWrapper.appendChild(tr);\r\n      }\r\n      // draw the lines close to children nodes\r\n      let lineLayer = document.createElement('tr');\r\n\r\n      lineLayer.setAttribute('class', 'lines' + isHidden);\r\n      lineLayer.innerHTML = `\r\n        <td class=\"rightLine\">&nbsp;</td>\r\n        ${childNodes.slice(1).map(() => `\r\n          <td class=\"leftLine topLine\">&nbsp;</td>\r\n          <td class=\"rightLine topLine\">&nbsp;</td>\r\n          `).join('')}\r\n        <td class=\"leftLine\">&nbsp;</td>\r\n      `;\r\n      let nodeLayer;\r\n\r\n      if (isVerticalLayer) {\r\n        nodeLayer = document.createElement('<ul>');\r\n        if (level + 2 === opts.verticalDepth) {\r\n          let tr = document.createElement('tr');\r\n\r\n          tr.setAttribute('class', 'verticalNodes');\r\n          tr.innerHTML = `<td></td>`;\r\n          tr.firstChild.appendChild(nodeLayer);\r\n        } else {\r\n          nodeWrapper.appendChild(nodeLayer);\r\n        }\r\n      } else {\r\n        nodeLayer = document.createElement('tr');\r\n        nodeLayer.setAttribute('class', 'nodes' + isHidden);\r\n        nodeWrapper.appendChild(lineLayer);\r\n        nodeWrapper.appendChild(nodeLayer);\r\n      }\r\n      // recurse through children nodes\r\n      childNodes.forEach((child) => {\r\n        let nodeCell;\r\n\r\n        if (isVerticalLayer) {\r\n          nodeCell = document.createElement('li');\r\n        } else {\r\n          nodeCell = document.createElement('td');\r\n          nodeCell.setAttribute('colspan', 2);\r\n        }\r\n        nodeLayer.appendChild(nodeCell);\r\n        that.buildHierarchy(nodeCell, child, level + 1, callback);\r\n      });\r\n    }\r\n  }\r\n  _clickChart(event) {\r\n    let closestNode = this._closest(event.target, function (el) {\r\n      return el.classList && el.classList.contains('node');\r\n    });\r\n\r\n    if (!closestNode && this.chart.querySelector('.node.focused')) {\r\n      this.chart.querySelector('.node.focused').classList.remove('focused');\r\n    }\r\n  }\r\n  _clickExportButton() {\r\n    let opts = this.options,\r\n      chartContainer = this.chartContainer,\r\n      mask = chartContainer.querySelector(':scope > .mask'),\r\n      sourceChart = chartContainer.querySelector('.orgchart:not(.hidden)'),\r\n      flag = opts.direction === 'l2r' || opts.direction === 'r2l';\r\n\r\n    if (!mask) {\r\n      mask = document.createElement('div');\r\n      mask.setAttribute('class', 'mask');\r\n      mask.innerHTML = `<i class=\"fa fa-circle-o-notch fa-spin spinner\"></i>`;\r\n      chartContainer.appendChild(mask);\r\n    } else {\r\n      mask.classList.remove('hidden');\r\n    }\r\n    chartContainer.classList.add('canvasContainer');\r\n    window.html2canvas(sourceChart, {\r\n      'width': flag ? sourceChart.clientHeight : sourceChart.clientWidth,\r\n      'height': flag ? sourceChart.clientWidth : sourceChart.clientHeight,\r\n      'onclone': function (cloneDoc) {\r\n        let canvasContainer = cloneDoc.querySelector('.canvasContainer');\r\n\r\n        canvasContainer.style.overflow = 'visible';\r\n        canvasContainer.querySelector('.orgchart:not(.hidden)').transform = '';\r\n      }\r\n    })\r\n    .then((canvas) => {\r\n      let downloadBtn = chartContainer.querySelector('.oc-download-btn');\r\n\r\n      chartContainer.querySelector('.mask').classList.add('hidden');\r\n      downloadBtn.setAttribute('href', canvas.toDataURL());\r\n      downloadBtn.click();\r\n    })\r\n    .catch((err) => {\r\n      console.error('Failed to export the curent orgchart!', err);\r\n    })\r\n    .finally(() => {\r\n      chartContainer.classList.remove('canvasContainer');\r\n    });\r\n  }\r\n  _loopChart(chart) {\r\n    let subObj = { 'id': chart.querySelector('.node').id };\r\n\r\n    if (chart.children[3]) {\r\n      Array.from(chart.children[3].children).forEach((el) => {\r\n        if (!subObj.children) { subObj.children = []; }\r\n        subObj.children.push(this._loopChart(el.firstChild));\r\n      });\r\n    }\r\n    return subObj;\r\n  }\r\n  getHierarchy() {\r\n    if (!this.chart.querySelector('.node').id) {\r\n      return 'Error: Nodes of orghcart to be exported must have id attribute!';\r\n    }\r\n    return this._loopChart(this.chart.querySelector('table'));\r\n  }\r\n  _onPanStart(event) {\r\n    let chart = event.currentTarget;\r\n\r\n    if (this._closest(event.target, (el) => el.classList && el.classList.contains('node')) ||\r\n      (event.touches && event.touches.length > 1)) {\r\n      chart.dataset.panning = false;\r\n      return;\r\n    }\r\n    chart.style.cursor = 'move';\r\n    chart.dataset.panning = true;\r\n\r\n    let lastX = 0,\r\n      lastY = 0,\r\n      lastTf = window.getComputedStyle(chart).transform;\r\n\r\n    if (lastTf !== '') {\r\n      let temp = lastTf.split(',');\r\n\r\n      if (!lastTf.includes('3d')) {\r\n        lastX = Number.parseInt(temp[4], 10);\r\n        lastY = Number.parseInt(temp[5], 10);\r\n      } else {\r\n        lastX = Number.parseInt(temp[12], 10);\r\n        lastY = Number.parseInt(temp[13], 10);\r\n      }\r\n    }\r\n    let startX = 0,\r\n      startY = 0;\r\n\r\n    if (!event.targetTouches) { // pan on desktop\r\n      startX = event.pageX - lastX;\r\n      startY = event.pageY - lastY;\r\n    } else if (event.targetTouches.length === 1) { // pan on mobile device\r\n      startX = event.targetTouches[0].pageX - lastX;\r\n      startY = event.targetTouches[0].pageY - lastY;\r\n    } else if (event.targetTouches.length > 1) {\r\n      return;\r\n    }\r\n    chart.dataset.panStart = JSON.stringify({ 'startX': startX, 'startY': startY });\r\n    chart.addEventListener('mousemove', this._onPanning.bind(this));\r\n    chart.addEventListener('touchmove', this._onPanning.bind(this));\r\n  }\r\n  _onPanning(event) {\r\n    let chart = event.currentTarget;\r\n\r\n    if (chart.dataset.panning === 'false') {\r\n      return;\r\n    }\r\n    let newX = 0,\r\n      newY = 0,\r\n      panStart = JSON.parse(chart.dataset.panStart),\r\n      startX = panStart.startX,\r\n      startY = panStart.startY;\r\n\r\n    if (!event.targetTouches) { // pand on desktop\r\n      newX = event.pageX - startX;\r\n      newY = event.pageY - startY;\r\n    } else if (event.targetTouches.length === 1) { // pan on mobile device\r\n      newX = event.targetTouches[0].pageX - startX;\r\n      newY = event.targetTouches[0].pageY - startY;\r\n    } else if (event.targetTouches.length > 1) {\r\n      return;\r\n    }\r\n    let lastTf = window.getComputedStyle(chart).transform;\r\n\r\n    if (lastTf === '') {\r\n      if (!lastTf.includes('3d')) {\r\n        chart.style.transform = 'matrix(1, 0, 0, 1, ' + newX + ', ' + newY + ')';\r\n      } else {\r\n        chart.style.transform = 'matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, ' + newX + ', ' + newY + ', 0, 1)';\r\n      }\r\n    } else {\r\n      let matrix = lastTf.split(',');\r\n\r\n      if (!lastTf.includes('3d')) {\r\n        matrix[4] = newX;\r\n        matrix[5] = newY + ')';\r\n      } else {\r\n        matrix[12] = newX;\r\n        matrix[13] = newY;\r\n      }\r\n      chart.style.transform = matrix.join(',');\r\n    }\r\n  }\r\n  _onPanEnd(event) {\r\n    let chart = this.chart;\r\n\r\n    if (chart.dataset.panning === 'true') {\r\n      chart.dataset.panning = false;\r\n      chart.style.cursor = 'default';\r\n      document.body.removeEventListener('mousemove', this._onPanning);\r\n      document.body.removeEventListener('touchmove', this._onPanning);\r\n    }\r\n  }\r\n  _setChartScale(chart, newScale) {\r\n    let lastTf = window.getComputedStyle(chart).transform;\r\n\r\n    if (lastTf === 'none') {\r\n      chart.style.transform = 'scale(' + newScale + ',' + newScale + ')';\r\n    } else {\r\n      let matrix = lastTf.split(',');\r\n\r\n      if (!lastTf.includes('3d')) {\r\n        matrix[0] = 'matrix(' + newScale;\r\n        matrix[3] = newScale;\r\n        chart.style.transform = lastTf + ' scale(' + newScale + ',' + newScale + ')';\r\n      } else {\r\n        chart.style.transform = lastTf + ' scale3d(' + newScale + ',' + newScale + ', 1)';\r\n      }\r\n    }\r\n    chart.dataset.scale = newScale;\r\n  }\r\n  _onWheeling(event) {\r\n    event.preventDefault();\r\n\r\n    let newScale = event.deltaY > 0 ? 0.8 : 1.2;\r\n\r\n    this._setChartScale(this.chart, newScale);\r\n  }\r\n  _getPinchDist(event) {\r\n    return Math.sqrt((event.touches[0].clientX - event.touches[1].clientX) *\r\n      (event.touches[0].clientX - event.touches[1].clientX) +\r\n      (event.touches[0].clientY - event.touches[1].clientY) *\r\n      (event.touches[0].clientY - event.touches[1].clientY));\r\n  }\r\n  _onTouchStart(event) {\r\n    let chart = this.chart;\r\n\r\n    if (event.touches && event.touches.length === 2) {\r\n      let dist = this._getPinchDist(event);\r\n\r\n      chart.dataset.pinching = true;\r\n      chart.dataset.pinchDistStart = dist;\r\n    }\r\n  }\r\n  _onTouchMove(event) {\r\n    let chart = this.chart;\r\n\r\n    if (chart.dataset.pinching) {\r\n      let dist = this._getPinchDist(event);\r\n\r\n      chart.dataset.pinchDistEnd = dist;\r\n    }\r\n  }\r\n  _onTouchEnd(event) {\r\n    let chart = this.chart;\r\n\r\n    if (chart.dataset.pinching) {\r\n      chart.dataset.pinching = false;\r\n      let diff = chart.dataset.pinchDistEnd - chart.dataset.pinchDistStart;\r\n\r\n      if (diff > 0) {\r\n        this._setChartScale(chart, 1);\r\n      } else if (diff < 0) {\r\n        this._setChartScale(chart, -1);\r\n      }\r\n    }\r\n  }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** D:/Git/OrgChart.js/~/eslint-loader!./src/index.js\n **/"],"sourceRoot":""}