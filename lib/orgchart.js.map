{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap e7e9144c1669bcb2b4e5","webpack:///./src/index.js"],"names":["OrgChart","chartContainer","data","nodeTitle","nodeId","toggleSiblingsResp","depth","chartClass","exportButton","exportFilename","parentNodeSymbol","draggable","direction","pan","zoom","_name","options","_init","opts","chart","document","createElement","setAttribute","addEventListener","event","node","_closest","target","el","classList","contains","querySelector","removeClass","nodeName","buildHierarchy","_buildJsonDS","children","ajaxURL","_attachRel","spinner","_getJSON","then","resp","catch","err","console","error","finally","parentNode","removeChild","appendChild","fn","closest","expr","sibs","parseNode","child","matches","push","selector","preSib","previousElementSibling","nextSib","nextElementSibling","offsetParent","elements","className","nodeList","forEach","add","remove","prop","val","style","attr","removeAttr","url","Promise","resolve","reject","client","XMLHttpRequest","open","onreadystatechange","handler","responseType","setRequestHeader","send","readyState","status","response","Error","statusText","li","subObj","firstChild","textContent","trim","tagName","length","id","subLi","buildJsonDS","flags","relationship","item","attachRel","offsetWidth","indexOf","flag","topEdge","rightEdge","bottomEdge","leftEdge","type","getNodeState","visible","toggle","switchHorizontalArrow","currentRoot","nodeData","callback","table","createNode","dataset","nodeDiv","innerHTML","insertBefore","lastChild","temp","tr","_addClass","slice","parent","repaint","isInAction","switchVerticalArrow","nodeContainer","siblings","_siblings","sib","inAjax","preSibs","_prevAll","querySelectorAll","_isVisible","nextSibs","_nextAll","next","animatedNodes","concat","lines","line","visibility","removeAttribute","someLines","_removeClass","hideSiblings","_css","grandfatherVisible","_removeAttr","hideAncestorsSiblings","_buildParentNode","showParent","$currentRoot","stopPropagation","parentState","exist","startLoading","Object","keys","addParent","_endLoading","$node","count","buildChildNode","call","append","find","prepend","showDescendants","childrenState","is","hideDescendants","$that","$","ajax","isFunction","done","textStatus","jqXHR","addChildren","extend","fail","errorThrown","log","always","endLoading","level","chilren","parentId","nodeContent","verticalDepth","Number","substr","toggleBtn","$nodeDiv","symbol","title","_hoverNode","_clickNode","clickTopEdge","clickBottomEdge","on","$this","$descWrapper","$descendants","$children","toggleClass","eq","get","addClass","one","siblingsState","$siblings","$prevSib","prev","$nextSib","showSiblings","families","addSiblings","origEvent","originalEvent","isFirefox","test","window","navigator","userAgent","toLowerCase","dataTransfer","setData","css","ghostNode","nodeCover","createElementNS","transValues","split","scale","Math","abs","parseFloat","outerWidth","outerHeight","xOffset","offsetX","yOffset","offsetY","ghostNodeWrapper","src","XMLSerializer","serializeToString","setDragImage","$dragged","$dragZone","$dragHier","each","index","dropCriteria","preventDefault","$dropZone","dropEffect","$orgchart","after","end","dropColspan","parseInt","horizontalEdges","addBack","before","$dropSibs","dragColspan","$dragSibs","triggerHandler","appendTo","nodeWrapper","childNodes","hasChildren","isVerticalNode","_createNode","$nodeWrapper","$appendTo","isHidden","isVerticalLayer","i","$childNodes","lineLayer","map","$nodeLayer","nodeLayer","$nodeCell","nodeCell"],"mappings":"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","file":"orgchart.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"orgchart\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"orgchart\"] = factory();\n\telse\n\t\troot[\"orgchart\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap e7e9144c1669bcb2b4e5\n **/","export default class OrgChart {\n  constructor({\n    chartContainer,\n    data,\n    nodeTitle = 'name',\n    nodeId = 'id',\n    toggleSiblingsResp = false,\n    depth = 999,\n    chartClass = '',\n    exportButton = false,\n    exportFilename = 'OrgChart',\n    parentNodeSymbol = 'fa-users',\n    draggable = false,\n    direction = 't2b',\n    pan = false,\n    zoom = false\n  } = {}) {\n    this._name = 'OrgChart';\n    this.options = {\n      'chartContainer': chartContainer,\n      'nodeTitle': nodeTitle,\n      'nodeId': nodeId,\n      'toggleSiblingsResp': toggleSiblingsResp,\n      'depth': depth,\n      'chartClass': chartClass,\n      'exportButton': exportButton,\n      'exportFilename': exportFilename,\n      'parentNodeSymbol': parentNodeSymbol,\n      'draggable': draggable,\n      'direction': direction,\n      'pan': pan,\n      'zoom': zoom\n    };\n\n    this._init();\n  }\n  get name() {\n    return this._name;\n  }\n  _init() {\n    // build the org-chart\n    let opts = this.options,\n      data = opts.data,\n      chart = document.createElement('div');\n\n    this.chart = chart;\n\n    chart.setAttribute('data-options', opts);\n    chart.setAttribute('class', 'orgchart' + (opts.chartClass !== '' ? ' ' + opts.chartClass : '') +\n      (opts.direction !== 't2b' ? ' ' + opts.direction : ''));\n    chart.addEventListener('click', function (event) {\n      let node = this._closest(event.target, function (el) {\n        return el.classList.contains('node');\n      });\n\n      if (!node) {\n        chart.querySelector('.node.focused').removeClass('focused');\n      }\n    }, false);\n    if (typeof data === 'object') {\n      if (data.nodeName) { // ul datasource\n        this.buildHierarchy(chart, this._buildJsonDS(data.children[0], 0, opts));\n      } else { // local json datasource\n        this.buildHierarchy(chart, opts.ajaxURL ? data : this._attachRel(data, '00'), 0, opts);\n      }\n    } else {\n      let spinner = document.createElement('i');\n      spinner.setAttribute('class', 'fa fa-circle-o-notch fa-spin spinner');\n      this._getJSON(data)\n      .then(function(resp) { //cb\n        this.buildHierarchy(chart, opts.ajaxURL ? resp : this._attachRel(resp, '00'), 0, opts);\n      })\n      .catch(function(err) {\n        console.error('failed to fetch datasource for orgchart', err);\n      })\n      .finally(function() {\n        let spinner = chart.querySelector('.spinner')\n        spinner.parentNode.removeChild(spinner);\n      });\n    }\n    opts.chartContainer.appendChild(chart);\n  }\n  _closest(el, fn) {\n    return el && (fn(el) ? el : closest(el.parentNode, fn));\n  }\n  _siblings(el, expr) {\n    let sibs = [];\n    for (let child of el.parseNode.children) {\n      if (child !== el ) {\n        if (expr) {\n          if (el.matches(expr)) {\n            sibs.push(child);\n          }\n        } else {\n          sibs.push(child);\n        }\n      }\n    }\n    return sibs;\n  }\n  _prevAll(el, selector) {\n    let sibs = [];\n    let preSib = el.previousElementSibling;\n\n    while (preSib) {\n      if (!selector || el.matches(selector)) {\n        sibs.push(preSib);\n      }\n      preSib = preSib.previousElementSibling;\n    }\n    return sibs;\n  }\n  _nextAll(el) {\n    let sibs = [];\n    let nextSib = el.nextElementSibling;\n\n    while (nextSib) {\n      if (!selector || el.matches(selector)) {\n        sibs.push(nextSib);\n      }\n      nextSib = nextSib.nextElementSibling;\n    }\n    return sibs;\n  }\n  _isVisible(el) {\n    return el.offsetParent !== null;\n  }\n  _addClass(elements, className) {\n    nodeList.forEach(function(el) {\n      el.classList.add(className);\n    });\n  }\n  _removeClass(elements, className) {\n    nodeList.forEach(function(el) {\n      el.classList.remove(className);\n    });\n  }\n  _css(elements, prop, val) {\n    elements.forEach(function(el) {\n      el.style[prop] = val;\n    });\n  }\n  _removeAttr(elements, attr) {\n    elements.forEach(function(el) {\n      el.removeAttr(attr);\n    });\n  }\n  _getJSON(url) {\n    return new Promise(function(resolve, reject){\n      var client = new XMLHttpRequest();\n      client.open('GET', url);\n      client.onreadystatechange = handler;\n      client.responseType = 'json';\n      client.setRequestHeader('Accept', 'application/json');\n      client.send();\n\n      function handler() {\n        if (this.readyState !== 4) {\n          return;\n        }\n        if (this.status === 200) {\n          resolve(this.response);\n        } else {\n          reject(new Error(this.statusText));\n        }\n      };\n    });\n  }\n  _buildJsonDS(li) {\n    var subObj = {\n      'name': li.firstChild.textContent.trim(),\n      'relationship': (li.parentNode.parentNode.tagName === 'li' ? '1': '0') +\n        (li.parentNode.children > 1 ? 1: 0) + (li.children.length ? 1 : 0)\n    };\n\n    if (li.id) {\n      subObj.id = li.id;\n    }\n    for (let subLi of li.querySelector('ul').children) {\n      if (!subObj.children) { subObj.children = []; }\n      subObj.children.push(buildJsonDS(subLi));\n    }\n    return subObj;\n  }\n  _attachRel(data, flags) {\n    data.relationship = flags + (data.children && data.children.length > 0 ? 1 : 0);\n    if (data.children) {\n      for (let item of data.children) {\n        attachRel(item, '1' + (data.children.length > 1 ? 1 : 0));\n      }\n    }\n    return data;\n  }\n  _repaint(node) {\n    if (node) {\n      node.style.offsetWidth = node.offsetWidth;\n    }\n  }\n  // whether the cursor is hovering over the node\n  _isInAction(node) {\n    return node.querySelector(':scope > .edge').className.indexOf('fa-') > -1 ? true : false;\n  }\n  hoverNode(event) {\n    let node = event.target,\n      flag = false;\n      topEdge = node.querySelector(':scope > .topEdge');\n      rightEdge = node.querySelector(':scope > .rightEdge');\n      bottomEdge = node.querySelector(':scope > .bottomEdge');\n      leftEdge = node.querySelector(':scope > .leftEdge');\n    if (event.type === 'mouseenter') {\n      if (topEdge) {\n        flag = getNodeState(node, 'parent').visible;\n        topEdge.classList.toggle('fa-chevron-up', !flag)\n        topEdge.classList.toggle('fa-chevron-down', flag);\n      }\n      if (bottomEdge) {\n        flag = getNodeState(node, 'children').visible;\n        bottomEdge.classList.toggle('fa-chevron-down', !flag)\n        bottomEdge.classList.toggle('fa-chevron-up', flag);\n      }\n      if (leftEdge) {\n        switchHorizontalArrow(node);\n      }\n    } else {\n      node.querySelector(':scope > .edge').classList.remove('fa-chevron-up', 'fa-chevron-down', 'fa-chevron-right', 'fa-chevron-left');\n    }\n  }\n  // define node click event handler\n  _clickNode(event) {\n    let node = event.target;\n    let chart = this._closest(node, function (el) {\n      return el.classList.contains('orgchart');\n    });\n    chart.querySelector('.focused').classList.remove('focused');\n    node.classList.add('focused');\n  }\n  // build the parent node of specific node\n  _buildParentNode(currentRoot, nodeData, opts, callback) {\n    let table = document.createElement('table');\n\n    nodeData.relationship = '001';\n    this.createNode(nodeData, 0, opts || this.chart.dataset.options)\n      .then(function(nodeDiv) {\n        let chart = this.chart;\n\n        nodeDiv.classList.remove('slide-up');\n        nodeDiv.classList.add('slide-down');\n        table.innerHTML = `\n          <tr class=\"hidden\"><td colspan=\"2\"></td></tr>\n          <tr class=\"lines hidden\"><td colspan=\"2\"><div class=\"downLine\"></div></td></tr>\n          <tr class=\"lines hidden\"><td class=\"rightLine\">&nbsp;</td><td class=\"leftLine\">&nbsp;</td></tr>\n          <tr class=\"nodes\"><td colspan=\"2\"></td></tr>\n        `;\n        table.firstChild.firstChild.appendChild(nodeDiv);\n        chart.insertBefore(table, chart.firstChild);\n        table.lastChild.firstChild.appendChild(chart.lastChild);\n        callback();\n      })\n      .catch(function(err) {\n        console.error('Failed to create parent node', err);\n      });\n  }\n  // show the parent node of the specified node\n  showParent(node) {\n    // just show only one superior level\n    let temp = this._closest(node, function (el) {\n      return el.nodeName === 'TABLE';\n    }).parentNode.children;\n    for (let tr of temp) {\n      tr.classList.remove('hidden');\n    }\n    // just show only one line\n    this._addClass(temp[2].children.slice(1, -1), 'hidden');\n    // show parent node with animation\n    let parent = temp[0].querySelector('.node');\n    repaint(parent);\n    parent.classList.add('slide');\n    parent.classList.remove('slide-down');\n    parent.addEventListener('transitionend', function() {\n      parent.classList.remove('slide');\n      if (isInAction(node)) {\n        switchVerticalArrow(node.querySelector(':scope > .topEdge'));\n      }\n    }, { 'once': true});\n  }\n  // hide the sibling nodes of the specified node\n  hideSiblings(node, direction) {\n    let nodeContainer = this._closest(node, function (el) {\n      return el.nodeName === 'TABLE';\n    }).parentNode;\n\n    let siblings = this._siblings(nodeContainer);\n    for (let sib of siblings) {\n      if (sib.querySelector('.spinner')) {\n        this.chart.dataset.inAjax = false;\n      }\n    }\n    \n    if (!direction || (direction && direction === 'left')) {\n      let preSibs = this._prevAll(nodeContainer);\n      for (let sib of preSibs) {\n        for (let node of sib.querySelectorAll('.node')) {\n          if (!this._isVisible(node)) {\n            node.classList.add('slide', 'slide-right');\n          } \n        }\n      }\n    }\n    if (!direction || (direction && direction !== 'left')) {\n      let nextSibs = this._nextAll(nodeContainer);\n      for (let sib of nextSibs) {\n        for (let node of next.querySelectorAll('.node')) {\n          if (!this._isVisible(node)) {\n            node.classList.add('slide', 'slide-left');\n          } \n        }\n        nextSib = nextSib.nextElementSibling;\n      }\n    }\n\n    let animatedNodes = [];\n\n    for (let sib of this._siblings(nodeContainer)) {\n      animatedNodes.concat(sib.querySelectorAll('.slide'));\n    }\n    let lines = [];\n\n    for (let node of animatedNodes) {\n      let temp = this._closest(node, function (el) {\n        return el.classList.contains('nodes');\n      }).parentNode.firstChild;\n      lines.push(temp);\n      lines.push(temp.nextElementSibling);\n    }\n    lines.forEach(function(line) {\n      line.style.visibility = 'hidden';\n    });\n\n    animatedNodes[0].addEventListener('transitionend', function() {\n      lines.forEach(function(line) {\n        line.removeAttribute('style');\n      });\n      let sibs = [];\n\n      if (direction) {\n        if (direction === 'left') {\n          sibs = this._prevAll(nodeContainer, ':not(.hidden)');\n        } else {\n          sibs = this._nextAll(nodeContainer, ':not(.hidden)');\n        }\n      } else {\n        sibs = this._siblings(nodeContainer);\n      }\n      let temp = this._closest(nodeContainer, function (el) {\n        return el.classList.contains('nodes');\n      }).previousElementSibling.querySelectorAll(':scope > :not(.hidden)');\n\n      let someLines = temp.slice(1, direction ? sibs.length * 2 + 1 : -1);\n      this._addClass(someLines, 'hidden');\n      this._removeClass(animatedNodes, 'slide');\n      sibs.querySelectorAll('.node').slice(1).forEach(function(node) {\n        if (this._isVisible(node)) {\n          node.classList.remove('slide-left', 'slide-right');\n          node.classList.add('slide-up');\n        }\n      });\n      this._addClass(sibs.querySelectorAll('.lines'), 'hidden');\n      this._addClass(sibs.querySelectorAll('.nodes'), 'hidden');\n      this._addClass(sibs.querySelectorAll('.verticalNodes'), 'hidden');\n      this._addClass(sibs, 'hidden');\n\n      if (isInAction(node)) {\n        switchHorizontalArrow(node);\n      }\n    }, { 'once': true });\n  }\n  // recursively hide the ancestor node and sibling nodes of the specified node\n  hideAncestorsSiblings(node) {\n    let temp = this._closest(node, function (el) {\n      return el.classList.contains('nodes');\n    }).parentNode.children;\n    if (temp[0].querySelector('.spinner')) {\n      this.chart.dataset.inAjax = false;\n    }\n    // hide the sibling nodes\n    if (getNodeState(node, 'siblings').visible) {\n      hideSiblings(node);\n    }\n    // hide the lines\n    let lines = temp.slice(1);\n    this._css(lines, 'visibility', 'hidden');\n    // hide the superior nodes with transition\n    let parent = temp[0].querySelector('.node');\n    let grandfatherVisible = getNodeState(parent, 'parent').visible;\n    if (parent && this._isVisible(parent)) {\n      parent.classList.add('slide', 'slide-down')\n      parent.addEventListener('transitionend', function() {\n        parent.classList.remove('slide');\n        this._removeAttr(lines, 'style');\n        this._addClass(temp, 'hidden');\n      }, { 'once': true });\n    }\n    // if the current node has the parent node, hide it recursively\n    if (parent && grandfatherVisible) {\n      hideAncestorsSiblings(parent);\n    }\n  }\n  // exposed method\n  addParent(currentRoot, data, opts) {\n    this._buildParentNode(currentRoot, data, opts, function() {\n      if (!currentRoot.querySelector(':scope .topEdge').length) {\n        let topEdge = document.createElement('i');\n        topEdge.setAttribute('class', 'edge verticalEdge topEdge fa');\n        currentRoot.appendChild(topEdge);\n      }\n      showParent($currentRoot);\n    });\n  }\n  // define click event handler for the top edge\n  _clickTopEdge(event) {\n    event.stopPropagation();\n    let topEdge = event.target,\n      node = topEdge.parentNode,\n      parentState = getNodeState(node, 'parent'),\n      opts = this.dataset.options;\n\n    if (parentState.exist) {\n      let temp = this._closest(node, function (el) {\n        return el.classList.contains('nodes');\n      });\n      var parent = temp.parentNode.firstChild.querySelector('.node');\n      if (parent.classList.contains('slide')) { return; }\n      // hide the ancestor nodes and sibling nodes of the specified node\n      if (parentState.visible) {\n        hideAncestorsSiblings(node);\n        parent.addEventListener('transitionend', function() {\n          if (isInAction(node)) {\n            switchVerticalArrow(topEdge);\n            switchHorizontalArrow(node);\n          }\n        }, { 'once': true });\n      } else { // show the ancestors and siblings\n        showParent(node);\n      }\n    } else {\n      // load the new parent node of the specified node by ajax request\n      var nodeId = topEdge.parentNode.id;\n      // start up loading status\n      if (startLoading(topEdge, node, opts)) {\n        // load new nodes\n        this._getJSON(typeof opts.ajaxURL.parent === 'function' ? opts.ajaxURL.parent(nodeData) : opts.ajaxURL.parent + nodeId)\n        .then(function(resp) {\n          let chart = this._closest(node, function (el) {\n            return el.classList.contains('orgchart');\n          });\n          if (chart.dataset.inAjax) {\n            if (!Object.keys(resp).length) {\n              this.addParent(node, data, opts);\n            }\n          }\n        })\n        .catch(function(err) {\n          console.error('Failed to get parent node data.', err);\n        })\n        .finally(function() {\n          this._endLoading(topEdge, node, opts);\n        });\n      }\n    }\n  }\n  // exposed method\n  addChildren(node, data, opts) {\n    var opts = opts || $node.closest('.orgchart').data('options');\n    var count = 0;\n    buildChildNode.call($node.closest('.orgchart').parent(), $node.closest('table'), data, opts, function() {\n      if (++count === data.children.length) {\n        if (!$node.children('.bottomEdge').length) {\n          $node.append('<i class=\"edge verticalEdge bottomEdge fa\"></i>');\n        }\n        if (!$node.find('.symbol').length) {\n          $node.children('.title').prepend('<i class=\"fa '+ opts.parentNodeSymbol + ' symbol\"></i>');\n        }\n        showDescendants($node);\n      }\n    });\n  }\n  // bind click event handler for the bottom edge\n  _clickBottomEdge(event) {\n    event.stopPropagation();\n    let bottomEdge = event.target,\n      node = bottomEdge.parentNode;\n      childrenState = getNodeState(node, 'children');\n\n    if (childrenState.exist) {\n      var children = node.closest('tr').siblings(':last');\n      if (children.find('.node:visible').is('.slide')) { return; }\n      // hide the descendant nodes of the specified node\n      if (childrenState.visible) {\n        hideDescendants($node);\n      } else { // show the descendants\n        showDescendants($node);\n      }\n    } else { // load the new children nodes of the specified node by ajax request\n      var nodeId = $that.parent()[0].id;\n      if (startLoading($that, $node, opts)) {\n        $.ajax({ 'url': $.isFunction(opts.ajaxURL.children) ? opts.ajaxURL.children(nodeData) : opts.ajaxURL.children + nodeId, 'dataType': 'json' })\n        .done(function(data, textStatus, jqXHR) {\n          if ($node.closest('.orgchart').data('inAjax')) {\n            if (data.children.length) {\n              addChildren($node, data, $.extend({}, opts, { depth: 0 }));\n            }\n          }\n        })\n        .fail(function(jqXHR, textStatus, errorThrown) {\n          console.log('Failed to get children nodes data');\n        })\n        .always(function() {\n          endLoading($that, $node, opts);\n        });\n      }\n    }\n  }\n  // create node\n  _createNode(nodeData, level, opts) {\n    return new Promise(function(resolve, reject) {\n      for (let child of nodeData.chilren) {\n        child.parentId = nodeData.id;\n      }\n\n    // construct the content of node\n    let nodeDiv = document.createElement('div');\n    if (nodeData[opts.nodeId]) {\n      nodeDiv.id = nodeData[opts.nodeId];\n    }\n    nodeData.setAttribute('class', 'node ' + (nodeData.className || '') +  (level >= opts.depth ? ' slide-up' : ''));\n    if (opts.draggable) {\n      nodeDiv.setAttribute('draggable', true);\n    }\n    if (nodeData.parentId) {\n      nodeDiv.setAttribute('data-parent', nodeData.parentId);\n    }\n    nodeDiv.innerHTML = `\n      <div class=\"title\">${nodeData[opts.nodeTitle]}</div>\n      ${opts.nodeContent ? `<div class=\"content\">${nodeData[opts.nodeContent]}</div>` : ''}\n    `;\n    // append 4 direction arrows or expand/collapse buttons\n    let flags = nodeData.relationship || '';\n\n    if (opts.verticalDepth && (level + 2) > opts.verticalDepth) {\n      if ((level + 1) >= opts.verticalDepth && Number(flags.substr(2,1))) {\n        let toggleBtn = document.createElement('i');\n        toggleBtn.setAttribute('class', 'toggleBtn fa fa-minus-square');\n        nodeDiv.appendChild(toggleBtn);\n      }\n    } else {\n      if (Number(flags.substr(0,1))) {\n        let topEdge = document.createElement('i');\n        topEdge.setAttribute('class', 'edge verticalEdge topEdge fa');\n        $nodeDiv.appendChild(topEdge);\n      }\n      if(Number(flags.substr(1,1))) {\n        let rightEdge = document.createElement('i');\n        rightEdge.setAttribute('class', 'edge horizontalEdge rightEdge fa');\n        nodeDiv.appendChild(rightEdge);\n        let leftEdge = document.createElement('i');\n        rightEdge.setAttribute('class', 'edge horizontalEdge leftEdge fa');\n        nodeDiv.appendChild(leftEdge);\n      }\n      if(Number(flags.substr(2,1))) {\n        let bottomEdge = document.createElement('i');\n        bottomEdge.setAttribute('class', 'edge verticalEdge bottomEdge fa');\n        nodeDiv.appendChild(bottomEdge);\n        let symbol = document.createElement('i');\n        symbol.setAttribute('class', 'fa '+ opts.parentNodeSymbol + ' symbol');\n        let title = nodeDiv.querySelector('.scope > .title');\n        title.insertBefore(symbol, title.children[0]);\n      }\n    }\n\n    nodeDiv.addEventListener('mouseenter', this._hoverNode);\n    nodeDiv.addEventListener('mouseleave', this._hoverNode);\n    nodeDiv.addEventListener('click', this._clickNode);\n    nodeDiv.querySelector('.topEdge').addEventListener('click', clickTopEdge);\n    nodeDiv.querySelector('.bottomEdge').addEventListener('click', clickBottomEdge);\n\n\n\n\n    // event handler for toggle buttons in Hybrid(horizontal + vertical) OrgChart\n    $nodeDiv.on('click', '.toggleBtn', function(event) {\n      var $this = $(this);\n      var $descWrapper = $this.parent().next();\n      var $descendants = $descWrapper.find('.node');\n      var $children = $descWrapper.children().children('.node');\n      if ($children.is('.slide')) { return; }\n      $this.toggleClass('fa-plus-square fa-minus-square');\n      if ($descendants.eq(0).is('.slide-up')) {\n        $descWrapper.removeClass('hidden');\n        repaint($children.get(0));\n        $children.addClass('slide').removeClass('slide-up').eq(0).one('transitionend', function() {\n          $children.removeClass('slide');\n        });\n      } else {\n        $descendants.addClass('slide slide-up').eq(0).one('transitionend', function() {\n          $descendants.removeClass('slide');\n          // $descWrapper.addClass('hidden');\n          $descendants.closest('ul').addClass('hidden');\n        }).find('.toggleBtn').removeClass('fa-minus-square').addClass('fa-plus-square');\n      }\n    });\n\n    // bind click event handler for the left and right edges\n    $nodeDiv.on('click', '.leftEdge, .rightEdge', function(event) {\n      event.stopPropagation();\n      var $that = $(this);\n      var $node = $that.parent();\n      var siblingsState = getNodeState($node, 'siblings');\n      if (siblingsState.exist) {\n        var $siblings = $node.closest('table').parent().siblings();\n        if ($siblings.find('.node:visible').is('.slide')) { return; }\n        if (opts.toggleSiblingsResp) {\n          var $prevSib = $node.closest('table').parent().prev();\n          var $nextSib = $node.closest('table').parent().next();\n          if ($that.is('.leftEdge')) {\n            if ($prevSib.is('.hidden')) {\n              showSiblings($node, 'left');\n            } else {\n              hideSiblings($node, 'left');\n            }\n          } else {\n            if ($nextSib.is('.hidden')) {\n              showSiblings($node, 'right');\n            } else {\n              hideSiblings($node, 'right');\n            }\n          }\n        } else {\n          if (siblingsState.visible) {\n            hideSiblings($node);\n          } else {\n            showSiblings($node);\n          }\n        }\n      } else {\n        // load the new sibling nodes of the specified node by ajax request\n        var nodeId = $that.parent()[0].id;\n        var url = (getNodeState($node, 'parent').exist) ?\n          ($.isFunction(opts.ajaxURL.siblings) ? opts.ajaxURL.siblings(nodeData) : opts.ajaxURL.siblings + nodeId) :\n          ($.isFunction(opts.ajaxURL.families) ? opts.ajaxURL.families(nodeData) : opts.ajaxURL.families + nodeId);\n        if (startLoading($that, $node, opts)) {\n          $.ajax({ 'url': url, 'dataType': 'json' })\n          .done(function(data, textStatus, jqXHR) {\n            if ($node.closest('.orgchart').data('inAjax')) {\n              if (data.siblings || data.children) {\n                addSiblings($node, data, opts);\n              }\n            }\n          })\n          .fail(function(jqXHR, textStatus, errorThrown) {\n            console.log('Failed to get sibling nodes data');\n          })\n          .always(function() {\n            endLoading($that, $node, opts);\n          });\n        }\n      }\n    });\n    if (opts.draggable) {\n      $nodeDiv.on('dragstart', function(event) {\n        var origEvent = event.originalEvent;\n        var isFirefox = /firefox/.test(window.navigator.userAgent.toLowerCase());\n        if (isFirefox) {\n          origEvent.dataTransfer.setData('text/html', 'hack for firefox');\n        }\n        // if users enable zoom or direction options\n        if ($nodeDiv.closest('.orgchart').css('transform') !== 'none') {\n          var ghostNode, nodeCover;\n          if (!document.querySelector('.ghost-node')) {\n            ghostNode = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n            ghostNode.classList.add('ghost-node');\n            nodeCover = document.createElementNS('http://www.w3.org/2000/svg','rect');\n            ghostNode.appendChild(nodeCover);\n            $nodeDiv.closest('.orgchart').append(ghostNode);\n          } else {\n            ghostNode = $nodeDiv.closest('.orgchart').children('.ghost-node').get(0);\n            nodeCover = $(ghostNode).children().get(0);\n          }\n          var transValues = $nodeDiv.closest('.orgchart').css('transform').split(',');\n          var scale = Math.abs(window.parseFloat((opts.direction === 't2b' || opts.direction === 'b2t') ? transValues[0].slice(transValues[0].indexOf('(') + 1) : transValues[1]));\n          ghostNode.setAttribute('width', $nodeDiv.outerWidth(false));\n          ghostNode.setAttribute('height', $nodeDiv.outerHeight(false));\n          nodeCover.setAttribute('x',5 * scale);\n          nodeCover.setAttribute('y',5 * scale);\n          nodeCover.setAttribute('width', 120 * scale);\n          nodeCover.setAttribute('height', 40 * scale);\n          nodeCover.setAttribute('rx', 4 * scale);\n          nodeCover.setAttribute('ry', 4 * scale);\n          nodeCover.setAttribute('stroke-width', 1 * scale);\n          var xOffset = origEvent.offsetX * scale;\n          var yOffset = origEvent.offsetY * scale;\n          if (opts.direction === 'l2r') {\n            xOffset = origEvent.offsetY * scale;\n            yOffset = origEvent.offsetX * scale;\n          } else if (opts.direction === 'r2l') {\n            xOffset = $nodeDiv.outerWidth(false) - origEvent.offsetY * scale;\n            yOffset = origEvent.offsetX * scale;\n          } else if (opts.direction === 'b2t') {\n            xOffset = $nodeDiv.outerWidth(false) - origEvent.offsetX * scale;\n            yOffset = $nodeDiv.outerHeight(false) - origEvent.offsetY * scale;\n          }\n          if (isFirefox) { // hack for old version of Firefox(< 48.0)\n            nodeCover.setAttribute('fill', 'rgb(255, 255, 255)');\n            nodeCover.setAttribute('stroke', 'rgb(191, 0, 0)');\n            var ghostNodeWrapper = document.createElement('img');\n            ghostNodeWrapper.src = 'data:image/svg+xml;utf8,' + (new XMLSerializer()).serializeToString(ghostNode);\n            origEvent.dataTransfer.setDragImage(ghostNodeWrapper, xOffset, yOffset);\n          } else {\n            origEvent.dataTransfer.setDragImage(ghostNode, xOffset, yOffset);\n          }\n        }\n        var $dragged = $(this);\n        var $dragZone = $dragged.closest('.nodes').siblings().eq(0).find('.node:first');\n        var $dragHier = $dragged.closest('table').find('.node');\n        $dragged.closest('.orgchart')\n          .data('dragged', $dragged)\n          .find('.node').each(function(index, node) {\n            if ($dragHier.index(node) === -1) {\n              if (opts.dropCriteria) {\n                if (opts.dropCriteria($dragged, $dragZone, $(node))) {\n                  $(node).addClass('allowedDrop');\n                }\n              } else {\n                $(node).addClass('allowedDrop');\n              }\n            }\n          });\n      })\n      .on('dragover', function(event) {\n        event.preventDefault();\n        var $dropZone = $(this);\n        var $dragged = $dropZone.closest('.orgchart').data('dragged');\n        var $dragZone = $dragged.closest('.nodes').siblings().eq(0).find('.node:first');\n        if ($dragged.closest('table').find('.node').index($dropZone) > -1 ||\n          (opts.dropCriteria && !opts.dropCriteria($dragged, $dragZone, $dropZone))) {\n          event.originalEvent.dataTransfer.dropEffect = 'none';\n        }\n      })\n      .on('dragend', function(event) {\n        $(this).closest('.orgchart').find('.allowedDrop').removeClass('allowedDrop');\n      })\n      .on('drop', function(event) {\n        var $dropZone = $(this);\n        var $orgchart = $dropZone.closest('.orgchart');\n        var $dragged = $orgchart.data('dragged');\n        $orgchart.find('.allowedDrop').removeClass('allowedDrop');\n        var $dragZone = $dragged.closest('.nodes').siblings().eq(0).children();\n        // firstly, deal with the hierarchy of drop zone\n        if (!$dropZone.closest('tr').siblings().length) { // if the drop zone is a leaf node\n          $dropZone.append('<i class=\"edge verticalEdge bottomEdge fa\"></i>')\n            .parent().attr('colspan', 2)\n            .parent().after('<tr class=\"lines\"><td colspan=\"2\"><div class=\"downLine\"></div></td></tr>'\n            + '<tr class=\"lines\"><td class=\"rightLine\">&nbsp;</td><td class=\"leftLine\">&nbsp;</td></tr>'\n            + '<tr class=\"nodes\"></tr>')\n            .siblings(':last').append($dragged.find('.horizontalEdge').remove().end().closest('table').parent());\n        } else {\n          var dropColspan = parseInt($dropZone.parent().attr('colspan')) + 2;\n          var horizontalEdges = '<i class=\"edge horizontalEdge rightEdge fa\"></i><i class=\"edge horizontalEdge leftEdge fa\"></i>';\n          $dropZone.closest('tr').next().addBack().children().attr('colspan', dropColspan);\n          if (!$dragged.find('.horizontalEdge').length) {\n            $dragged.append(horizontalEdges);\n          }\n          $dropZone.closest('tr').siblings().eq(1).children(':last').before('<td class=\"leftLine topLine\">&nbsp;</td><td class=\"rightLine topLine\">&nbsp;</td>')\n            .end().next().append($dragged.closest('table').parent());\n          var $dropSibs = $dragged.closest('table').parent().siblings().find('.node:first');\n          if ($dropSibs.length === 1) {\n            $dropSibs.append(horizontalEdges);\n          }\n        }\n        // secondly, deal with the hierarchy of dragged node\n        var dragColspan = parseInt($dragZone.attr('colspan'));\n        if (dragColspan > 2) {\n          $dragZone.attr('colspan', dragColspan - 2)\n            .parent().next().children().attr('colspan', dragColspan - 2)\n            .end().next().children().slice(1, 3).remove();\n          var $dragSibs = $dragZone.parent().siblings('.nodes').children().find('.node:first');\n          if ($dragSibs.length ===1) {\n            $dragSibs.find('.horizontalEdge').remove();\n          }\n        } else {\n          $dragZone.removeAttr('colspan')\n            .find('.bottomEdge').remove()\n            .end().end().siblings().remove();\n        }\n        $orgchart.triggerHandler({ 'type': 'nodedropped.orgchart', 'draggedNode': $dragged, 'dragZone': $dragZone.children(), 'dropZone': $dropZone });\n      });\n    }\n    // allow user to append dom modification after finishing node create of orgchart \n    if (opts.createNode) {\n      opts.createNode($nodeDiv, nodeData);\n    }\n\n      resolve(nodeDiv);\n    });\n  }\n  buildHierarchy(appendTo, nodeData, level, opts, callback) {\n    // Construct the node\n    let nodeWrapper,\n      childNodes = nodeData.children,\n      hasChildren = childNodes ? childNodes.length : false,\n      isVerticalNode = (opts.verticalDepth && (level + 1) >= opts.verticalDepth) ? true : false;\n\n    if (Object.keys(nodeData).length > 1) { // if nodeData has nested structure\n      nodeWrapper = isVerticalNode ? appendTo : document.createElement('table');\n      if (!isVerticalNode) {\n        appendTo.appendChild(nodeWrapper);\n      }\n      this._createNode(nodeData, level, opts)\n      .then(function(nodeDiv) {\n        if (isVerticalNode) {\n          nodeWrapper.appendChild(nodeDiv);\n        }else {\n          let tr = document.createElement('tr');\n          tr.innerHTML = `\n            <td ${hasChildren ? `colspan=\"${childNodes.length * 2}\"` : ''}>\n            </td>\n          `;\n          tr.firstChild.appendChild(nodeDiv);\n          nodeWrapper.appendChild(tr);\n        }\n        if (callback) {\n          callback();\n        }\n      })\n      .catch(function(err) {\n        console.error('Failed to creat node', err);\n      });\n    }\n    // Construct the inferior nodes and connectiong lines\n    if (hasChildren) {\n      if (Object.keys(nodeData).length === 1) { // if nodeData is just an array\n        $nodeWrapper = $appendTo;\n      }\n      var isHidden = level + 1 >= opts.depth ? ' hidden' : '';\n      var isVerticalLayer = (opts.verticalDepth && (level + 2) >= opts.verticalDepth) ? true : false;\n\n      // draw the line close to parent node\n      if (!isVerticalLayer) {\n        let tr = document.createElement('tr');\n        tr.setAttribute('class', 'lines' + isHidden);\n        tr.innerHTML = `\n          <td colspan=\"${childNodes.length * 2}\">\n            <div class=\"downLine\"></div>\n          </td>\n        `;\n        nodeWrapper.appendChild(tr);\n      }\n      // draw the lines close to children nodes\n      for (var i=1; i<$childNodes.length; i++) {\n        lineLayer += '<td class=\"leftLine topLine\">&nbsp;</td><td class=\"rightLine topLine\">&nbsp;</td>';\n      }\n\n      let lineLayer = document.createElement('tr');\n        lineLayer.setAttribute('class', 'lines' + isHidden);\n        lineLayer.innerHTML = `\n          <td class=\"rightLine\"> </td>\n          ${childNodes.map(() => `\n            <td class=\"leftLine topLine\"> </td>\n            <td class=\"rightLine topLine\"> </td>\n          `)}\n          <td class=\"leftLine\"> </td>\n        `;\n      let $nodeLayer;\n\n      if (isVerticalLayer) {\n        nodeLayer = document.createElement('<ul>');\n        if (level + 2 === opts.verticalDepth) {\n          let tr = document.createElement('tr');\n          tr.setAttribute('class', 'verticalNodes');\n          tr.innerHTML = `<td></td>`;\n          tr.firstChild.appendChild(nodeLayer);\n        } else {\n          nodeWrapper.appendChild(nodeLayer);\n        }\n      } else {\n        nodeLayer = document.createElement('tr');\n        nodeLayer.setAttribute('class', 'nodes' + isHidden);\n        nodeWrapper.appendChild(lineLayer);\n        nodeWrapper.appendChild(nodeLayer);\n      }\n      // recurse through children nodes\n      childNodes.map(() => {\n        let $nodeCell;\n\n        if (isVerticalLayer) {\n          nodeCell = document.createElement('li');\n        } else {\n          nodeCell = document.createElement('td');\n          nodeCell.setAttribute('colspan', 2);\n        }\n        nodeLayer.appendChild(nodeCell);\n        buildHierarchy(nodeCell, this, level + 1, opts, callback);\n      });\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/index.js\n **/"],"sourceRoot":""}